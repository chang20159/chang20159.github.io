<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[关于CORS]]></title>
      <url>/%E5%85%B3%E4%BA%8ECORS/</url>
      <content type="html"><![CDATA[<p>之前写过两篇关于CORS跨域的工作总结，<code>跨域问题解决方案</code>和<code>IE浏览器跨域访问失败</code>，由于纯粹是工作总结，没有讲明为什么要这么做，就删除了。</p>
<p>最近又经常被问到一些问题，比如写java服务端的同学的来问：我服务端明明正确返回了，测试环境debug能看到，为什么前端就是拿不到数据？ 然后写前端的同学会问：为什么我明明设置了withCredentials=true，服务端同学还是拿不到cookie？</p>
<p>所以决定重新捋一捋使用CORS解决跨域的问题，前后端要怎么做？为什么这么做？</p>
<a id="more"></a>
<h2 id="为什么会有跨域的问题？"><a href="#为什么会有跨域的问题？" class="headerlink" title="为什么会有跨域的问题？"></a>为什么会有跨域的问题？</h2><p>为了保证用户信息的安全，所有的浏览器都遵循同源策略，那什么情况下算同源呢？同源策略又是什么呢？</p>
<p><strong>记住：协议、域名、端口号完全相同时，才是同源</strong></p>
<p>可以参考 <a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="external">Web安全 - 浏览器的同源策略</a></p>
<p>在同源策略下，会有以下限制：</p>
<ul>
<li>无法获取非同源的Cookie、LocalStorage、SessionStorage等</li>
<li>无法获取非同源的dom</li>
<li>无法向非同源的服务器发送ajax请求</li>
</ul>
<p>但是我们又经常会遇到前后端分离，不在同一个域名下，需要ajax请求数据的情况。那我们就要规避这种限制。</p>
<p>可以在网上搜到很多解决跨域的方法，有些方法比较古老了，现在项目中用的比较多的是jsonp和CORS（跨域资源共享），这篇主要讲CORS的原理和具体实践。</p>
<h2 id="CORS跨域原理"><a href="#CORS跨域原理" class="headerlink" title="CORS跨域原理"></a>CORS跨域原理</h2><p>CORS跨域的原理实际上是浏览器与服务器通过一些HTTP协议头来做一些约定和限制。可以查看  <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="external">HTTP-访问控制（CORS）</a></p>
<p><strong>与跨域相关的协议头</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">请求头</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Origin</td>
<td style="text-align:left">表明预检请求或实际请求的源站URI,不管是否跨域ORIGIN字段总是被发送</td>
</tr>
<tr>
<td style="text-align:left">Access-Control-Request-Method</td>
<td style="text-align:left">将实际请求所使用的 HTTP 方法告诉服务器</td>
</tr>
<tr>
<td style="text-align:left">Access-Control-Request-Headers</td>
<td style="text-align:left">将实际请求所携带的首部字段告诉服务器</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">响应头</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Access-Control-Allow-Origin</td>
<td style="text-align:left">指定允许访问该资源的外域 URI，对于携带身份凭证的请求不可使用通配符*</td>
</tr>
<tr>
<td style="text-align:left">Access-Control-Expose-Headers</td>
<td style="text-align:left">指定XMLHttpRequest的getResponseHeader可以访问的响应头</td>
</tr>
<tr>
<td style="text-align:left">Access-Control-Max-Age</td>
<td style="text-align:left">指定preflight请求的结果能够被缓存多久</td>
</tr>
<tr>
<td style="text-align:left">Access-Control-Allow-Credentials</td>
<td style="text-align:left">是否允许浏览器读取response的内容；<br>当用在preflight预检请求的响应中时，指定实际的请求是否可使用credentials</td>
</tr>
<tr>
<td style="text-align:left">Access-Control-Allow-Methods</td>
<td style="text-align:left">指明实际请求所允许使用的 HTTP 方法</td>
</tr>
<tr>
<td style="text-align:left">Access-Control-Allow-Headers</td>
<td style="text-align:left">指明实际请求中允许携带的首部字段</td>
</tr>
</tbody>
</table>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>这里写了个demo，一步步来分析。</p>
<p>目录如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── README.md</div><div class="line">├── client</div><div class="line">│   ├── index.html</div><div class="line">│   └── request.js</div><div class="line">└── server</div><div class="line">    ├── pom.xml</div><div class="line">    ├── server-web</div><div class="line">    │   ├── pom.xml</div><div class="line">    │   ├── server-web.iml</div><div class="line">    │   └── src</div><div class="line">    │       └── main</div><div class="line">    │           ├── java</div><div class="line">    │           │   └── com</div><div class="line">    │           │       └── example</div><div class="line">    │           │           └── cors</div><div class="line">    │           │               ├── constant</div><div class="line">    │           │               │   └── Constants.java</div><div class="line">    │           │               ├── controller</div><div class="line">    │           │               │   └── CorsController.java</div><div class="line">    │           │               └── filter</div><div class="line">    │           │                   └── CrossDomainFilter.java</div><div class="line">    │           ├── resources</div><div class="line">    │           │   └── config</div><div class="line">    │           │       └── applicationContext-core.xml</div><div class="line">    │           └── webapp</div><div class="line">    │               ├── WEB-INF</div><div class="line">    │               │   ├── dispatcher-servlet.xml</div><div class="line">    │               │   └── web.xml</div><div class="line">    │               └── index.jsp</div><div class="line">    └── server.iml</div></pre></td></tr></table></figure>
<ul>
<li><strong>Client：前端，简单的ajax请求</strong></li>
</ul>
<p>在client文件夹下，启动静态服务器，前端页面通过<code>http://localhost:8000/index.html</code>访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">anywhere -h localhost -p 8000</div></pre></td></tr></table></figure>
<ul>
<li><strong>Server： java项目，SpringMVC</strong></li>
</ul>
<p>在IntelliJ IDEA中本地启动tomcat，设置host: <code>http://localhost:8080/</code>，服务端数据通过<code>http://localhost:8080/server/cors</code>请求。</p>
<p>这里前端和后端因为<strong>端口号不同</strong>，存在跨域限制，下面通过CORS来解决因为跨域无法通过ajax请求数据的问题。</p>
<h3 id="没有允许跨域的情况"><a href="#没有允许跨域的情况" class="headerlink" title="没有允许跨域的情况"></a>没有允许跨域的情况</h3><p>这种情况就是前端什么都不做，服务端也什么都不做。</p>
<p>Client: 请求成功后，将数据显示在页面上</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Request().send(<span class="string">'http://localhost:8080/server/cors'</span>,&#123;</div><div class="line">	<span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">		<span class="built_in">document</span>.write(data)</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Server:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/server"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsController</span> </span>&#123;</div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/cors"</span>, method= RequestMethod.GET)</div><div class="line">    <span class="meta">@ResponseBody</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">ajaxCors</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"SUCCESS"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在浏览器地址栏输入<code>http://localhost:8080/server/cors</code>直接请求服务端，可以看到返回结果： ‘SUCCESS’</p>
<p><img src="../images/CORS/server_1.png"></p>
<p>在浏览器地址栏输入<code>http://localhost:8000/index.html</code>，从不同域的网页中向Server发送ajax请求。可以看到几个方面：</p>
<p>从network可以看到，请求返回正常。<br><img src="../images/CORS/client_1_network.png"></p>
<p>但Response中没有内容，显示 <code>Failed to load response data</code>。<br><img src="../images/CORS/client_network_response.png"></p>
<p>并且控制台报错：<br><img src="../images/CORS/client_1_console_error.png"></p>
<p><strong>总结：</strong></p>
<blockquote>
<ol>
<li>浏览器请求是发出去了的，服务端也会正确返回，但是我们拿不到response的内容</li>
<li>浏览器控制台会报错提示可以怎么做，而且提示的很明白：    xhr不能请求<code>http://localhost:8080/server/cors</code>，请求资源的响应头中没有设置Access-Control-Allow-Origin，Origin：<code>http://localhost:8000</code>是不允许跨域请求的。</li>
</ol>
</blockquote>
<p>那下一步，我们要在服务端响应跨域请求时，设置响应头: Access-Control-Allow-Origin</p>
<h3 id="设置Access-Control-Allow-Origin允许跨域"><a href="#设置Access-Control-Allow-Origin允许跨域" class="headerlink" title="设置Access-Control-Allow-Origin允许跨域"></a>设置Access-Control-Allow-Origin允许跨域</h3><p>先说明为什么要设置Access-Control-Allow-Origin，可以把Access-Control-Allow-Origin当作一个指令，服务端设置Access-Control-Allow-Origin就是告诉浏览器允许向服务端请求资源的域名，浏览器通过Response中的Access-Control-Allow-Origin就可以知道能不能把数据吐出来。</p>
<p>官方解释是这样的： Access-Control-Allow-Origin 响应头指定了该响应的资源是否被允许与给定的origin共享。</p>
<p>Access-Control-Allow-Origin可以设置的值有：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Origin: *</div><div class="line">Access-Control-Allow-Origin: &lt;origin&gt;</div></pre></td></tr></table></figure>
<p>那在java服务端给响应头设置Access-Control-Allow-Origin可以这么做：</p>
<p>1、添加一个过滤器</p>
<pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CrossDomainFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line">        HttpServletResponse resp = (HttpServletResponse)servletResponse;</div><div class="line">        resp.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"http://localhost:8000"</span>);</div><div class="line">        filterChain.doFilter(servletRequest,servletResponse);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</code></pre><p>2、然后在web.xml文件中添加过滤器配置：</p>
<pre><code><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>crossDomainFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.example.cors.filter.CrossDomainFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>crossDomainFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure>
</code></pre><p>3、然后重新启动tomcat，client重新发送请求<code>http://localhost:8000/index.html</code></p>
<p><img src="../images/CORS/client_2_access_success.png"><br><img src="../images/CORS/client_2_access_response.png"></p>
<p>可以看到我们能够拿到返回结果了，响应头中有我们在服务端设置的Access-Control-Allow-Origin: <code>http://localhost:8000</code>，这个应该跟请求头中的origin一致，或者设置Access-Control-Allow-Origin:*也是可以的，这就允许任何网站来访问资源了（前提是不带凭证信息，这个后面讲）</p>
<p><strong>以上就是允许一个简单的跨域请求的做法，只需要服务端设置响应头Access-Control-Allow-Origin。</strong></p>
<h3 id="简单请求与预检请求"><a href="#简单请求与预检请求" class="headerlink" title="简单请求与预检请求"></a>简单请求与预检请求</h3><p>上面讲述了一个简单请求通过在服务端设置响应头Access-Control-Allow-Origin就可以完成跨域请求。</p>
<p>那怎样的请求算是一个简单请求？与简单请求相对应的是什么样的请求呢？解决跨域的方式又有什么不一样呢？</p>
<p>符合以下条件的可视为简单请求：</p>
<p>1、使用下列HTTP方法之一</p>
<pre><code>- GET
- HEAD
- POST，并且Content-Type的值在下列之一： 
    - text/plain
    - multipart/form-data
    - application/x-www-form-urlencoded
</code></pre><p>2、并且请求头中只有下面这些</p>
<pre><code>- Accept
- Accept-Language
- Content-Language
- Content-Type （需要注意额外的限制）
- DPR
- Downlink
- Save-Data
- Viewport-Width
- Width
</code></pre><p>不满足上述要求的在发送正式请求前都要先发送一个预检请求，预检请求以OPTIONS方法发送，浏览器通过请求方法和请求头能够判断是否发送预检请求。</p>
<p>比如Client发送如下请求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Request().send(<span class="string">'http://localhost:8080/server/options'</span>,&#123;</div><div class="line">	<span class="attr">method</span>: <span class="string">'POST'</span>,</div><div class="line">	<span class="attr">header</span>: &#123;</div><div class="line">		<span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>  <span class="comment">//告诉服务器实际发送的数据类型</span></div><div class="line">	&#125;,</div><div class="line">	<span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">		<span class="built_in">document</span>.write(data)</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Server端处理请求的controller:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/server"</span>)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsController</span> </span>&#123;</div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/options"</span>, method= RequestMethod.POST)</div><div class="line">    <span class="meta">@ResponseBody</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">options</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"SUCCESS"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>因为请求时，请求头中塞入了header，’Content-Type’: ‘application/json’。根据前面讲述的可以知道，浏览器会以OPTIONS方法发出一个预检请求，浏览器会在请求头中加入： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Access-Control-Request-Headers:content-type</div><div class="line">Access-Control-Request-Method:POST</div></pre></td></tr></table></figure>
<p>这个预检请求的作用在这里就是告诉服务器：我会在后面请求的请求头中以POST方法发送数据类型是application/json的请求，询问服务器是否允许。</p>
<p><img src="../images/CORS/client_3_options_error.png"></p>
<p>在这里服务器还没有做任何允许这种请求的设置，所以浏览器控制台报错：</p>
<p><img src="../images/CORS/client_3_options_console_error.png"></p>
<p>也清楚的说明了出错的原因： <strong>服务端在预检请求的响应中没有告诉浏览器允许协议头Content-Type</strong>，即服务端需要设置响应头Access-Control-Allow-Headers，允许浏览器发送带Content-Type的请求。</p>
<p>Server端过滤器中添加Access-Control-Allow-Headers：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CrossDomainFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line">        HttpServletResponse resp = (HttpServletResponse)servletResponse;</div><div class="line">        resp.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"http://localhost:8000"</span>);</div><div class="line">        resp.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"Content-Type"</span>);</div><div class="line">        filterChain.doFilter(servletRequest,servletResponse);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以看到请求成功<br><img src="../images/CORS/client_3_options_console_success.png"></p>
<p>再来看请求的具体信息，第一次以OPTIONS方法发送预检请求，浏览器设置请求头：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Access-Control-Request-Headers:content-type //请求中加入的请求头</div><div class="line">Access-Control-Request-Method:POST  //跨域请求的方法</div></pre></td></tr></table></figure>
<p>服务端设置响应头：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Headers:Content-Type   //允许的header</div><div class="line">Access-Control-Allow-Origin:http://localhost:8000 //允许跨域的源</div></pre></td></tr></table></figure>
<p><img src="../images/CORS/client_3_options_success.png"><br>也可以设置Access-Control-Allow-Methods来限制客户端的的请求方法。</p>
<p>这样预检请求成功了，浏览器会发出第二个请求，这是真正请求数据的请求：<br><img src="../images/CORS/client_3_options_2_post.png"></p>
<p>可以看到POST请求成功了，第二次请求头中没有设置Access-Control-Request-Headers和Access-Control-Request-Method。</p>
<p><strong>但是这里有个问题</strong>，需要预检请求时，浏览器会发出两次请求，一次OPTIONS，一次POST。两次都返回了数据。这样服务端如果逻辑复杂一些，比如去数据库查找数据，从web层、service到数据库这段逻辑就会走两遍，浏览器会两次拿到相同的数据，所以服务端的filter可以改一下，如果是OPTIONS请求，在设置完跨域请求响应头后就不走后面的逻辑直接返回。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CrossDomainFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line">        HttpServletResponse resp = (HttpServletResponse)servletResponse;</div><div class="line">        resp.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"http://localhost:8000"</span>);</div><div class="line">        resp.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"Content-Type"</span>);   </div><div class="line">        <span class="comment">//OPTION请求就直接返回</span></div><div class="line">        HttpServletRequest req = (HttpServletRequest) servletRequest;</div><div class="line">        <span class="keyword">if</span> (req.getMethod().equals(<span class="string">"OPTIONS"</span>)) &#123;</div><div class="line">            resp.setStatus(<span class="number">200</span>);</div><div class="line">            resp.flushBuffer();</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            filterChain.doFilter(servletRequest,servletResponse);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>总结：</strong></p>
<blockquote>
<ol>
<li>对于POST请求设置响应头Content-Type为某些值、自定义请求头等情况，浏览器会先以OPTIONS方法发送一个预检请求，并设置相应的请求头。</li>
<li>服务端还是正常返回，但如果预检请求响应头中不设置相应的响应头，预检请求不通过，不会再发出第二次请求来获取数据。</li>
<li>服务端设置相应的响应头，浏览器会发出第二个请求，并将服务端返回的数据吐出，我们可以获得response的内容</li>
</ol>
</blockquote>
<h3 id="带凭证信息的请求"><a href="#带凭证信息的请求" class="headerlink" title="带凭证信息的请求"></a>带凭证信息的请求</h3><p>还有一种情况我们经常遇到。浏览器在发送请求时需要给服务端发送cookie，服务端根据cookie中的信息做一些身份验证等。</p>
<p>默认情况下，浏览器向不同域的发送ajax请求，不会携带发送cookie信息。</p>
<p>Client: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var containerElem = document.getElementById(&apos;container&apos;)</div><div class="line">new Request().send(&apos;http://localhost:8080/server/testCookie&apos;,&#123;</div><div class="line">	success: function(data)&#123;</div><div class="line">		containerElem.innerHTML = data</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Server:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">@RequestMapping(value=&quot;/testCookie&quot;, method= RequestMethod.GET)</div><div class="line">@ResponseBody</div><div class="line">public String testCookie(HttpServletRequest request,HttpServletResponse response) throws Exception&#123;</div><div class="line">    String str = &quot;SUCCESS&quot;;</div><div class="line">    Cookie[] cookies = request.getCookies();</div><div class="line">    String school = getSchool(cookies);</div><div class="line">    if(school == null || school.length() == 0)&#123;</div><div class="line">        addCookie(response);</div><div class="line">    &#125;</div><div class="line">    return str + buildText(cookies);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>服务端收到请求，判断cookie中有没有school，没有就添加cookie.</p>
<p><img src="../images/CORS/client_4_cookie_none.png"></p>
<p>可以看到响应头中有Set-Cookie，再次请求时，如果是同源请求，浏览器会将Set-Cookie中的值放在请求头中，但是<strong>对于跨域请求，默认是不发送这个Cookie的。</strong></p>
<p>如果要让浏览器发送cookie，需要在Client设置XMLHttpRequest的withCredentials属性为true。</p>
<p>Client:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> containerElem = <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>)</div><div class="line">	<span class="keyword">new</span> Request().send(<span class="string">'http://localhost:8080/server/testCookie'</span>,&#123;</div><div class="line">		<span class="attr">withCredentials</span>: <span class="literal">true</span>,</div><div class="line">		<span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">			containerElem.innerHTML = data</div><div class="line">		&#125;</div><div class="line">	&#125;);</div></pre></td></tr></table></figure>
<p>现在浏览器在请求头中加入了cookie信息<br><img src="../images/CORS/client_4_cookie_error.png"><br>但是服务端返回的数据没有在页面中展示，并且报错：</p>
<p><img src="../images/CORS/client_4_credentials_error.png"></p>
<p>报错信息很明白： <strong>当请求中包含凭证信息时，需要设置响应头Access-Control-Allow-Credentials，是否带凭证信息是由XMLHttpRequest的withCredentials属性控制的。</strong></p>
<p>所以我们在Server端filter中加入这个响应头：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line">        HttpServletResponse resp = (HttpServletResponse)servletResponse;</div><div class="line">        resp.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"http://localhost:8000"</span>);</div><div class="line">        resp.setHeader(<span class="string">"Access-Control-Allow-Credentials"</span>,<span class="string">"true"</span>);</div><div class="line">        HttpServletRequest req = (HttpServletRequest) servletRequest;</div><div class="line">        <span class="keyword">if</span> (req.getMethod().equals(<span class="string">"OPTIONS"</span>)) &#123;</div><div class="line">            resp.setStatus(<span class="number">200</span>);</div><div class="line">            resp.flushBuffer();</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            filterChain.doFilter(servletRequest,servletResponse);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>现在浏览器知道响应头中Access-Control-Allow-Credentials为true，就会把数据给吐出来了，我们能够从response中拿到内容了。</p>
<p><img src="../images/CORS/client_4_cookie_success_console.png"></p>
<p><img src="../images/CORS/client_4_cookie_success.png"></p>
<p>那如果附带凭证信息并且有预检请求呢？如果有预检请求，并附带凭证信息（XMLHttpRequest的withCredentials设置为true）， 服务端需要设置Access-Control-Allow-Credentials: true，否则浏览器不会发出第二次请求，并报错。</p>
<p><img src="../images/CORS/client_4_cookie_preflight_error.png"></p>
<p><strong>总结：</strong></p>
<blockquote>
<ol>
<li>跨域请求时，浏览器默认不会发送cookie，需要设置XMLHttpRequest的withCredentials属性为true</li>
<li>浏览器设置XMLHttpRequest的withCredentials属性为true，表明要向服务端发送凭证信息(这里是cookie)。那么服务端就需要在响应头中添加Access-Control-Allow-Credentials为true。否则浏览器上有两种情况：<ul>
<li>如果是简单请求，服务端结果吐出了，浏览器拿到了但就是不给吐出来，并报错。</li>
<li>如果是预检请求，同样我们拿不到返回结果，并报错提示预检请求不通过，不会再发第二次请求。</li>
</ul>
</li>
</ol>
</blockquote>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="cookie的同源策略"><a href="#cookie的同源策略" class="headerlink" title="cookie的同源策略"></a>cookie的同源策略</h3><p>另外就是设置了XMLHttpRequest的withCredentials属性为true，浏览器发出去了，服务端还是拿不到cookie的问题。</p>
<p>cookie也遵循同源策略的，在设置cookie的时候可以发现除了键值对，还可以设置cookie的这些值： </p>
<table>
<thead>
<tr>
<th style="text-align:left">cookie属性值</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">path</td>
<td style="text-align:left">可访问cookie的路径，默认为当前文档位置的路径</td>
</tr>
<tr>
<td style="text-align:left">domain</td>
<td style="text-align:left">可访问cookie的域名，默认为当前文档位置的路径的域名部分</td>
</tr>
<tr>
<td style="text-align:left">max-age</td>
<td style="text-align:left">多久后失效，秒为单位时间。<br>负数：session内有效；0：删除cookie；正数：有效期为创建时刻+ max-age</td>
</tr>
<tr>
<td style="text-align:left">expires</td>
<td style="text-align:left">cookie失效日期.如果没有定义,cookie会在对话结束时过期,即会话cookie</td>
</tr>
<tr>
<td style="text-align:left">secure</td>
<td style="text-align:left">cookie只通过https协议传输</td>
</tr>
</tbody>
</table>
<p>如果获取不到cookie，可以检查下cookie的domain.</p>
<h3 id="IE上跨域访问没有权限"><a href="#IE上跨域访问没有权限" class="headerlink" title="IE上跨域访问没有权限"></a>IE上跨域访问没有权限</h3><p>在跨域发送ajax请求时提示没有权限。 因为IE浏览器默认对跨域访问有限制。需要在浏览器设置中去除限制。 </p>
<p><strong>方法：</strong> 设置 &gt; Internet选项 &gt; 安全 &gt; 自定义级别 &gt; 在设置中找到其他 - 在【其他】中将【通过域访问数据源】启用</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="external">Web安全 - 浏览器的同源策略</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="external">HTTP-访问控制（CORS）</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/cookie" target="_blank" rel="external">Document - Document.cookie</a></li>
<li><a href="https://segmentfault.com/a/1190000004556040" target="_blank" rel="external">聊一聊 cookie</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[理解Flexbox弹性盒布局]]></title>
      <url>/%E7%90%86%E8%A7%A3Flexbox%E5%BC%B9%E6%80%A7%E7%9B%92%E5%B8%83%E5%B1%80/</url>
      <content type="html"><![CDATA[<p><img src="../images/flexbox/flexbox1.png"><br><a id="more"></a></p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li><p>主轴： main axis</p>
<ul>
<li>主轴起点： main start</li>
<li>主轴终点： main end</li>
</ul>
</li>
<li><p>交叉轴（侧轴）： cross axis</p>
<ul>
<li>交叉轴起点： cross start</li>
<li>交叉轴终点： cross end</li>
</ul>
</li>
<li><p>container和item，这两个不翻译最直白，叫容器和项目有点别扭</p>
</li>
</ul>
<h3 id="生成弹性盒"><a href="#生成弹性盒" class="headerlink" title="生成弹性盒"></a>生成弹性盒</h3><ul>
<li>display: flex  生成块盒</li>
<li>inline-flex  生成行内盒</li>
</ul>
<h3 id="container属性"><a href="#container属性" class="headerlink" title="container属性"></a>container属性</h3><ul>
<li><p>flex-direction</p>
<ul>
<li>定义container主轴方向</li>
<li>可选值： row | row-reverse | column | column-reverse</li>
<li>默认值： row</li>
</ul>
</li>
<li><p>flex-wrap</p>
<ul>
<li>控制container为单行还是多行，定义了侧轴的方向，控制多行时向哪个方向堆砌</li>
<li>可选值：nowrap | wrap | wrap-reverse</li>
<li>默认值：nowrap</li>
</ul>
</li>
<li><p>flex-flow</p>
<ul>
<li>flex-direction 和 flex-wrap的简写，这两个属性加起来就可以控制弹性盒内item的布局流向了</li>
<li>默认值： row nowrap</li>
</ul>
</li>
<li><p>justify-content</p>
<ul>
<li>设置container内所有item沿主轴上的对齐方式，并分配剩余可用空间。</li>
<li>如果主轴横向，侧轴竖向， justify-content就是控制所有item在横向的位置布局。</li>
<li>可选值：flex-start | flex-end | center | space-around | space-between</li>
<li>默认值： flex-start</li>
</ul>
</li>
<li><p>align-items</p>
<ul>
<li>设置container内所有item在侧轴上的对齐方式</li>
<li>可选值： flex-start | flex-end | center | baseline | stretch</li>
<li>默认值： stretch</li>
<li>item可以通过设置align-self覆盖container的align-items属性</li>
</ul>
</li>
<li><p>align-content</p>
<ul>
<li>定义多根轴线之间的对齐方式，并分配剩余可用空间。若没有多根轴线，则不起作用</li>
<li>可选值： flex-start | flex-end | center | space-around | space-between | stretch</li>
<li>默认值： stretch</li>
</ul>
</li>
</ul>
<h3 id="item属性"><a href="#item属性" class="headerlink" title="item属性"></a>item属性</h3><ul>
<li><p>align-self</p>
<ul>
<li>设置item在侧轴方向的对齐方式，功能与align-items相同。可覆盖align-items属性。</li>
<li>可选值： auto | flex-start | flex-end | center | baseline | stretch</li>
<li>默认值：auto</li>
</ul>
</li>
<li><p>order</p>
<ul>
<li>设置item的序数顺序，值越小，越靠前</li>
<li>默认值： 0</li>
</ul>
</li>
<li><p>flex-grow</p>
<ul>
<li>设置item的增长因数，不接受负值。</li>
<li>按比例分配剩余空间，没有剩余空间时flex-grow无效</li>
<li>默认值： 0</li>
</ul>
</li>
<li><p>flex-shrink</p>
<ul>
<li>设置item的收缩因素，不接受负值</li>
<li>每个item按比例缩小，使总缩小空间为不足的空间，空间足够时flex-shrink无效</li>
<li>默认值：1</li>
</ul>
</li>
<li><p>flex-basis</p>
<ul>
<li>设置item伸缩的基准值，不接受负值</li>
<li>默认值： auto  类似于width</li>
</ul>
</li>
<li><p>flex</p>
<ul>
<li>设置item的尺寸，包括flex-grow、flex-shrink、flex-basis</li>
<li>默认值： 0,1,auto</li>
</ul>
</li>
</ul>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p><a href="http://chang20159.github.io/css-example/flex/index.html" target="_blank" rel="external">这里看更宽敞&gt;&gt;</a></p>
<iframe style="width:100%;height:1000px;border:none" src="http://chang20159.github.io/css-example/flex/index.html"></iframe>

<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p><a href="http://chang20159.github.io/css-example/flex/flex.html" target="_blank" rel="external">这里看更宽敞&gt;&gt;</a></p>
<iframe style="width:100%;height:800px;border:none" src="http://chang20159.github.io/css-example/flex/flex.html"></iframe>


<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout" target="_blank" rel="external">CSS 弹性盒子布局</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout/Using_CSS_flexible_boxes" target="_blank" rel="external">使用 CSS 弹性盒子</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout/%E5%BC%B9%E6%80%A7%E6%A1%86%E7%9A%84%E9%AB%98%E7%BA%A7%E5%B8%83%E5%B1%80" target="_blank" rel="external">使用弹性盒子进行高级布局</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout/Using_flexbox_to_lay_out_web_applications" target="_blank" rel="external">使用flexbox来布局web应用</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/box-sizing" target="_blank" rel="external">box-sizing</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> CSS </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[移动端适配实践]]></title>
      <url>/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D%E5%AE%9E%E8%B7%B5/</url>
      <content type="html"><![CDATA[<p>一般我们在做前端项目之前，都会先拿到视觉稿和交互稿，我们可以根据视觉稿上的尺寸、颜色等信息编写CSS样式，可以根据交互稿来写JS。</p>
<p>每个公司的视觉规范不同，视觉稿也就不同。甚至在一些大公司里，每个部门都有自己的视觉规范。比如页面画布大小是以640为基准还是750。最终给前端开发人员的文件也可能不同，比如psd文件、sketch文件或者图片文件，其中包括页面文件和切图。</p>
<a id="more"></a>
<p>我做过的项目里，有这几种情况：</p>
<ul>
<li>sketch文件包 + 总体设计图 + 每个页面图片 + 切图(@2x、@3x各一份)</li>
<li>psd源文件 + 总体设计图 + 每个页面图片（有的带尺寸/颜色标注） + 切图(@2x、@3x各一份)</li>
<li>只给带标注的图片的，这种我都会问UED要源文件，标注很难画全的。</li>
</ul>
<p>我们ued画布基准都是iphone6，但是有的是给的画布宽375的sketch文件，有的给画布宽750的psd文件。</p>
<p>下面以我做过的一个页面为例，左边是sketch文件的截图，右边是psd文件导出的图片。</p>
<div><br><img src="//chang20159.com/mobile-web-adaptive/image/sketch.png" height="400" alt="sketch">&nbsp;&nbsp;&nbsp;<img src="//chang20159.com/mobile-web-adaptive/image/mark.png" height="400" alt="png"><br><div><br><br>这个页面涉及到了移动端适配的几个问题:<br><br>- 布局适配，不同屏幕尺寸的设备中布局一致<br>- 图片高清适配，不同分辨率设备中图片高清展示<br>- 不同分辨率设备中1px边框显示一致<br>- 内容适配，不同屏幕尺寸的设备中的文字大小<br><br>那，拿到视觉稿了，我们要开始写代码了。<br><br><strong>假如我们拿到的是宽750的视觉稿</strong><br><br>在写css代码前还得做件事儿，手机端布局视口默认情况下是768px ~ 1024px之间，手机屏幕宽度大家知道的iphone5 320px, iphone6 375px, iphone6 plus 414px这样子。<br><br>像下面图示这样，在手机上浏览页面时得横向滚动，是不是很不友好？<br><div align="center"><br>    <img src="//chang20159.com/mobile-web-adaptive/image/layout_viewport.png" height="300" alt="布局视口"><br></div>


<p>所以我们得想办法，让页面横向内容都展示在屏幕可视范围中，并且禁止缩放。有两种办法：</p>
<ul>
<li>设置布局视口宽度为一个定值，然后按照布局视口的宽度与屏幕宽度的比例缩放</li>
<li>设置布局视口的宽度 = 设备宽度</li>
</ul>
<h2 id="设置布局视口宽度为一个定值，按照布局视口的宽度与屏幕宽度的比例缩放"><a href="#设置布局视口宽度为一个定值，按照布局视口的宽度与屏幕宽度的比例缩放" class="headerlink" title="设置布局视口宽度为一个定值，按照布局视口的宽度与屏幕宽度的比例缩放"></a>设置布局视口宽度为一个定值，按照布局视口的宽度与屏幕宽度的比例缩放</h2><p>  比如屏幕宽375px，视觉稿750px，那就设置布局视口的宽度width=750，<br>  scale = 375 / 750 = 0.5</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=750,initial-scale=0.5,maximum-scale=0.5,user-scalable=no"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>  再比如屏幕宽320px，视觉稿750px，那就设置布局视口的宽度width=750，<br>  scale = 320 / 750 </p>
<p>当然这是需要根据屏幕宽度动态设置的:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> doc = <span class="built_in">window</span>.document;</div><div class="line">	<span class="keyword">var</span> metaEl = doc.querySelector(<span class="string">'meta[name="viewport"]'</span>);</div><div class="line">	<span class="keyword">if</span>(!metaEl)&#123;</div><div class="line">		metaEl = doc.createElement(<span class="string">"meta"</span>);</div><div class="line">		metaEl.setAttribute(<span class="string">"name"</span>, <span class="string">"viewport"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">var</span> metaCtt = metaEl ? metaEl.content : <span class="string">''</span>;</div><div class="line">	<span class="keyword">var</span> matchWidth = metaCtt.match(<span class="regexp">/width=([^,\s]+)/</span>);</div><div class="line">	<span class="keyword">var</span> width = matchWidth ? matchWidth[<span class="number">1</span>] : <span class="number">750</span></div><div class="line">	<span class="keyword">if</span>(width == <span class="string">'device-width'</span>)&#123;<span class="keyword">return</span>&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">var</span> screenWidth = <span class="built_in">window</span>.screen.width;</div><div class="line">	<span class="keyword">var</span> scale = screenWidth/width;</div><div class="line">	metaEl.setAttribute(<span class="string">"content"</span>, <span class="string">"width="</span>+ width +<span class="string">",user-scalable=no,initial-scale="</span> + scale + <span class="string">",maximum-scale="</span> + scale + <span class="string">",minimum-scale="</span> + scale);</div><div class="line">&#125;)()</div></pre></td></tr></table></figure>
<p><a href="http://chang20159.com/mobile-web-adaptive/demo1/demo1.html">demo1</a>        </p>
<p>下面是依次在iphone6 plus，iphone6，iphone5上的展示效果。</p>
<p><img src="//chang20159.com/mobile-web-adaptive/demo1/demo1_200_200.png" alt=""></p>
<p><strong>那有人就会问啦，给的视觉稿是基于iphone5的，画布宽度640怎么办？</strong></p>
<p>那css编程就按照视觉给的来，width设置640，在宽640的布局视口，CSS样式编写与视觉稿相同，那布局就能与视觉稿相同啦。再通过动态缩放就能把整个页面完整的展示在可视窗口中啦。</p>
<p><strong>那又有人问啦，给的不是750宽的视觉稿，是sketch视觉稿，宽375，这怎么办？</strong></p>
<p>一样的道理，视觉稿宽375，视觉稿中的元素都是按宽375来布局的，那我们布局视口width设置375，css样式按375的视觉稿来写就好啦，最后就是动态缩放啦。</p>
<p>好啦，那我们来看这种方式能不能解决我们遇到的几个问题。</p>
<ul>
<li><p>图片高清问题</p>
<p>实际要解决的是怎么让1个位图像素正好覆盖1个物理像素，这样可以让图片在不同dpr的手机上效果一样。</p>
<ul>
<li>dpr = 1，需要1倍图</li>
<li>dpr = 2，需要2倍图</li>
<li>dpr = 3，需要3倍图</li>
</ul>
<p>最好的解决办法是：不同的dpr下，加载不同的尺寸的图片</p>
</li>
<li><p>1px边框问题</p>
<p>  实际要解决的是怎么让1个css像素正好覆盖1个物理像素，这样可以让1px边框在不同dpr的手机上一样细。</p>
<p>  但是布局视口缩放比为 1/dpr 才能让1个css像素是否正好覆盖1个物理像素。<br>  显然这种按照布局视口的宽度与屏幕宽度的比例缩放的方式，只有与视觉稿画布基准一致的设备才能与视觉稿要求显示的一致。比如这里只有在iphone6上1个css像素是否正好覆盖1个物理像素（横向200px的元素对应400个物理像素，在缩放0.5后，横向200px的元素对应200个物理像素，1:1）</p>
</li>
</ul>
<ul>
<li><p>布局适配的问题</p>
<p>  其实直接从上面的对比图就可以看出来，在不同设备上布局是一致的。<br>  原理很简单： 我们写CSS本来就是按视觉稿来写的，然后整体缩放，以适应各种宽度的设备，元素的比例没有变。</p>
</li>
</ul>
<ul>
<li><p>内容适配的问题</p>
<p>主要是文字大小，因为是整体缩放，屏幕越大，字体也越大。</p>
<p>这个主要看视觉规范怎么定，有的觉得这样挺好，有的就希望字体大小都一样，还有的希望字体大小不是根据屏幕大小按比例缩放而是对一定范围内的屏幕宽度设定特定的字体大小。</p>
</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote>
<p>【原理】设定布局视口宽度为视觉稿画布宽度，动态设置缩放比例scale=屏幕宽度/视觉稿画布宽度</p>
<p>【优点】实现简单，可解决不同屏幕大小的布局问题，在各种屏幕上布局一致</p>
<p>【缺点】</p>
<ul>
<li>不能解决1px边框问题；</li>
<li>缩放值依赖于屏幕宽度，demo里是通过screen.width获取屏幕宽度的，这在chrome里iphone6返回的是屏幕宽度值375，但在其他浏览器就不一定了，比如safari中返回的是1280。</li>
<li>所有元素都会缩放，比如字体，在iphone5上就会小很多，这不一定是大家想要的。</li>
</ul>
</blockquote>
<h2 id="设置布局视口的宽度-设备宽度"><a href="#设置布局视口的宽度-设备宽度" class="headerlink" title="设置布局视口的宽度 = 设备宽度"></a>设置布局视口的宽度 = 设备宽度</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这种情况下有什么效果呢？</p>
<p><a href="http://chang20159.com/mobile-web-adaptive/demo2/demo2.html">demo2</a></p>
<p>图片太长，横着放了^^</p>
<p><img src="//chang20159.com/mobile-web-adaptive/demo2/demo2-iPhone6.png" width="600"></p>
<p>看看看，都被挤掉了，为啥？<br>这个是iphone6的截图，现在设置了布局视口宽度是屏幕宽度375，我们视觉稿是按iphone6来的宽750，那当然就放不下了，比如视觉稿中图片占位400px x 400px，我们CSS中写的：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line">	<span class="attribute">width</span>: <span class="number">400px</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">400px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>但是布局视口宽度就375，图片就放不下了。</p>
<p>那iphone6布局视口宽只有375，我们把视觉稿尺寸全部按比例缩小到375就好啦。那750到375，需要除以2，我们在编写css样式时除以2就好啦。</p>
<p>上面视觉稿中图片是400 x 400，我们CSS中就写：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line">	<span class="attribute">width</span>: <span class="number">200px</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">200px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其他元素的宽高、边框、内边距、外边距、字体大小等，通通先除以2，通通先除以2。那现在的效果是这样的，依次是iphone6 plus，iphone6, iphone5</p>
<p><img src="//chang20159.com/mobile-web-adaptive/demo2/demo2_half_200_200.png" width="600"></p>
<p>现在，我们能看到100%呈现在可视窗口中了。那再来看看我们遇到的问题解决了吗？</p>
<ul>
<li><p>1px边框问题</p>
<p>  设置0.5px，在dpr=2的设备中对应1个物理像素，在dpr=2的设备中对应1.5个物理像素。<br>  而且在dpr=2的设备中设置0.5px不一定能达到我们想要的效果，看下面：</p>
<p>  <img src="//chang20159.com/mobile-web-adaptive/demo2/border.png" width="400"></p>
<p>  明明设置的0.5px，但浏览器实际还是按1px处理的。ios7以下，android等其他系统里，0.5px会被当成为0px处理？</p>
<p>  所以直接设置成0.5px是不可行的。</p>
<p>  这实际上还是需要1个css像素正好覆盖1个物理像素就可以解决的。</p>
</li>
<li><p>布局适配的问题</p>
<p>因为没有按设备属性动态缩放，每个设备上每个css像素大小都一样，200px大小的元素在每个设备上也够一样长。        </p>
<p>其实从上面的对比图就能看出来，图片容器（灰色背景）在不同屏幕大小的手机都是一样的高，整个页面在小屏手机中就需要向下滚动查看，一排展示的4个图片标签在大屏手机中右边的空白就比较大。布局问题也没有解决。</p>
</li>
<li><p>内容适配的问题</p>
<p>  文字大小统统一样，也没有解决。</p>
</li>
</ul>
<h3 id="1个css像素只占1个物理像素"><a href="#1个css像素只占1个物理像素" class="headerlink" title="1个css像素只占1个物理像素"></a>1个css像素只占1个物理像素</h3><p>前面已经讲了几遍了，要解决1px边框的问题，达到在不同分辨率设备上效果一致（当然也与视觉稿一致），需要让不同分辨率设备上 <strong>1个css像素只覆盖1个物理像素</strong>。</p>
<p>前面我们将750视觉稿中的尺寸除以2来编写样式，只能在iphone6上的效果满足。那现在我们在布局宽度=屏幕宽度时，让缩放比例为 1/dpr，就可以让<strong>1个css像素只覆盖1个物理像素</strong>。</p>
<p><img src="//chang20159.com/mobile-web-adaptive/image/scale_pixcel.png"></p>
<p>比如750的视觉稿，元素边框1px，我们CSS样式也写：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">div</span>&#123;</div><div class="line">	<span class="attribute">border-width</span>: <span class="number">1px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后js动态设置缩放逻辑大概是这样子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> doc = <span class="built_in">document</span>;</div><div class="line"><span class="keyword">var</span> docEl = <span class="built_in">document</span>.documentElement;</div><div class="line"><span class="keyword">var</span> isIos = navigator.appVersion.match(<span class="regexp">/(iphone|ipad|ipod)/gi</span>);</div><div class="line"><span class="keyword">var</span> dpr = <span class="built_in">window</span>.devicePixelRatio || <span class="number">1</span>;</div><div class="line"><span class="keyword">if</span> (!isIos)&#123; dpr = <span class="number">1</span> &#125;</div><div class="line"><span class="keyword">var</span> scale = <span class="number">1</span> / dpr;</div><div class="line"><span class="keyword">var</span> metaEl = doc.querySelector(<span class="string">'meta[name="viewport"]'</span>);</div><div class="line"><span class="keyword">if</span> (!metaEl) &#123;</div><div class="line">    metaEl = doc.createElement(<span class="string">"meta"</span>);</div><div class="line">    metaEl.setAttribute(<span class="string">"name"</span>, <span class="string">"viewport"</span>);</div><div class="line">    doc.head.appendChild(metaEl)</div><div class="line">&#125;</div><div class="line">metaEl.setAttribute(<span class="string">"content"</span>, <span class="string">"width=device-width,user-scalable=no,initial-scale="</span> + scale + <span class="string">",maximum-scale="</span> + scale + <span class="string">",minimum-scale="</span> + scale);</div></pre></td></tr></table></figure>
<p>那现在无论什么分辨率的设备，1个css像素实际只占1个物理像素了。</p>
<p>那现在效果是什么样子呢？</p>
<p><a href="http://chang20159.com/mobile-web-adaptive/demo3/demo3.html">demo3</a></p>
<p><img src="//chang20159.com/mobile-web-adaptive/demo3/demo3_200_200.png"></p>
<p>所有元素尺寸都缩小1/dpr了，本质上是1个css像素宽度缩小了1/dpr，不同dpr的设备上css像素大小就不同了。那我们css样式200px，在不同dpr的设备上所占宽度也不同了。</p>
<p><strong>注意： 如果在安卓设备上查看demo3，与demo2的效果相同，因为dpr都被处理成dpr=1，没有缩放，css样式又与750视觉稿一致。所以这种方式只缩放，不控制布局视不行的。</strong></p>
<p>这个问题可以在待会讲布局适配时解决，布局适配的目的是让元素在不同设备上占比一致（与视觉稿相同。）</p>
<h3 id="解决布局适配问题"><a href="#解决布局适配问题" class="headerlink" title="解决布局适配问题"></a>解决布局适配问题</h3><p>可以看下demo3的图</p>
<ul>
<li>不同屏幕大小的手机都是一样的高，在小屏手机中就需要向下滚动查看。</li>
<li>选择图片标签下一行展示4个，但在大屏手机中右边的空白就比较大。</li>
</ul>
<p>那我们希望，元素在布局视口中的占比（包括元素宽高、边距等）在不同设备上都相同</p>
<p>同一份样式怎么让元素占比相同呢？用绝对单位px肯定是不行的，我们考虑相对单位rem。</p>
<p>假如有个宽可以表示为20rem的元素：</p>
<table>
<thead>
<tr>
<th style="text-align:left">css样式</th>
<th style="text-align:left">css像素个数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">width:20rem</td>
<td style="text-align:left">20 * html元素的font-size</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">元素占比 = 元素css像素个数 ／ 布局视口宽度</div><div class="line">        = 20 * html元素的font-size / 布局视口宽度</div></pre></td></tr></table></figure>
<p>所以只要满足：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">常量值 *  html元素的font-size =  布局视口宽度</div></pre></td></tr></table></figure>
<p>元素占比在任何设备上都是某一个定值了。</p>
<p>那我们只要按下面的公式动态设置html元素的font-size就好啦。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">html元素的font-size = 布局视口宽度 ／ 常量值</div></pre></td></tr></table></figure>
<p>这个常量值可以是任意一个常数，但为了写样式方便，我们会做一些考虑，例如：</p>
<p>为了解决前面1px边框retina屏显示的问题，页面缩放了1/dpr，iphone6布局视口的宽度就是：375 * 2 个css像素</p>
<p>我们可以让iphone6中html元素的font-size = 375 * 2 ／ 7.5 = 100，这样可以直接将视觉稿中的尺寸除以100，得到rem单位的数值</p>
<p>对于以iphone6为基准的750视觉稿，并且缩放1/dpr，html元素的font-size 与 布局视口宽度视口的比例可以是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">html元素的font-size = 布局视口宽度 / 7.5</div></pre></td></tr></table></figure>
<p>对于以iphone5为基准的640视觉稿，并且缩放1/dpr</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">html元素的font-size = 布局视口宽度 / 6.4</div></pre></td></tr></table></figure>
<p>大概的实现就是这样子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> doc = <span class="built_in">document</span>;</div><div class="line"><span class="keyword">var</span> docEl = <span class="built_in">document</span>.documentElement;</div><div class="line"><span class="keyword">var</span> isIos = navigator.appVersion.match(<span class="regexp">/(iphone|ipad|ipod)/gi</span>);</div><div class="line"><span class="keyword">var</span> dpr = <span class="built_in">window</span>.devicePixelRatio || <span class="number">1</span>;</div><div class="line"><span class="keyword">if</span> (!isIos)&#123; dpr = <span class="number">1</span> &#125;</div><div class="line"><span class="keyword">var</span> scale = <span class="number">1</span> / dpr;</div><div class="line"><span class="keyword">var</span> metaEl = doc.querySelector(<span class="string">'meta[name="viewport"]'</span>);</div><div class="line"><span class="keyword">if</span> (!metaEl) &#123;</div><div class="line">    metaEl = doc.createElement(<span class="string">"meta"</span>);</div><div class="line">    metaEl.setAttribute(<span class="string">"name"</span>, <span class="string">"viewport"</span>);</div><div class="line">    doc.head.appendChild(metaEl)</div><div class="line">&#125;</div><div class="line">metaEl.setAttribute(<span class="string">"content"</span>, <span class="string">"width=device-width,user-scalable=no,initial-scale="</span> + scale + <span class="string">",maximum-scale="</span> + scale + <span class="string">",minimum-scale="</span> + scale);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> width = docEl.getBoundingClientRect().width;</div><div class="line">	docEl.style.fontSize = width / <span class="number">7.5</span> + <span class="string">'px'</span>;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>因为scale=1/dpr &amp;&amp; 基于750宽的视觉稿，元素的css样式（rem）可以直接由视觉稿尺寸除以100</p>
<p>最后的效果是： </p>
<p><a href="http://chang20159.com/mobile-web-adaptive/demo4/demo4.html">demo4</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">html元素的font-size = 布局视口宽度 / 10</div></pre></td></tr></table></figure>
<p><a href="http://chang20159.com/mobile-web-adaptive/demo5/demo5.html">demo5</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">html元素的font-size = 布局视口宽度 / 7.5</div></pre></td></tr></table></figure>
<p><img src="//chang20159.com/mobile-web-adaptive/demo4/demo4_200_200_10.png"></p>
<p><strong>那有人会问啦，我的视觉稿是基于iphone6的，但给的是一倍图宽375怎么办？</strong></p>
<p>视觉稿一般有两种类型： 一倍图 和 二倍图，比如基于iphone6的：</p>
<p>画布宽750，元素400 x 400<br>画布宽375，元素200 x 200</p>
<p>缩放一般有两种：</p>
<p>scale = 1，布局视口宽度 = 375个css像素<br>scale = 1/dpr，布局视口宽度 = 750个css像素</p>
<p>如果视觉稿选择画布宽750，并且scale=1，那元素css像素应该由<strong>视觉稿中的尺寸除以2</strong>，使布局视口宽度375中400/2 x 400/2 与 视觉稿宽750中400 x 400的元素比例一致</p>
<p>如果视觉稿选择画布宽375，并且scale=1/dpr，那元素css像素应该由<strong>视觉稿中的尺寸乘以2</strong>，使布局视口宽度750中的元素200x2 x 200x2 与 视觉稿宽375中400 x 400的元素比例一致</p>
<p>其他情况，元素css像素值就是视觉稿中的值。</p>
<p>知道这个之后，再决定px与rem的换算值：html元素的font-size，然后再写css样式（rem）。</p>
<p>举几个例子：</p>
<ul>
<li><p>如果视觉稿选择画布宽750，并且scale=1，html元素的font-size = 375 / 7.5 = 50，400／2/50= 4rem</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line"> <span class="attribute">width</span>: <span class="number">4rem</span>;</div><div class="line"> <span class="attribute">height</span>: <span class="number">4rem</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>如果视觉稿选择画布宽375，并且scale=1/dpr，html元素的font-size = 750 / 7.5 = 100，200 * 2 /100 = 4rem</p>
</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line"> <span class="attribute">width</span>: <span class="number">4rem</span>;</div><div class="line"> <span class="attribute">height</span>: <span class="number">4rem</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>画布宽750 &amp; scale=1/dpr，html元素的font-size = 750 / 7.5 = 100，400 ／ 100 = 4rem</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line"> <span class="attribute">width</span>: <span class="number">4rem</span>;</div><div class="line"> <span class="attribute">height</span>: <span class="number">4rem</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>画布宽375 &amp; scale=1，html元素的font-size = 375 / 7.5 = 50，200 ／ 50 = 4rem</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line"> <span class="attribute">width</span>: <span class="number">4rem</span>;</div><div class="line"> <span class="attribute">height</span>: <span class="number">4rem</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><blockquote>
<p>1、 设置html元素的font-size与布局视口宽度成比例，css样式使用相对单位rem，元素尺寸也就与布局视口宽度成比例，从而在每个设备布局一致。用视觉稿来确定这个比例值就能与视觉稿的布局一致。</p>
<p>2、 设置缩放比例为 1/dpr可以解决 1px边框问题。</p>
<p>为了rem与px换算方便，选定的比例值可以让html元素的font-size为100px。<br>iphone6就是7.5，iphone5就是6.4，不同基准的视觉稿rem与px换算比例都是100. </p>
<p>最后，如果不想动态适配的内容，可以直接使用px单位，比如字体，还有1px边框。</p>
</blockquote>
<h2 id="淘宝和网易的做法"><a href="#淘宝和网易的做法" class="headerlink" title="淘宝和网易的做法"></a>淘宝和网易的做法</h2><p>这里讲的适配方案是今天[2017-08-11]的，以后网站方案可能会有改动，所以我把代码保存下来了，可以看<strong>适配代码</strong></p>
<h3 id="手机淘宝"><a href="#手机淘宝" class="headerlink" title="手机淘宝"></a>手机淘宝</h3><ul>
<li><a href="https://m.taobao.com/#index" target="_blank" rel="external">网站</a></li>
<li><a href="//chang20159.com/mobile-web-adaptive/lib/taobao_flexible.js">适配代码</a></li>
</ul>
<p>淘宝统一定为10，iphone6是 1rem = 75px，iphone5 1rem = 64px,可以到<a href="https://m.taobao.com/#index" target="_blank" rel="external">手机淘宝</a>验证。不同基准的视觉稿rem与px换算比例不同。</p>
<h3 id="网易"><a href="#网易" class="headerlink" title="网易"></a>网易</h3><ul>
<li><a href="http://3g.163.com/" target="_blank" rel="external">网站</a></li>
<li><a href="//chang20159.com/mobile-web-adaptive/lib/wangyi_adaptive.js">适配代码</a></li>
</ul>
<p>并没有做缩放，只使用了相对单位rem。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">html的font-size = 布局视口宽度/7.5 = 设备屏幕宽度 / 7.5</div></pre></td></tr></table></figure>
<p>在iphone6上，html的font-size为 375/7.5 = 50px，如果他们的视觉稿是1倍图，那就是直接除以50来写css的，如果是二倍图，就是除以100来写css的。</p>
<p>这个比例可以随便设置，根据实际的需求，网易设置7.5时考虑换算简单，淘宝设置10则是考虑兼容vw。</p>
<h2 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h2><p>动态修改html元素的font-size和动态修改viewport在很多安卓设备上有兼容性问题。现在越来越多的浏览器支持vw、vh，viewport+rem的方案不一定是最好的方案。</p>
<p>对于1px边框的问题，也有很多其他的解决方案。</p>
<ul>
<li>判断终端类型是否支持0.5px，支持则直接定义边框为0.5px</li>
<li>使用css定义样式：-webkit-transform: scale(0.5)，对边框进行缩放</li>
<li>使用css实现阴影代替边框：-webkit-box-shadow:0 1px 1px -1px rgba(0, 0, 0, 0.5)</li>
<li>使用css定义背景样式（background-image）来实现边框</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://github.com/amfe/article/issues/17" target="_blank" rel="external">使用Flexible实现手淘H5页面的终端适配</a></li>
<li><a href="https://github.com/riskers/blog/issues/17" target="_blank" rel="external">移动端适配方案(上)</a></li>
<li><a href="https://github.com/riskers/blog/issues/18" target="_blank" rel="external">移动端适配方案(下) </a></li>
<li><a href="https://div.io/topic/1092" target="_blank" rel="external">移动端高清、多屏适配方案</a></li>
<li><a href="http://js8.in/2015/12/12/%E6%89%8B%E6%9C%BA%E7%99%BE%E5%BA%A6%E7%A7%BB%E5%8A%A8%E9%80%82%E9%85%8D%E5%88%87%E5%9B%BE%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%BB%8B%E7%BB%8D/" target="_blank" rel="external">手机百度移动适配切图解决方案介绍</a></li>
<li><a href="https://www.zhihu.com/question/38303534" target="_blank" rel="external">淘宝的flexible适配方案为什么只对iOS进行dpr判断，对于Android始终认为其dpr为1？</a></li>
<li><a href="http://www.jianshu.com/p/4e8f2c147d91" target="_blank" rel="external">Sketch用一倍图做设计稿还是二倍图？</a></li>
<li><a href="https://zhuanlan.zhihu.com/designcoder" target="_blank" rel="external">知乎专栏 DesignCoder</a></li>
</ul>
</div></div>]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[移动端web基础]]></title>
      <url>/%E7%A7%BB%E5%8A%A8%E7%AB%AFweb%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
      <content type="html"><![CDATA[<div align="center"><br><img src="../images/mobile_web_knowledge/mobile_web_knowledge.png" height="250"><br></div>

<a id="more"></a>
<h2 id="单位"><a href="#单位" class="headerlink" title="单位"></a>单位</h2><h3 id="CSS中的单位"><a href="#CSS中的单位" class="headerlink" title="CSS中的单位"></a>CSS中的单位</h3><h4 id="相对单位"><a href="#相对单位" class="headerlink" title="相对单位"></a>相对单位</h4><table>
<thead>
<tr>
<th style="text-align:left">font-size相关</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">rem</td>
<td style="text-align:left">相对于根元素(html元素)的font-size</td>
</tr>
<tr>
<td style="text-align:left">em</td>
<td style="text-align:left">相对于元素的font-size的计算值</td>
</tr>
<tr>
<td style="text-align:left">ex</td>
<td style="text-align:left">相对于元素字体的小写x的高度</td>
</tr>
<tr>
<td style="text-align:left">ch</td>
<td style="text-align:left">相对于元素字体中的字形“0”的宽度</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">viewport相关</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">vw</td>
<td style="text-align:left">相对于视口宽度    <code>1vw = window.innerWidth * 1%</code></td>
</tr>
<tr>
<td style="text-align:left">vh</td>
<td style="text-align:left">相对于视口高度 <code>1vw = window.innerHeight * 1%</code></td>
</tr>
<tr>
<td style="text-align:left">vmin</td>
<td style="text-align:left">vw和vh中较小的值</td>
</tr>
<tr>
<td style="text-align:left">vmax</td>
<td style="text-align:left">vw和vh中较大的值</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>window.innerHeight</code><br>浏览器窗口的视口（视觉视口）高度（单位：像素，大小是css像素的数量），包括水平滚动条。</p>
<p><code>window.innerWidth</code><br>浏览器视口（视觉视口）宽度（单位：像素，大小是css像素的数量），包括垂直滚动条。</p>
</blockquote>
<h4 id="绝对单位"><a href="#绝对单位" class="headerlink" title="绝对单位"></a>绝对单位</h4><ul>
<li>px<ul>
<li>与设备屏幕相关</li>
<li>对于普通屏幕，通常是显示器的一个设备像素（点）</li>
<li>对于打印机或高分辨率的屏幕，一个CSS像素对应多个设备像素</li>
</ul>
</li>
</ul>
<h3 id="安卓中的单位"><a href="#安卓中的单位" class="headerlink" title="安卓中的单位"></a>安卓中的单位</h3><ul>
<li>dp<ul>
<li>在定义UI布局时使用的虚拟像素单位，用于以密度无关方式表示布局维度或位置</li>
<li>1dp = 160 dpi 屏幕上的1个物理像素</li>
<li>在定义应用的 UI 时应始终使用 dp 单位 ，以确保在不同密度的屏幕上正常显示 UI</li>
</ul>
</li>
<li>sp</li>
<li>px</li>
</ul>
<h3 id="ios中的单位"><a href="#ios中的单位" class="headerlink" title="ios中的单位"></a>ios中的单位</h3><ul>
<li>pt </li>
<li>px </li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://developer.android.com/guide/practices/screens_support.html" target="_blank" rel="external">安卓多屏支持</a></li>
<li><a href="https://www.w3.org/TR/css3-values/#lengths" target="_blank" rel="external">CSS Values and Units Level 3</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Learn/CSS/Introduction_to_CSS/Values_and_units" target="_blank" rel="external">CSS的值和单位</a></li>
</ul>
<h2 id="像素（pixel）"><a href="#像素（pixel）" class="headerlink" title="像素（pixel）"></a>像素（pixel）</h2><h3 id="设备像素（physical-pixel）"><a href="#设备像素（physical-pixel）" class="headerlink" title="设备像素（physical pixel）"></a>设备像素（physical pixel）</h3><p>  设备像素又称<code>物理像素</code>（physical pixel），是显示器中最小的物理单元，设备能控制显示的最小单位。 每个像素根据操作系统的指示设置自己的颜色和亮度。</p>
<p>  <strong>任何设备的物理像素数量都是固定的</strong>。</p>
<h3 id="设备独立像素DIP"><a href="#设备独立像素DIP" class="headerlink" title="设备独立像素DIP"></a>设备独立像素DIP</h3><p>由程序使用并控制的虚拟像素，比如web编程中的CSS像素(px)、安卓（dp）、ios系统(pt)中的设备独立像素.</p>
<h3 id="CSS像素"><a href="#CSS像素" class="headerlink" title="CSS像素"></a>CSS像素</h3><p>CSS像素是Web编程中的概念，浏览器使用的抽象单元。 通常，CSS像素被称为与设备无关的像素（DIP）。在标准密度显示器上，1个CSS像素对应于1个设备像素。</p>
<p>例如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">height</span>=<span class="string">"200"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在普通屏幕上绘制200x300设备像素，在retina显示屏上为保证相同的物理尺寸，相同的div将使用400x600设备像素，这样在Retina显示屏上，相同物理表面的设备像素数量是普通显示屏的四倍。</p>
<p><img src="../images/mobile_web_knowledge//css_pixel.png"></p>
<h3 id="设备像素与设备独立像素"><a href="#设备像素与设备独立像素" class="headerlink" title="设备像素与设备独立像素"></a>设备像素与设备独立像素</h3><p>设备像素与设备独立像素有一定的对应关系，我们编程时控制的是设备独立像素，然后由相关系统转换为物理像素。</p>
<p>一个CSS像素相当于多少个设备像素由屏幕特性（是否是高密度）和缩放比例决定。放大得越大，一个CSS像素覆盖的设备像素越多。</p>
<h3 id="分辨率"><a href="#分辨率" class="headerlink" title="分辨率"></a>分辨率</h3><p> 显示器能显示的物理像素的数量，显示器可显示的像素越多，画面就越精细。</p>
<h3 id="屏幕像素密度-Screen-density"><a href="#屏幕像素密度-Screen-density" class="headerlink" title="屏幕像素密度(Screen density)"></a>屏幕像素密度(Screen density)</h3><p>屏幕像素密度是指物理表面的像素数量，通常以每英寸像素测量（PPI，pixel per inch）。ppi的值越高，画质越好。</p>
<p>苹果公司为其双重密度显示器创造了“Retina”营销术语，声称人眼不再能够将屏幕上的各个像素与“自然”观看距离区分开来。</p>
<div align="center"><br><img src="../images/mobile_web_knowledge/retina_display.jpg" width="400"><br></div>

<p>要计算显示器的屏幕像素密度（每英寸像素值），首先要确定屏幕尺寸和分辨率。</p>
<p><img src="../images/mobile_web_knowledge/ppi.png" width="300"></p>
<p>例如，苹果的iphone6s，像素分辨率： 1334 x 750，对角线长度4.7英寸。</p>
<div align="center"><br><img src="../images/mobile_web_knowledge/apple_iphone_device.png" width="400"><br></div><br>那屏幕像素密度就是：<br><br><img src="../images/mobile_web_knowledge/screen_density.png" width="350"><br><br>苹果公司认为，人类能肉眼识别的最高像素密度是300ppi<br><div align="center"><br><img src="../images/mobile_web_knowledge/retina-100611-2.jpg" width="400"><br></div>

<p>现在也有越来越多高分辨率的安卓手机（显示屏）与苹果iPhone的视网膜显示器相同。<br>根据屏幕每英寸像素值的不同，Android系统的开发者将平板电脑和手机的屏幕分成五类：</p>
<table>
<thead>
<tr>
<th style="text-align:left">名称</th>
<th style="text-align:left">显示等级</th>
<th style="text-align:left">每英寸像素值</th>
<th style="text-align:left">相似ppi的ios设备分类</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">LDPI    @0.75x</td>
<td style="text-align:left">低等像素密度</td>
<td style="text-align:left">大约120ppi</td>
</tr>
<tr>
<td style="text-align:left">MDPI    @1x</td>
<td style="text-align:left">中等像素密度</td>
<td style="text-align:left">大约160ppi</td>
<td style="text-align:left">标准点@1x</td>
</tr>
<tr>
<td style="text-align:left">HDPI    @1.5x</td>
<td style="text-align:left">高等像素密度</td>
<td style="text-align:left">大约180ppi</td>
</tr>
<tr>
<td style="text-align:left">XHDPI    @2x</td>
<td style="text-align:left">极高像素密度</td>
<td style="text-align:left">大约320ppi</td>
<td style="text-align:left">视网膜 @2x</td>
</tr>
<tr>
<td style="text-align:left">XXHDPI @3x</td>
<td style="text-align:left">超高像素密度</td>
<td style="text-align:left">大约480ppi</td>
<td style="text-align:left">高清视网膜 @3x</td>
</tr>
</tbody>
</table>
<h3 id="设备像素比dpr"><a href="#设备像素比dpr" class="headerlink" title="设备像素比dpr"></a>设备像素比dpr</h3><ul>
<li>缩放比为1时的物理像素分辨率与CSS像素分辨率的比值</li>
<li>在js中可以通过    <code>window.devicePixelRatio</code>获取，也可以重写<code>window.devicePixelRatio</code>来更改dpr</li>
<li>css中可以使用媒体查询  device-pixel-ratio</li>
</ul>
<h3 id="位图像素（Bitmap-Pixel）"><a href="#位图像素（Bitmap-Pixel）" class="headerlink" title="位图像素（Bitmap Pixel）"></a>位图像素（Bitmap Pixel）</h3><p><code>位图像素</code>是基于栅格的图像（JPG、PNG、GIF）中最小的单位，每个像素都包含屏幕上的显示信息，如位置、颜色等，有的图像信息还包含不透明度（Alpha Channel）。</p>
<div align="center"><br><img src="../images/mobile_web_knowledge/bitmap-pixels.png"><br></div>        

<p>位图图像除了自有的光栅分辨率，在web网页中有一个用CSS像素定义的抽象尺寸，web浏览器根据CSS设置的高度和宽度属性在屏幕上绘制基于栅格的图像，根据CSS尺寸可能会挤压或拉伸图像。</p>
<p>当在标准密度显示器上以完整尺寸绘制光栅图像时，1个位图像素对应1个设备像素，图像完全保真显示。因为位图像素不能进一步分割，在retina显示屏中，位图像素应该是标准屏上的4倍才能保真高清显示。</p>
<div align="center"><br><img src="../images/mobile_web_knowledge/css_device_bitmap.png" width="500"><br></div>    

<p>通常为Retina屏提供图像的方法是通过使用HTML或CSS编程手段将图像容器尺寸减半。</p>
<p>例如，要展示 200 x 300像素的图像（这是css像素），可以向服务器请求位图分辨率为400 x 600像素（4倍）的图像。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://img.meituan.net/beautyimg/0e03672ea40f4f692f193349b86aeb90299167.jpg%40400w_600h_1e_1c_1l_100q%7Cwatermark%3D0"</span>/&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line">	<span class="attribute">width</span>:<span class="number">200px</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">300px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这<strong>在标准密度显示器</strong>上，有一个<code>下采样</code>的过程。对于位图像素400x600的图像，要在200 x 300的设备像素上展示，需要对其进行2倍下采样，得到（400/2）x（600/2）的分辨率图像。那其实就是把 2 x 2窗口内的位图像素变成一个像素，这个像素点的值就是窗口内所有像素的均值。</p>
<p><img src="../images/mobile_web_knowledge/downsampling_spec.png"></p>
<p><strong>图像下采样原理</strong></p>
<blockquote>
<p>对于一幅图像I尺寸为M<em>N，对其进行s倍下采样，即得到(M/s)</em>(N/s)尺寸的得分辨率图像，当然s应该是M和N的公约数才行，如果考虑的是矩阵形式的图像，就是把原始图像s*s窗口内的图像变成一个像素。</p>
<p>这个像素点的值就是窗口内所有像素的均值:</p>
<math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>k</mi></msub><mo>&#xA0;</mo><mo>=</mo><mo>&#xA0;</mo><munder><mo>&#x2211;</mo><mrow><mi>i</mi><mo>&#x2208;</mo><mi>w</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>k</mi><mo>)</mo></mrow></munder><msub><mi>I</mi><mi>i</mi></msub><mo>&#xA0;</mo><mo>/</mo><mo>&#xA0;</mo><msup><mi>s</mi><mn>2</mn></msup></math>

</blockquote>
<p><strong>图像上采样原理</strong></p>
<blockquote>
<p>图像放大几乎都是采用内插值方法，即在原有图像像素的基础上在像素点之间采用合适的插值算法插入新的元素。</p>
</blockquote>
<p>为了在Retina显示屏上能够高清保真显示图像，需要加载2倍图像。但对于标准显示屏设备，如果同样使用2倍图像，会有几个问题：</p>
<ul>
<li>需要下载更大的图片资源，造成资源浪费</li>
<li>根据所使用的下采样算法，2倍图像在标准密度屏幕上会丢失一些锐度</li>
</ul>
<p><strong>这就是如何在移动端不同分辨率设备中图片高清保真显示的问题</strong>，不同屏幕密度的设备应该加载不同大小的图像，保证在不同设备上都能保真显示。</p>
<h4 id="移动端图片高清显示问题"><a href="#移动端图片高清显示问题" class="headerlink" title="移动端图片高清显示问题"></a>移动端图片高清显示问题</h4><h5 id="CSS媒体查询与background-image配合使用"><a href="#CSS媒体查询与background-image配合使用" class="headerlink" title="CSS媒体查询与background-image配合使用"></a>CSS媒体查询与background-image配合使用</h5><p>可以通过媒体查询的方式，对不同dpr设备使用不同分辨率的图像。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.icon</span> &#123;</div><div class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(example.png);</div><div class="line">  <span class="attribute">background-size</span>: <span class="number">200px</span> <span class="number">300px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</div><div class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@<span class="keyword">media</span> only screen and (-Webkit-min-device-pixel-ratio: <span class="number">1.5</span>),</div><div class="line">only screen and (-moz-min-device-pixel-ratio: <span class="number">1.5</span>),</div><div class="line">only screen and (-o-min-device-pixel-ratio: <span class="number">3</span>/<span class="number">2</span>),</div><div class="line">only screen and (min-device-pixel-ratio: <span class="number">1.5</span>) &#123;</div><div class="line">  <span class="selector-class">.icon</span> &#123;</div><div class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(example@2x.png);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>dpr查询使用1.5而不是2，可以用相同的语句来查询其他非Apple设备。<br>这种方式主要用于使用background-image属性显示的图像。</p>
<p><strong>优点</strong>            </p>
<ul>
<li>设备仅下载合适的目标资源</li>
<li>跨浏览器兼容</li>
<li>像素精确控制</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>编程代码繁琐，特别是在大型网站上</li>
<li>对于内容展示型图像显示为其他HTML元素的背景，这在语义上是不正确的</li>
</ul>
<h5 id="js控制加载合适尺寸的图像"><a href="#js控制加载合适尺寸的图像" class="headerlink" title="js控制加载合适尺寸的图像"></a>js控制加载合适尺寸的图像</h5><p>可以使用window.devicePixelRatio在Javascript中查询dpr，比CSS更容易设置图像。 然而，由于使用JavaScript，渲染可能会延迟。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.devicePixelRatio &gt; <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">var</span> images = $(<span class="string">'img'</span>);</div><div class="line"></div><div class="line">    images.each(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> lowres = $(<span class="keyword">this</span>).attr(<span class="string">'src'</span>);</div><div class="line">      <span class="keyword">var</span> highres = lowres.replace(<span class="string">"."</span>, <span class="string">"@2x."</span>);</div><div class="line">      $(<span class="keyword">this</span>).attr(<span class="string">'src'</span>, highres);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这种方式比较适合展示内容型图像。</p>
<p><strong>优点</strong></p>
<ul>
<li>易于实现</li>
<li>非Retina设备不需要下载大的图片资源</li>
<li>像素精确控制</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>Retina设备必须下载1倍图和2倍图</li>
<li>图像替换效果在Retina设备上能体现</li>
<li>window.devicePixelRatio不支持IE或Firefox。 </li>
</ul>
<h5 id="其他方案"><a href="#其他方案" class="headerlink" title="其他方案"></a>其他方案</h5><ul>
<li><p>可缩放矢量图形SVG</p>
<p>  不管使用什么方法，光栅图像都会被位图分辨率限制，不是无限可扩展的。但矢量图形无限缩放都不会影响清晰度</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"sample.svg"</span> <span class="attr">width</span>=<span class="string">"300"</span> <span class="attr">height</span>=<span class="string">"200"</span> /&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>字体图标 Icon Fonts</p>
</li>
</ul>
<h3 id="参考-1"><a href="#参考-1" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://zh.wikipedia.org/wiki/%E6%AF%8F%E8%8B%B1%E5%AF%B8%E5%83%8F%E7%B4%A0" target="_blank" rel="external">维基百科-每英寸像素</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E6%AF%8F%E8%8B%B1%E5%AF%B8%E7%82%B9%E6%95%B0" target="_blank" rel="external">每英寸点数</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/devicePixelRatio" target="_blank" rel="external">devicePixelRatio浏览器兼容性</a></li>
<li><a href="https://www.smashingmagazine.com/2012/08/towards-retina-web/" target="_blank" rel="external">Towards A Retina Web</a></li>
<li><a href="https://baike.baidu.com/item/%E5%9B%BE%E5%83%8F%E7%BC%A9%E6%94%BE" target="_blank" rel="external">图像缩放</a></li>
<li><a href="http://www.wiris.com/editor/demo/zh/mathml-latex" target="_blank" rel="external">MathML公式编辑器</a></li>
</ul>
<h2 id="视口"><a href="#视口" class="headerlink" title="视口"></a>视口</h2><p>在桌面浏览器中只有一个视口，视口的宽度 = 浏览器窗口宽度。在小屏的移动设备（宽度240px～640px）中，如果视口宽度和浏览器宽度一样，那为桌面浏览器设计的网页在移动端查看时会很丑，所以移动端浏览器厂商会设置一个默认的移动设备的视口宽度，在768px ~ 1024px之间，最常见的宽度是980px。</p>
<h3 id="布局视口"><a href="#布局视口" class="headerlink" title="布局视口"></a>布局视口</h3><p>  CSS的布局将根据上面介绍的视口来计算，所以在移动端这就叫<code>布局视口</code>。</p>
<div align="center"><br>    <img src="../images/mobile_web_knowledge/layout_viewport.png" width="300"><br> </div>

<h3 id="视觉视口"><a href="#视觉视口" class="headerlink" title="视觉视口"></a>视觉视口</h3><p>虽然移动端默认的布局视口宽度可以让为桌面浏览器设计的网页很好的展示，但只会有一部分内容展示在可视区域，这个区域被称为<code>视觉视口</code>。用户可以通过缩放来操作视觉视口。</p>
<div align="center"><br><img src="../images/mobile_web_knowledge/view_viewport.png" width="300"><br> </div>    

<h3 id="理想视口"><a href="#理想视口" class="headerlink" title="理想视口"></a>理想视口</h3><p>  对于移动端网页，默认的布局视口的宽度并不是一个理想的宽度，我们不希望需要通过缩放查看内容，所以浏览器厂商引进了<code>理想视口</code>的概念，与理想视口宽度相同的网页是最理想的用户浏览的宽度，刚进入页面时用户不需要缩放。</p>
<p>  那对于移动端网页，我们需要设置布局视口的宽度为理想视口的宽度。这需要在meta标签中声明： </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width"</span>/&gt;</span></div></pre></td></tr></table></figure>
<h3 id="参考-2"><a href="#参考-2" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="">移动web手册</a></li>
</ul>
<h2 id="meta标签"><a href="#meta标签" class="headerlink" title="meta标签"></a>meta标签</h2><p>上面提到了通过meta标签声明布局视口的宽度。<br>meta标签的常用属性：</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">可选值</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">charset</td>
<td style="text-align:left">UTF-8等</td>
<td style="text-align:left">声明当前文档所使用的字符编码</td>
</tr>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">author、description 、keywords、 viewport等</td>
<td style="text-align:left">把 content 属性关联到一个名称</td>
</tr>
<tr>
<td style="text-align:left">http-equiv</td>
<td style="text-align:left">content-type 、expire 、refresh 、set-cookie</td>
<td style="text-align:left">把content属性关联到HTTP头部</td>
</tr>
<tr>
<td style="text-align:left">content</td>
<td style="text-align:left">name属性相关的元信息，格式：key=value</td>
<td style="text-align:left">定义与http-equiv或name属性相关的元信息</td>
</tr>
</tbody>
</table>
<p>对于viewport元标签格式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"key=value, key=value"</span>/&gt;</span></div></pre></td></tr></table></figure>
<p>其中content内容：</p>
<ul>
<li><code>width</code>：布局视口宽度（数值 / device-width）（范围从200 到10,000，默认为980 像素）</li>
<li><code>height</code>：布局视口高度（数值 / device-height）（范围从223 到10,000）</li>
<li><code>initial-scale</code>：初始的缩放比例 （范围从&gt;0 到10）</li>
<li><code>minimum-scale</code>：允许用户缩放到的最小比例</li>
<li><code>maximum-scale</code>：允许用户缩放到的最大比例</li>
<li><code>user-scalable</code>：用户是否可以手动缩 (no,yes)</li>
</ul>
<p>对于移动端页面，常将布局视口宽度设置为理想视口宽度，并禁止缩放：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no"</span>/&gt;</span></div></pre></td></tr></table></figure>
<h3 id="参考-3"><a href="#参考-3" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/meta" target="_blank" rel="external">MDN meta标签</a></li>
</ul>
<h2 id="媒体查询"><a href="#媒体查询" class="headerlink" title="媒体查询"></a>媒体查询</h2><p><strong>媒体查询类型</strong></p>
<ul>
<li>媒介类型查询</li>
<li>视口相关</li>
<li>特性相关</li>
</ul>
<p><strong>语法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@media 媒体类型 and (视口特性阀值)&#123;</div><div class="line">    // 满足条件的css样式代码</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>媒体查询示例</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.sample</span> &#123;</div><div class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(sample.png);</div><div class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">@<span class="keyword">media</span> only screen and (-Webkit-min-device-pixel-ratio: <span class="number">1.5</span>),</div><div class="line">  only screen and (-moz-min-device-pixel-ratio: <span class="number">1.5</span>),</div><div class="line">  only screen and (-o-min-device-pixel-ratio: <span class="number">3</span>/<span class="number">2</span>),</div><div class="line">  only screen and (min-device-pixel-ratio: <span class="number">1.5</span>) &#123;</div><div class="line">    <span class="selector-class">.sample</span> &#123;</div><div class="line">        <span class="attribute">background-image</span>: <span class="built_in">url</span>(sample@2x.png);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>更多用法参考</strong></p>
<ul>
<li><a href="https://www.w3.org/TR/css3-mediaqueries/" target="_blank" rel="external">W3C关于媒体查询的介绍</a></li>
<li><a href="https://www.w3.org/TR/css3-mediaqueries/" target="_blank" rel="external">W3C 媒体查询标准</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[图片预加载和懒加载]]></title>
      <url>/%E5%9B%BE%E7%89%87%E9%A2%84%E5%8A%A0%E8%BD%BD%E5%92%8C%E6%87%92%E5%8A%A0%E8%BD%BD/</url>
      <content type="html"><![CDATA[<p>预加载和懒加载是两种加载资源的方式，适用于不同场景。常见的是图片的预加载和懒加载，最近开发组件库，图片组件就用到了预加载和懒加载，记录一下实现方式和相关知识点。</p>
<a id="more"></a>
<h3 id="预加载"><a href="#预加载" class="headerlink" title="预加载"></a>预加载</h3><p>预加载就是预先加载资源，在使用时就不需要再加载。比如预先加载图片，显示图片时直接从缓存读取不需要再发出网络请求了。</p>
<p>那预加载是怎么实现的呢？我们可以使用Image元素构造器。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> image = <span class="keyword">new</span> Image()</div><div class="line">image.src = <span class="string">'https://www.dpfile.com/sc/ares_pics/f6f4d77d040d9a0ab77e94059d1772c8.png'</span></div></pre></td></tr></table></figure>
<p>在使用图片之前，创建一个Image实例，并给实例的src实行赋值就可以请求图片。</p>
<p>我们还可以使用纯CSS或者Ajax实现预加载。</p>
<p>预加载的好处是提前加载，用户操作过程中响应更快。但是在一些场景下会牺牲服务器性能或浪费用户流量。比如一屏的图片很多，如果全部加载完，用户不一定能看得到，一次性耗费流量大而且首次等待时间较长。</p>
<p>这时候我们就可以用懒加载~~~</p>
<h3 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h3><p>懒加载，就是延迟加载的意思。</p>
<p>常见的一个场景就是，图片开始进入屏幕范围才加载。实现的原理是，预先给一个默认图片，当图片进入窗口可视范围时，再将src属性替换。</p>
<p>那什么时候图片开始进入屏幕呢？我们可以通过这三者来计算：</p>
<ul>
<li>窗口顶部与文档顶部之间的距离（scrollTop）</li>
<li>可视窗口的高度（clientheight）</li>
<li>图片与文档顶部的距离(offsetTop)</li>
</ul>
<p><strong>计算屏幕可视窗口大小</strong></p>
<ul>
<li>window.innerHeight 标准浏览器及IE9+ </li>
<li>document.documentElement.clientHeight 标准浏览器及低版本IE标准模式 </li>
<li>document.body.clientHeight  低版本混杂模式</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getClientHeight</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span>  <span class="built_in">window</span>.innerHeight ? <span class="built_in">window</span>.innerHeight : <span class="built_in">document</span>.compatMode === <span class="string">'BackCompat'</span> ? <span class="built_in">document</span>.body.clientHeight : <span class="built_in">document</span>.documentElement.clientHeight</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>计算顶部与文档顶部之间的距离</strong></p>
<ul>
<li>window.pageYOffset 标准浏览器及IE9+ </li>
<li>document.documentElement.scrollTop 兼容ie低版本的标准模式 </li>
<li>document.body.scrollTop 兼容混杂模式</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getBodyScrollTop</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span>  <span class="built_in">window</span>.pageYOffset ?  <span class="built_in">window</span>.pageYOffset :  <span class="built_in">document</span>.compatMode === <span class="string">'BackCompat'</span> ? <span class="built_in">document</span>.body.scrollTop : <span class="built_in">document</span>.documentElement.scrollTop</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>计算图片与文档顶部的距离</strong></p>
<p>可以通过offsetTop来计算</p>
<p>MDN上对于offsetTop的定义：返回当前元素相对于其 offsetParent 元素的顶部的距离。</p>
<blockquote>
<p>HTMLElement.offsetParent 是一个只读属性，返回一个指向最近的（closest，指包含层级上的最近）包含该元素的定位元素。如果没有定位的元素，则 offsetParent 为最近的 table cell 元素对象或根元素（标准模式下为 html；quirks 模式下为 body）。当元素的 style.display 设置为 “none” 时，offsetParent 返回 null。offsetParent 很有用，因为 offsetTop 和 offsetLeft 都是相对于其内边距边界的。</p>
</blockquote>
<p>所以图片与文档顶部的距离可以这样计算：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getOffsetTop</span>(<span class="params">elem</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> offsetTop = <span class="number">0</span></div><div class="line">    <span class="keyword">if</span> (elem.offsetParent) &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            offsetTop += elem.offsetTop</div><div class="line">            elem = elem.offsetParent</div><div class="line">        &#125; <span class="keyword">while</span> (elem)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> offsetTop &gt;= <span class="number">0</span> ? offsetTop : <span class="number">0</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>懒加载的实现：</p>
<p>当 bodyScrollTop + bodyHeight &gt;= imageTop时加载图片</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">lazyLoadImage()&#123;</div><div class="line">    <span class="keyword">this</span>.scrollTop = getBodyScrollTop()</div><div class="line">    <span class="keyword">this</span>.bodyHeight = getClientHeight()</div><div class="line">    <span class="keyword">this</span>.imageTop = getOffsetTop(<span class="keyword">this</span>.$refs.imageParentRef)</div><div class="line">    <span class="keyword">if</span>(!<span class="keyword">this</span>.load &amp;&amp; (<span class="keyword">this</span>.scrollTop + <span class="keyword">this</span>.bodyHeight &gt;= <span class="keyword">this</span>.imageTop))&#123;</div><div class="line">        <span class="keyword">this</span>.loadImage()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">loadImage()&#123;</div><div class="line">    <span class="keyword">try</span>&#123;</div><div class="line">        <span class="keyword">let</span> img = <span class="keyword">new</span> Image()</div><div class="line">        img.src = <span class="keyword">this</span>.src</div><div class="line">        <span class="keyword">this</span>.load = <span class="literal">true</span></div><div class="line">        </div><div class="line">        <span class="keyword">if</span>(img.complete)&#123;</div><div class="line">            <span class="keyword">this</span>.handleLoadSuccess(img)</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        img.onload = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">            img.onload = <span class="literal">null</span></div><div class="line">            <span class="keyword">this</span>.handleLoadSuccess(img)</div><div class="line">        &#125;</div><div class="line">    &#125;<span class="keyword">catch</span>(err)&#123;</div><div class="line">        <span class="keyword">this</span>.$emit(<span class="string">'load'</span>,err)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当图片滚动到刚进入视图时，才会加载。但是可能由于网络速度较慢等原因，图片滚动到可视区域内时都没有加载完毕，会出现闪屏。</p>
<p>为了更好的用户体验，我们可以在用户再滚动半屏就能看到图片的位置就加载图片，加载的条件判断可以改成：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.scrollTop + <span class="keyword">this</span>.bodyHeight + <span class="keyword">this</span>.bodyHeight/<span class="number">2</span> &gt;= <span class="keyword">this</span>.imageTop</div></pre></td></tr></table></figure>
<p>另外，在加载图片完成后会触发onload事件，但img加载完成就会解除onload事件，src是异步加载图片的，如果在绑定事件前就已经加载完成，onload事件不会触发，这时可以先用img.complete属性判断。</p>
<blockquote>
<p>complete 属性可返回浏览器是否已完成对图像的加载，如果加载完成，则返回 true，否则返回fasle。</p>
</blockquote>
<p>在图片加载完成后，就可以在handleLoadSuccess方法中获取图片宽高，设置图片的显示方式了。</p>
<p><strong>注意： 懒加载图片应该先预加载默认图片(俗称：占位图)，用于计算图片位置。</strong></p>
]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue组件开发常见问题及技巧]]></title>
      <url>/Vue%E7%BB%84%E4%BB%B6%E5%BA%93%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E5%8F%8A%E6%8A%80%E5%B7%A7/</url>
      <content type="html"><![CDATA[<p>Vue组件库开发，记录过程中的问题和经验。 手机端Vue组件库，戳&gt;  <a href="https://future-team.github.io/swan-ui/examples/index.html#/" target="_blank" rel="external">Swan UI</a></p>
<a id="more"></a>
<h3 id="一、props检测设定任意类型"><a href="#一、props检测设定任意类型" class="headerlink" title="一、props检测设定任意类型"></a>一、props检测设定任意类型</h3><p>设置为null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">props: &#123;</div><div class="line">	title: null</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="二、组件外部传入class无法覆盖组件内部动态class"><a href="#二、组件外部传入class无法覆盖组件内部动态class" class="headerlink" title="二、组件外部传入class无法覆盖组件内部动态class"></a>二、组件外部传入class无法覆盖组件内部动态class</h3><p>当给自定义组件添加class时，组件根元素上class的顺序是：</p>
<ul>
<li>inner-class（内部class）</li>
<li>outer-class(外部传入class)</li>
<li>inner-dynamic-class(内部动态计算class)</li>
</ul>
<p>使用组件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sw-button</span> <span class="attr">class</span>=<span class="string">"outer-class"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">sw-button</span>&gt;</span></div></pre></td></tr></table></figure>
<p>组件内部结构：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"inner-class"</span> <span class="attr">:class</span>=<span class="string">"&#123;'inner-dynamic-class':true&#125;"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></div></pre></td></tr></table></figure>
<p>最终结构：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"inner-class outer-class inner-dynamic-class"</span> &gt;</span></div><div class="line">	按钮 </div><div class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></div></pre></td></tr></table></figure>
<p>对于需要修改组件样式的使用方，外部传入组件的class属性 outer-class 始终在内部动态属性之前，无法覆盖内部属性</p>
<p><strong>解决办法是：组件外部也是用动态class</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sw-button</span> <span class="attr">:class</span>=<span class="string">"&#123;'outer-class':true&#125;"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">sw-button</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="三、样式文件中引入npm安装包报错"><a href="#三、样式文件中引入npm安装包报错" class="headerlink" title="三、样式文件中引入npm安装包报错"></a>三、样式文件中引入npm安装包报错</h3><p style="color:red;"><br>Module not found: Error: Can’t resolve ‘./phoenix-styles/less/public.less’ in ‘/Users/chang/future-team/swan-ui/src/modules’<br> @ ./~/css-loader!./~/vue-loader/lib/style-compiler?{“vue”:true,”id”:”data-v-e577e6cc”,”scoped”:false,”hasInlineConfig”:false}!./~/vue-loader/lib/selector.js?type=styles&amp;index=0!./src/modules/Input.vue 3:10-95<br></p>

<p> *.vue文件中引入npm安装包:</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;style lang="less" src="phoenix-styles/less/public.less"&gt;&lt;/style&gt;</div></pre></td></tr></table></figure>
<h3 id="四、class属性不能作为组件的prop"><a href="#四、class属性不能作为组件的prop" class="headerlink" title="四、class属性不能作为组件的prop"></a>四、class属性不能作为组件的prop</h3><p style="color:red;"><br> “class” is a reserved attribute and cannot be used as component prop.<br></p>

<p>我想拿到传给组件的class，不想让他直接添加到组件根元素上肿么破？</p>
<blockquote>
<p>Vue handles passing the class attribute through automatically - I think you can just delete the entire object and prop declaration and it will continue working fine.</p>
</blockquote>
<h3 id="五、将属性合并赋值"><a href="#五、将属性合并赋值" class="headerlink" title="五、将属性合并赋值"></a>五、将属性合并赋值</h3><p>利用v-bind可以直接赋值对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"ph-multi-group"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">"`ph-$&#123;type&#125;`"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">"nativeProps"</span> @<span class="attr">change</span>=<span class="string">"handleChange"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;label&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="六、-在vue的render方法中使用JSX"><a href="#六、-在vue的render方法中使用JSX" class="headerlink" title="六、 在vue的render方法中使用JSX"></a>六、 在vue的render方法中使用JSX</h3><p>babel配置文件.babelrc添加插件 transform-vue-jsx</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"presets"</span>: [[<span class="string">"es2015"</span>, &#123; <span class="attr">"loose"</span>: <span class="literal">false</span> &#125;]],</div><div class="line">  <span class="attr">"plugins"</span>: [<span class="string">"transform-vue-jsx"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>安装插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev babel-plugin-transform-vue-jsx</div></pre></td></tr></table></figure>
<h3 id="七、自定义-v-model-mixins"><a href="#七、自定义-v-model-mixins" class="headerlink" title="七、自定义 v-model + mixins"></a>七、自定义 v-model + mixins</h3><p>隐藏/显示类组件采用双向绑定，避免书写关闭打开等样板代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 定制隐藏/显示切换类组件的 v-model</div><div class="line"> */</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">    <span class="attr">model</span>: &#123;</div><div class="line">        <span class="attr">prop</span>: <span class="string">'visible'</span>,</div><div class="line">        <span class="attr">event</span>: <span class="string">'toggle'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">methods</span>: &#123;</div><div class="line">        handleToggle(val)&#123;</div><div class="line">            <span class="keyword">this</span>.$emit(<span class="string">'toggle'</span>,val)</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">props</span>: &#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line">         * 是否可见标识</div><div class="line">         * @property visible</div><div class="line">         * @type Boolean</div><div class="line">         * */</div><div class="line">        visible: &#123;</div><div class="line">            <span class="attr">type</span>: <span class="built_in">Boolean</span>,</div><div class="line">            <span class="attr">default</span>: <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="八、声明组件props时，同时声明组件内部使用的其他组件的props"><a href="#八、声明组件props时，同时声明组件内部使用的其他组件的props" class="headerlink" title="八、声明组件props时，同时声明组件内部使用的其他组件的props"></a>八、声明组件props时，同时声明组件内部使用的其他组件的props</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">sw-checkbox</span> <span class="attr">v-bind</span>=<span class="string">"$props"</span> @<span class="attr">change</span>=<span class="string">"handleChange"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">    <span class="keyword">import</span> SwCheckbox <span class="keyword">from</span> <span class="string">'../checkbox/Checkbox.vue'</span></div><div class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'SwRadio'</span>,</div><div class="line">        <span class="attr">components</span>: &#123;SwCheckbox&#125;,</div><div class="line">        <span class="attr">methods</span>: &#123;</div><div class="line">            handleChange(value,evt)&#123;</div><div class="line">                <span class="keyword">this</span>.$emit(<span class="string">'change'</span>,value,evt)</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">props</span>: <span class="built_in">Object</span>.assign(&#123;&#125;,SwCheckbox.props,&#123;</div><div class="line">            <span class="attr">type</span>: &#123;</div><div class="line">                <span class="attr">type</span>: <span class="built_in">String</span>,</div><div class="line">                <span class="attr">default</span>: <span class="string">'radio'</span></div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p><strong>注意： 2.4.0版本新增了 inheritAttrs选项和实例属性$attrs，可以这样写了：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">sw-checkbox</span>  <span class="attr">:type</span>=<span class="string">"type"</span> </span></div><div class="line">    				 <span class="attr">v-bind</span>=<span class="string">"$attrs"</span> </div><div class="line">    				 @<span class="attr">change</span>=<span class="string">"handleChange"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">    <span class="keyword">import</span> SwCheckbox <span class="keyword">from</span> <span class="string">'../checkbox/Checkbox.vue'</span></div><div class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'SwRadio'</span>,</div><div class="line">        <span class="attr">inheritAttrs</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">components</span>: &#123;SwCheckbox&#125;,</div><div class="line">        <span class="attr">methods</span>: &#123;</div><div class="line">            handleChange(value,evt)&#123;</div><div class="line">                <span class="keyword">this</span>.$emit(<span class="string">'change'</span>,value,evt)</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">props</span>: &#123;</div><div class="line">            <span class="attr">type</span>: &#123;</div><div class="line">                <span class="attr">type</span>: <span class="built_in">String</span>,</div><div class="line">                <span class="attr">default</span>: <span class="string">'radio'</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<h3 id="九、双向watch或双向computed解决使用v-model的问题"><a href="#九、双向watch或双向computed解决使用v-model的问题" class="headerlink" title="九、双向watch或双向computed解决使用v-model的问题"></a>九、双向watch或双向computed解决使用v-model的问题</h3><p>例如使用dialog组件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sw-dialog</span> <span class="attr">title</span>=<span class="string">"提示"</span> <span class="attr">v-model</span>=<span class="string">"visible"</span>&gt;</span></div><div class="line">    您确定以及肯定要提交吗？</div><div class="line"><span class="tag">&lt;/<span class="name">sw-dialog</span>&gt;</span></div></pre></td></tr></table></figure>
<p>当另一个组件Alert使用dialog组件时：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">sw-dialog</span> <span class="attr">title</span>=<span class="string">"提示"</span> <span class="attr">v-model</span>=<span class="string">"visible"</span>&gt;</span></div><div class="line">	    &#123;&#123;content&#125;&#125;</div><div class="line">	<span class="tag">&lt;/<span class="name">sw-dialog</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<p>那如果我们要使用Alert组件:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sw-alert</span> <span class="attr">title</span>=<span class="string">"提示"</span> <span class="attr">v-model</span>=<span class="string">"visible"</span> <span class="attr">content</span>=<span class="string">"您确定以及肯定要提交吗？"</span> /&gt;</span></div></pre></td></tr></table></figure>
<p>由于内部dialog组件使用双向绑定，弹框关闭时，visible属性会被直接更改，不能通知sw-alert。这种情况在使用数据管理框架例如vuex时也可能出现。</p>
<p>那我们可以添加一个中间属性，使用双向watch或双向computed来解决。</p>
<p>在alert组件组件中双向watch：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">sw-alert</span> <span class="attr">title</span>=<span class="string">"提示"</span>  <span class="attr">v-model</span>=<span class="string">"currentVisible"</span> <span class="attr">content</span>=<span class="string">"您确定以及肯定要提交吗？"</span> /&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">model: &#123;</div><div class="line">    <span class="attr">prop</span>: <span class="string">'visible'</span>,</div><div class="line">    <span class="attr">event</span>: <span class="string">'toggle'</span></div><div class="line">&#125;</div><div class="line">watch: &#123;</div><div class="line">    visible(val)&#123;</div><div class="line">        <span class="keyword">this</span>.currentVisible = val</div><div class="line">    &#125;,</div><div class="line">    currentVisible(val)&#123;</div><div class="line">        <span class="keyword">this</span>.$emit(<span class="string">'toggle'</span>,val) </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>或者双向computed(这个没有具体实施，应该是可以的):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">model: &#123;</div><div class="line">    <span class="attr">prop</span>: <span class="string">'visible'</span>,</div><div class="line">    <span class="attr">event</span>: <span class="string">'toggle'</span></div><div class="line">&#125;</div><div class="line">computed: &#123;</div><div class="line">    visible()&#123;</div><div class="line">    	 <span class="keyword">this</span>.$emit(<span class="string">'toggle'</span>,<span class="keyword">this</span>.currentVisible) </div><div class="line">    	 <span class="keyword">return</span> <span class="keyword">this</span>.currentVisible</div><div class="line">    &#125;,</div><div class="line">    currentVisible()&#123;</div><div class="line">        <span class="keyword">return</span>  <span class="keyword">this</span>.visible</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="十、props属性不需要声明也可以使用"><a href="#十、props属性不需要声明也可以使用" class="headerlink" title="十、props属性不需要声明也可以使用"></a>十、props属性不需要声明也可以使用</h3><p>  2.4.0版本之前，父作用域传递的属性，在props中声明才可以使用，这对类似Input之类的组件扩展性不好，需要把input属性都声明出来，有点啰嗦。</p>
<p>  vue 2.4.0新增的inheritAttrs选项和实例属性$attrs， 可以解决这个问题啦～</p>
<p>  <strong>inheritAttrs选项:</strong></p>
<blockquote>
<p>默认情况下父作用域的不被认作 props 的特性绑定 (attribute bindings) 将会“回退”且作为普通的 HTML 特性应用在子组件的根元素上。</p>
<p>当撰写包裹一个目标元素或另一个组件的组件时，这可能不会总是符合预期行为。通过设置 inheritAttrs 到 false，这些默认行为将会被去掉。而通过 (同样是 2.4 新增的) 实例属性 $attrs 可以让这些特性生效，且可以通过 v-bind 显性的绑定到非根元素上。</p>
<p><strong>注意：这个选项不影响 class 和 style 绑定。</strong></p>
</blockquote>
<p><strong>实例属性$attrs:</strong></p>
<blockquote>
<p>包含了父作用域中不被认为 (且不预期为) props 的特性绑定 <strong>(class 和 style 除外)</strong>。当一个组件没有声明任何 props 时，这里会包含所有父作用域的绑定 (class 和 style 除外)，并且可以通过 v-bind=”$attrs” 传入内部组件——在创建更高层次的组件时非常有用。</p>
</blockquote>
<p>之前对于Input组件，我需要声明尽可能多的常用的input的原生属性，并手动分离出来添加到input标签上：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">"nativeProps"</span>/&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">computed: &#123;</div><div class="line">	nativeProps()&#123;</div><div class="line">        <span class="keyword">let</span> props = [<span class="string">'name'</span>,<span class="string">'maxlength'</span>,<span class="string">'minlength'</span>,<span class="string">'disabled'</span>,<span class="string">'autocomplete'</span>,<span class="string">'autofocus'</span>,<span class="string">'min'</span>,<span class="string">'max'</span>,<span class="string">'readonly'</span>]</div><div class="line">	    <span class="keyword">let</span> nativeProps = &#123;&#125;</div><div class="line">	    props.forEach(<span class="function">(<span class="params">key</span>)=&gt;</span>&#123;</div><div class="line">	        <span class="keyword">if</span>(<span class="keyword">this</span>.$props[key])&#123;</div><div class="line">	            nativeProps[key] = <span class="keyword">this</span>.$props[key]</div><div class="line">	        &#125;</div><div class="line">	    &#125;)</div><div class="line">	    <span class="keyword">return</span> nativeProps</div><div class="line">	&#125;</div><div class="line">&#125;,</div><div class="line"><span class="attr">props</span>:&#123;</div><div class="line">    <span class="attr">visible</span>: <span class="built_in">Boolean</span>,</div><div class="line">    <span class="attr">clear</span>: <span class="built_in">Boolean</span>,</div><div class="line">    <span class="comment">//以下是input原生属性</span></div><div class="line">	placeholder: <span class="built_in">String</span>,</div><div class="line">    <span class="attr">disabled</span>: <span class="built_in">Boolean</span>,</div><div class="line">    <span class="attr">maxlength</span>: <span class="built_in">Number</span>,</div><div class="line">    <span class="attr">minlength</span>: <span class="built_in">Number</span>,</div><div class="line">    <span class="attr">autocomplete</span>: <span class="built_in">String</span>,</div><div class="line">    <span class="attr">autofocus</span>: <span class="built_in">Boolean</span>,</div><div class="line">    <span class="attr">readonly</span>:<span class="built_in">Boolean</span>,</div><div class="line">    <span class="attr">value</span>: <span class="literal">null</span>,</div><div class="line">    <span class="attr">name</span>: <span class="literal">null</span>,</div><div class="line">    <span class="attr">min</span>:<span class="literal">null</span>,</div><div class="line">    <span class="attr">max</span>:<span class="literal">null</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>现在可以这样写了：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span>/&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">inheritAttrs: <span class="literal">false</span>,</div><div class="line"><span class="attr">props</span>: &#123;</div><div class="line">	<span class="attr">visible</span>: <span class="built_in">Boolean</span>,</div><div class="line">	<span class="attr">clear</span>: <span class="built_in">Boolean</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Vue </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[了解前端模块化]]></title>
      <url>/%E4%BA%86%E8%A7%A3%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>之前写过一个Demo，还顺便写了一篇文 <a href="./模块管理与打包实践.md">模块管理与打包实践</a>，但对于前端模块化的规范和模块加载器原理没有深入探究。</p>
<p>关于为什么要前端模块化，实际上是要解决<code>文件依赖</code>和<code>命名空间</code>的问题，具体可以看 <a href="./模块管理与打包实践.md">模块管理与打包实践</a>  或者 玉伯的这篇 <a href="https://github.com/seajs/seajs/issues/547?utm_source=caibaojian.com" target="_blank" rel="external">前端模块化开发的价值</a></p>
<a id="more"></a>
<h2 id="了解历史"><a href="#了解历史" class="headerlink" title="了解历史"></a>了解历史</h2><p>JavaScript本身一直没有模块体系，js文件的加载都是使用最简单的script标签，使得每个模块的接口都暴露在全局作用域中。容易造成一些问题，比如:</p>
<ul>
<li>全局作用域下变量冲突</li>
<li>相互依赖的文件需要按以来的顺序书写，开发人员需要自己解决模块间依赖关系</li>
<li>模块只能按script标签的顺序加载</li>
</ul>
<p>所以后来就有社区制定了一些模块加载方案，经常会看到CommonJS、AMD、CMD等规范，还有一些常见的模块加载器RequireJS、SeaJS等。</p>
<p>关于这些模块加载方案的由来可以看下玉伯的这篇 <a href="https://github.com/seajs/seajs/issues/588" target="_blank" rel="external">前端模块化开发那点历史 </a>  或者 阮一峰的 <a href="http://www.ruanyifeng.com/blog/2012/10/asynchronous_module_definition.html" target="_blank" rel="external">Javascript模块化编程（二）：AMD规范</a></p>
<p>大概的历史是这样的：</p>
<blockquote>
<ol>
<li>2009年1月，Mozilla 的工程师 Kevin Dangoor创建了ServerJS；2009年8月，项目改名为 CommonJS。<code>CommonJS</code> 是一套规范。</li>
<li>2009年，美国程序员Ryan Dahl创造了node.js项目，<code>node.js的模块系统</code>就是参照CommonJS的模块规范写的。</li>
<li>但是CommonJS规范中的require是同步的，这在浏览器端是不能接受的。所以后来就有了 <code>AMD 规范</code>，<code>RequireJS</code>是AMD规范的实现。</li>
<li>再后来玉伯觉得RequireJS不够完善，给RequireJS团队提的很多意见都不被采纳，就自己写了Sea.js，并制定了<code>CMD规范</code>，<code>Sea.js</code>遵循CMD规范。</li>
<li>2015年6月正式发布了<code>ECMAScript6标准</code>，在语言标准层面实现了模块功能，完全可以取代 CommonJS 和 AMD 规范，成为浏览器和服务器通用的模块解决方案。</li>
</ol>
</blockquote>
<h2 id="主流模块加载器和它的规范"><a href="#主流模块加载器和它的规范" class="headerlink" title="主流模块加载器和它的规范"></a>主流模块加载器和它的规范</h2><h3 id="CommonJS-与-Nodejs"><a href="#CommonJS-与-Nodejs" class="headerlink" title="CommonJS 与 Nodejs"></a>CommonJS 与 Nodejs</h3><p>CommonJS对模块的定义十分简单，主要分为模块加载、模块定义和模块标识3个部分。</p>
<p><strong>模块加载</strong></p>
<pre><code>通过require方法引入一个模块，require方法接受一个模块标识作为参数。
</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> math = <span class="built_in">require</span>(<span class="string">'math'</span>)</div></pre></td></tr></table></figure>
<p><strong>模块定义</strong></p>
<p><code>module</code>对象表示模块本身，<code>exports</code>是<code>module</code>对象的属性，module.exports是模块唯一的导出口，用于导出当前模块的方法或变量。Node为每个模块提供一个exports变量，指向module.exports。这也是为什么不能直接对exports赋值的原因，因为这样就切断了exports与module.exports的联系。我们可以直接向exports对象添加方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//math.js</span></div><div class="line">exports.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;</div></pre></td></tr></table></figure>
<p>在另一个文件中，通过require就可以引入了：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index.js</span></div><div class="line"><span class="keyword">var</span> math = <span class="built_in">require</span>(<span class="string">'math'</span>)</div><div class="line"><span class="keyword">export</span>.result = math.add(<span class="number">1</span>,<span class="number">3</span>);</div></pre></td></tr></table></figure>
<ul>
<li><p><strong>模块标识</strong></p>
<p>  模块标识就是传递给require的参数，可以是以.、..等开头的相对路径、或者绝对路径、或者字符串。</p>
</li>
</ul>
<p>关于Node模块系统更详细的使用方法可以参考阮一峰的 <a href="http://javascript.ruanyifeng.com/nodejs/module.html" target="_blank" rel="external">CommonJS规范</a></p>
<h3 id="AMD-与-RequireJS"><a href="#AMD-与-RequireJS" class="headerlink" title="AMD 与 RequireJS"></a>AMD 与 RequireJS</h3><p>全称： Asynchronous Module Definition ，异步模块加载机制。RequireJS正是AMD规范的一种实现。</p>
<p><strong>AMD规范的的核心思想</strong>：模块的加载不影响在它之后的程序的执行，所有依赖这个模块的语句都定义在一个回调函数中，模块加载完成后，再运行回调函数。</p>
<p>AMD规范也分模块加载、模块定义。</p>
<p><strong>模块加载</strong></p>
<p>也采用require()语句加载模块，并执行加载完之后的逻辑</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>([deps], callback);</div></pre></td></tr></table></figure>
<p>例如：index.js中依赖module1，module2</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">    <span class="attr">path</span>: &#123;</div><div class="line">        <span class="attr">module</span>: <span class="string">'./module'</span>,</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="built_in">require</span>([<span class="string">'module/module1.js'</span>,<span class="string">'module/module2.js'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">module1,module2</span>)</span>&#123;</div><div class="line">    module1.printModule1FileName();</div><div class="line">    module2.printModule2FileName();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong>模块定义</strong></p>
<p>通过define函数定义在闭包中，define函数格式为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">define(id,[deps],factory)</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">id</td>
<td style="text-align:left">模块的名字，<strong>可选参数</strong></td>
</tr>
<tr>
<td style="text-align:left">deps</td>
<td style="text-align:left">自身依赖的模块列表，<strong>这些依赖模块的输出作为factory的参数。可选参数。</strong><br>如果没有指定，则默认的依赖模块为[‘require’,’exports’,’module’]</td>
</tr>
<tr>
<td style="text-align:left">factory</td>
<td style="text-align:left">一个函数或者对象。<strong>若是一个函数，该函数的返回值就是模块的输出。</strong></td>
</tr>
</tbody>
</table>
<p>例如定义module1：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">printModule1FileName</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">document</span>.write(<span class="string">'This is module1&lt;br/&gt;'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">filename</span>:<span class="string">"module1"</span>,</div><div class="line">        <span class="attr">printModule1FileName</span>:printModule1FileName</div><div class="line">    &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="CMD-与-SeaJS"><a href="#CMD-与-SeaJS" class="headerlink" title="CMD 与 SeaJS"></a>CMD 与 SeaJS</h3><p>全称： Common Module Definition。</p>
<p>CMD也采用define来定义模块，require来加载模块，但用法不太相同。</p>
<p><strong>模块加载</strong></p>
<p>require方法，接受 模块标识 作为唯一参数，用来获取其他模块提供的接口。</p>
<p><strong>模块定义</strong></p>
<p>define的用法有点像CommonJS 与 AMD的结合体，用法多样。可以直接看 <a href="https://github.com/seajs/seajs/issues/242" target="_blank" rel="external">CMD 模块定义规范</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">define(function(require, exports, module) &#123;</div><div class="line"></div><div class="line">  // 模块代码</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="ES6模块"><a href="#ES6模块" class="headerlink" title="ES6模块"></a>ES6模块</h3><p>模块功能主要由两个命令构成：export和import。关于ES6模块的用法可以参考 <a href="http://es6.ruanyifeng.com/#docs/module#%E6%A6%82%E8%BF%B0" target="_blank" rel="external">Module 的语法</a> 和 <a href="http://www.infoq.com/cn/articles/es6-in-depth-modules" target="_blank" rel="external">深入浅出ES6（十六）：模块 Modules</a>.ES6模块系统与那些模块加载器不同，它是一个静态的模块系统，在编译时就能确定模块关系。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>CommonJS 没有什么好说的，同步加载模块，只有加载完成，才能执行后面的操作。反而是在浏览器端使用的模块加载器 Require.js 与 Sea.js网上有很多争论和对比，然而我哪个都没用过。。。现在的项目都是用es6。</p>
<p>这里直接给个传送门，还有知乎上一段很精彩的讨论： <a href="https://www.zhihu.com/question/20342350" target="_blank" rel="external">LABjs、RequireJS、SeaJS 哪个最好用？为什么？</a></p>
<table> <tr> <td width="200" style=" vertical-align:top"> <strong>nodejs</strong> <ul> <li><a href="https://github.com/nodejs/node" target="_blank" rel="external">源码</a></li> <li><a href="http://nodejs.cn/api/modules.html" target="_blank" rel="external">文档</a></li> <li><a href="http://wiki.commonjs.org/wiki/Modules/1.1" target="_blank" rel="external"> CommonJS 规范</a></li> </ul> </td> <td width="200" style=" vertical-align:top"> <strong>requirejs</strong> <ul> <li><a href="https://github.com/requirejs/requirejs" target="_blank" rel="external">源码</a></li> <li><a href="http://requirejs.org/docs/whyamd.html" target="_blank" rel="external">文档</a></li> <li><a href="http://wiki.commonjs.org/wiki/Modules/AsynchronousDefinition" target="_blank" rel="external">AMD 规范</a></li> </ul></td> <td width="200" style=" vertical-align:top"> <strong>seajs</strong> <ul> <li><a href="https://github.com/seajs/seajs" target="_blank" rel="external">源码</a></li> <li><a href="https://seajs.github.io/seajs/docs/#docs" target="_blank" rel="external">文档</a></li> <li><a href="https://github.com/seajs/seajs/issues/242" target="_blank" rel="external">CMD 规范</a></li> </ul></td> </tr> </table>

<h2 id="理解原理"><a href="#理解原理" class="headerlink" title="理解原理"></a>理解原理</h2><h3 id="requirejs"><a href="#requirejs" class="headerlink" title="requirejs"></a>requirejs</h3><p>module.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">define(<span class="string">"id"</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</div><div class="line">	<span class="built_in">module</span>.exports = &#123;</div><div class="line">		<span class="attr">name</span>: <span class="string">"I am module"</span></div><div class="line">	&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">define([<span class="string">'module'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">module</span>)</span>&#123;</div><div class="line"> <span class="built_in">module</span>.exports = <span class="built_in">module</span>.name</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>1、 解析模块路径和依赖关系</p>
<p>2、 按依赖关系递归执行创建script标签，请求js，并绑定onload事件来获取该模块加载完成的通知。（有的加载器也会通过 AJAX 去请求脚本然后eval执行，前提是没有跨域。）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> node =  <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</div><div class="line">node.type =  <span class="string">'text/javascript'</span>;</div><div class="line">node.charset = <span class="string">'utf-8'</span>;</div><div class="line">node.async = <span class="literal">true</span>;</div><div class="line">node.id=<span class="string">"xxx"</span>;</div><div class="line">node.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;</div><div class="line">node.src = url;</div><div class="line"><span class="keyword">var</span> head = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>];</div><div class="line">head.appendChild(node);</div></pre></td></tr></table></figure>
<p>3、依赖的js加载完成后，执行依赖的模块中的回调函数，并将结果给当前回调函数作为参数</p>
<h3 id="seajs"><a href="#seajs" class="headerlink" title="seajs"></a>seajs</h3><p>module.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">define(<span class="string">'id'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">require,exports,modules</span>)</span>&#123;</div><div class="line">	<span class="built_in">module</span>.exports = &#123;</div><div class="line">		<span class="attr">name</span>: <span class="string">"I am module"</span></div><div class="line">	&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">define(<span class="string">'id'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">require,exports,modules</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> <span class="built_in">module</span> = <span class="built_in">require</span>(<span class="string">'module.js'</span>)</div><div class="line">	<span class="built_in">module</span>.exports = <span class="built_in">module</span>.name</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ol>
<li>通过回调函数的Function.toString函数，使用正则表达式解析找到require(‘module.js’),找到内部依赖的模块</li>
<li>根据配置文件，找到依赖的js文件的实际路径，在dom中插入script标签，载入模块指定的js，绑定加载完成的事件。<strong>(加载依赖模块逻辑跟requirejs是一样的)</strong>。载入后存储对应的factory函数</li>
<li>回调函数内部依赖的js全部加载（暂不调用）完后，调用回调函数</li>
<li>当回调函数调用require(‘module.js’)时，执行绑定在’module’这个id上的factory函数，并将返回值传给var module</li>
</ol>
<p>从seajs源码可以看出在调用require时才执行:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">seajs.require = <span class="function"><span class="keyword">function</span>(<span class="params">id</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> mod = Module.get(Module.resolve(id))</div><div class="line">  <span class="keyword">if</span> (mod.status &lt; STATUS.EXECUTING) &#123;</div><div class="line">    mod.onload()</div><div class="line">    mod.exec()</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mod.exports</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>requirejs与seajs都是提前加载好所有依赖模块，只是模块的factory函数执行时机不同，requirejs是在模块的回调执行前执行依赖模块的factory，拿到依赖模块的输出作为自己的回调的入参。seajs在加载依赖模块后只是存储了模块id与对应的factory函数的关系，在调用require时才执行factory函数并返回结果。对于这一点，我感觉两者没什么差异。</p>
<p>关于循环依赖的问题，例如：在引入b.js时，会去加载b模块的依赖，并执行依赖的factory函数，而它依赖的a模块又依赖了b，就会加载并执行b模块的factory函数。</p>
<p>所以会出现 a模块和b模块的factory同时执行的情况，这样只会执行到相互引用的部分。</p>
<p>b.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">define([<span class="string">"a"</span>],<span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</div><div class="line">    <span class="comment">//"a"将是null，如果a/b间是循环依赖</span></div><div class="line">    <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">"a"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    	 a.doSomething();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果出现循环依赖，最好是重构解决。或者换种写法：</p>
<p>b.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">define([<span class="string">"require"</span>, <span class="string">"a"</span>],<span class="function"><span class="keyword">function</span>(<span class="params">require, a</span>) </span>&#123;</div><div class="line">    <span class="comment">//"a"将是null，如果a/b间是循环依赖</span></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">require</span>(<span class="string">"a"</span>).doSomething();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://www.ruanyifeng.com/blog/2015/11/circular-dependency.html" target="_blank" rel="external">JavaScript 模块的循环加载</a></li>
<li><a href="http://caibaojian.com/js-module-define.html" target="_blank" rel="external">JS模块化编程之加载器原理</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 前端构建 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[给Hexo+Github page博客绑定域名的一些问题]]></title>
      <url>/%E7%BB%99hexo+githubpage%E5%8D%9A%E5%AE%A2%E7%BB%91%E5%AE%9A%E5%9F%9F%E5%90%8D%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>项目终于做完了，忽然想到买了很久的域名一直没有用，本来以为还要备案啥的，就一直没倒腾。<br>今天研究了下域名绑定，居然很快就弄好了。但是也遇到了几个问题，还是记录一下吧~</p>
<ul>
<li>升级Node.js后，执行hexo generate报错</li>
<li>Hexo博客绑定域名 CNAME文件问题</li>
<li>个人主页添加域名后项目主页访问不了了</li>
</ul>
<a id="more"></a>
<h3 id="升级Node-js后，执行hexo-generate报错"><a href="#升级Node-js后，执行hexo-generate报错" class="headerlink" title="升级Node.js后，执行hexo generate报错"></a>升级Node.js后，执行hexo generate报错</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Error: The module &apos;/usr/local/lib/node_modules/hexo-cli/node_modules/dtrace-provider/build/Release/DTraceProviderBindings.node&apos;</div><div class="line">was compiled against a different Node.js version using</div><div class="line">NODE_MODULE_VERSION 48. This version of Node.js requires</div><div class="line">NODE_MODULE_VERSION 51. Please try re-compiling or re-installing</div><div class="line">the module (for instance, using npm rebuild ornpm install).</div></pre></td></tr></table></figure>
<p>重新安装 hexo-cli</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g hexo-cli</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cnpm install -g hexo-cli</div></pre></td></tr></table></figure>
<p>如果提示没有权限，再加上sudo。<br>然后删除node_modules 再重新 npm install 国内hexo好像都得cnpm</p>
<h3 id="Hexo博客绑定域名"><a href="#Hexo博客绑定域名" class="headerlink" title="Hexo博客绑定域名"></a>Hexo博客绑定域名</h3><p>使用的github page，绑定域名过程如下：</p>
<p><strong>1、在阿里云购买域名</strong></p>
<p><a href="https://wanwang.aliyun.com/domain/" target="_blank" rel="external">戳链接</a>   恩，chang20159.com 这个域名我买下了</p>
<p><strong>2、准备好github项目的机器IP</strong></p>
<p>终端执行    <code>ping chang20159.github.io</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;ping chang20159.github.io</div><div class="line">PING github.map.fastly.net (151.101.72.133): 56 data bytes</div><div class="line">64 bytes from 151.101.72.133: icmp_seq=0 ttl=50 time=90.449 ms</div><div class="line">64 bytes from 151.101.72.133: icmp_seq=1 ttl=50 time=91.037 ms</div></pre></td></tr></table></figure>
<p>  拿到github项目的机器IP   151.101.72.133</p>
<p><strong>3、绑定域名</strong></p>
<p>  要把域名chang20159.com 与 github page项目 chang20159.github.io绑定</p>
<p>  域名买好了之后，在控制台找到域名的入口，就可以看到这个，添加了主机记录@和www<br>  这样我们就可以访问 chang20159.com 和 www.chang20159.com 了<br>  <img src="/images/domain/domain1.png" alt=""><br>  点击域名&gt;域名解析&gt;新手引导设置<br> <img src="/images/domain/domain2.png" alt=""><br>  按步骤绑定，绑定好了就能看到下面这个<br> <img src="/images/domain/domain3.png" alt=""></p>
<p>  现在还不能访问chang20159.com，还有一步<br><strong>4、 添加CNAME文件</strong><br>在chang20159.github.io项目中添加CNAME文件，文件没有后缀名，文件内容是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chang20159.com</div></pre></td></tr></table></figure>
<p>CNAME文件要添加到hexo项目的source目录下，在github项目的setting里面有个Custom domain选项，如果在那里添加cname也可以，但是hexo项目不行，因为如果source目录下没有cname文件的话每次deploy后那个设置又没有了。</p>
<h3 id="个人主页添加域名后项目主页访问不了了"><a href="#个人主页添加域名后项目主页访问不了了" class="headerlink" title="个人主页添加域名后项目主页访问不了了"></a>个人主页添加域名后项目主页访问不了了</h3><p>github上还有个项目sharing，本来没有cname，通过chang20159.github.io/sharing可以直接访问这个项目的，但是个人主页项目cname后项目主页就404了。</p>
<p>因为 访问 chang20159.github.io/sharing 会跳转到 chang20159.com/sharing ,但是chang20159.github.io项目是没有sharing文件的，所以就404了。</p>
<p>问题有了，办法也是有的。</p>
<p><strong>1、 在sharing这个项目中也添加CNAME文件</strong><br>文件内容是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sharing.chang20159.com</div></pre></td></tr></table></figure>
<p><strong>2、 在阿里云域名管理页面chang20159.com下添加一个记录</strong><br>就是下面这样：<br>这样就可以通过sharing.chang20159.com 访问 sharing项目的内容了。<br> <img src="/images/domain/domain4.png" alt=""></p>
<p>这样 访问sharing.chang20159.com 就能与机器151.101.72.133连接，然后通过cname找到sharing项目了</p>
]]></content>
      
        <categories>
            
            <category> 静态博客 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> GitHub </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[理解BFC]]></title>
      <url>/%E7%90%86%E8%A7%A3BFC/</url>
      <content type="html"><![CDATA[<p>网上有太多关于BFC的文章，看了很多，还是不能理解。想想还是看全英文的官方文档，关于BFC的规则，在w3c文档中的<a href="https://www.w3.org/TR/CSS21/visuren.html" target="_blank" rel="external">第9章</a>和<a href="https://www.w3.org/TR/CSS21/visudet.html" target="_blank" rel="external">第10章</a>全局搜一下Block formatting context，就能找到。<br><a id="more"></a></p>
<h2 id="什么是BFC"><a href="#什么是BFC" class="headerlink" title="什么是BFC"></a>什么是BFC</h2><p>CSS中每个元素都会根据盒模型生成0个或多个Box，Box是布局的对象和基本单位，Visual formatting model描述了一套规则，决定元素如何对其内容进行布局，以及与其他元素的关系和作用。盒布局由以下几个方面组成：</p>
<ul>
<li>盒的尺寸和类型（明确指定、受限或没有指定   行内级盒、块级盒）</li>
<li>盒布局方案（常规流、浮动、绝对定位）</li>
<li>文档树中元素之间的关系</li>
<li>其他 如视口、图片大小等</li>
</ul>
<p>对于浮动布局，由float属性决定<br>对于绝对定位布局，由position属性决定<br>而对于常规流的布局，则与display属性有很大关系</p>
<p>根据display属性的计算值，可以将box分为块级盒和行内级盒</p>
<ul>
<li>块级盒<br>  display的计算值 为 block, list-item 或 table </li>
<li>行内级盒<br>  display的计算值为 inline, inline-block 或 inline-table </li>
</ul>
<p>在常规流中，不同的Box会参与不同formatting context（在这个格式化上下文中有一套渲染规则），block-level box（块级盒）参与block formatting context（BFC）中的规则，inline-level box（行内级盒）参与 inline formatting context(IFC)中的规则。</p>
<p>我们常常会让一个元素生成block formatting context（BFC），在这个block formatting context中的块级盒都遵循一套布局规则，下面会讲怎样让一个元素生成BFC以及块级盒在BFC中会遵循哪些规则</p>
<h2 id="哪些元素会触发BFC"><a href="#哪些元素会触发BFC" class="headerlink" title="哪些元素会触发BFC"></a>哪些元素会触发BFC</h2><p>官方文档是这样说的</p>
<blockquote>
<p>Floats, absolutely positioned elements, block containers (such as inline-blocks, table-cells, and table-captions) that are not block boxes, and block boxes with ‘overflow’ other than ‘visible’ (except when that value has been propagated to the viewport) establish new block formatting contexts for their contents.</p>
</blockquote>
<p>解释一下就是，以下这些元素可以生成BFC,其内部块级盒按照BFC的规则布局</p>
<ul>
<li>浮动元素 float非none</li>
<li>绝对定位元素 position为absolute和fixed</li>
<li>diplay属性为：inline-block | table-cell | table-caption等非块盒</li>
<li>overflow属性是非visible值</li>
</ul>
<p>一般情况下，都是使用overflow:hidden来触发BFC，对元素内部布局影响比较小，也不会影响其他元素</p>
<h2 id="BFC规则"><a href="#BFC规则" class="headerlink" title="BFC规则"></a>BFC规则</h2><p>官方文档是这样说的：</p>
<blockquote>
<p>In a block formatting context, boxes are laid out one after the other, vertically, beginning at the top of a containing block. </p>
</blockquote>
<hr>
<blockquote>
<p>The vertical distance between two sibling boxes is determined by the ‘margin’ properties. Vertical margins between adjacent block-level boxes in a block formatting context collapse.</p>
</blockquote>
<hr>
<blockquote>
<p>In a block formatting context, each box’s left outer edge touches the left edge of the containing block (for right-to-left formatting, right edges touch). This is true even in the presence of floats (although a box’s line boxes may shrink due to the floats), unless the box establishes a new block formatting context (in which case the box itself may become narrower due to the floats).</p>
</blockquote>
<hr>
<blockquote>
<p>The border box of a table, a block-level replaced element, or an element in the normal flow that establishes a new block formatting context (such as an element with ‘overflow’ other than ‘visible’) must not overlap the margin box of any floats in the same block formatting context as the element itself.</p>
</blockquote>
<hr>
<blockquote>
<p>But in CSS 2.1, if, within the block formatting context, there is an in-flow negative vertical margin such that the float’s position is above the position it would be at were all such negative margins set to zero, the position of the float is undefined.</p>
</blockquote>
<hr>
<blockquote>
<p>10.6.7 ‘Auto’ heights for block formatting context roots<br>In certain cases (see, e.g., sections 10.6.4 and 10.6.6 above), the height of an element that establishes a block formatting context is computed as follows:</p>
<p>If it only has inline-level children, the height is the distance between the top of the topmost line box and the bottom of the bottommost line box.</p>
<p>If it has block-level children, the height is the distance between the top margin-edge of the topmost block-level child box and the bottom margin-edge of the bottommost block-level child box.</p>
<p>Absolutely positioned children are ignored, and relatively positioned boxes are considered without their offset. Note that the child box may be an anonymous block box.</p>
<p>In addition, if the element has any floating descendants whose bottom margin edge is below the element’s bottom content edge, then the height is increased to include those edges. Only floats that participate in this block formatting context are taken into account, e.g., floats inside absolutely positioned descendants or other floats are not.</p>
</blockquote>
<p>按照顺序来解释一下BFC规则就是这些<br>1、从包含块顶部开始，内部的box一个接一个垂直排列<br>2、两相邻box在垂直方向的距离由margin决定，<strong>属于同一个BFC的相邻box的margin会发生重叠collapse</strong><br>3、在同一个BFC中，每个box的左外边缘（margin边界）与包含块的左边缘(border内边界)接触（对于从右至左排列的布局则相反）;这对于浮动元素也一样<br>4、<strong>常规流中一个建立块格式化上下文的元素（触发BFC的元素）不会和任何浮动元素的外边界框重叠</strong><br>5、没明白啥意思 囧<br>6、关于BFC中元素高度的计算<br> 在某些情况下，建立块格式化上下文的元素的高度是这样计算的：</p>
<ul>
<li>如果它只有行内级child box，它的高度就是最上面的线框的顶部和最下面的线框的底部之间的距离；</li>
<li>如果它有块级child box，它的高度就是最上面块child box的上外边界（margin-top）与最下面块child box的下外边界（margin-bottom）之间的距离；</li>
<li>绝对定位的child box会被忽略，相对定位的child box不将偏移计算在内。注意child box可能是匿名块盒；</li>
<li>另外，<strong>如果这个元素有任何浮动后代的底部外边界超出了在这个元素底部内容边界，这些超出的边界也计算在元素的高度之内</strong><br>注意：只有参与这个元素产生的BFC的浮动元素才会参与此元素的高度计算，在绝对定位的child box中的浮动元素不参与计算</li>
</ul>
<h2 id="BFC的应用"><a href="#BFC的应用" class="headerlink" title="BFC的应用"></a>BFC的应用</h2><p>这是一个测试的文档结构和样式<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"other"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">    <span class="attribute">border</span>:<span class="number">5px</span> solid <span class="number">#000</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.div1</span>&#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">    <span class="attribute">background-color</span>: <span class="number">#43235e</span>;</div><div class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.div2</span>&#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">    <span class="attribute">background-color</span>: <span class="number">#ee5511</span>;</div><div class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.other</span>&#123;</div><div class="line">    <span class="attribute">background-color</span>: <span class="number">#666</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="解决垂直margin重叠问题"><a href="#解决垂直margin重叠问题" class="headerlink" title="解决垂直margin重叠问题"></a>解决垂直margin重叠问题</h3><p>div1和div2的上下外边距重叠,间距两者最大值：30px</p>
<div style="border:5px solid #000;color:#fff;"><div style="width: 200px;
            height: 100px;
            background-color: #43235e;
            margin-bottom: 20px;">div1  margin-bottom: 10px</div><div style="width: 300px;
            height: 100px;
            background-color: #ee5511;
            margin-top: 30px;">div2   margin-top: 20px</div></div> <div style="background-color: #666;
            height: 100px;"></div>



<p>第二条说：属于同一个BFC的相邻box的margin会发生重叠，那只要相邻的box不属于同一个BFC，垂直margin就不会重叠啦</p>
<div style="border:5px solid #000;color:#fff;"><div style="overflow:hidden"><div style="width: 200px;
            height: 100px;
            background-color: #43235e;
            margin-bottom: 20px;">div1  margin-bottom: 10px</div></div><div style="width: 300px;
            height: 100px;
            background-color: #ee5511;
            margin-top: 30px;">div2   margin-top: 20px</div><br>    </div> <div style="background-color: #666;
            height: 100px;"></div>

<h3 id="自适应多栏布局"><a href="#自适应多栏布局" class="headerlink" title="自适应多栏布局"></a>自适应多栏布局</h3><p>下面div1左浮动，脱离了常规流，margin外边界与包含块左侧边框内边界接触，div2向上移动，与div1重叠。</p>
<div style="border:5px solid #000;color:#fff;"><div style="width: 200px;
            height: 50px;
            background-color: #43235e;
            margin-bottom: 20px;float:left">div1 左浮动 </div><div style="width: 600px;
            height: 100px;
            background-color: #ee5511;">div2  </div><br>    </div> <div style="background-color: #666;
            height: 100px;"></div>

<p>根据第四条：<strong>常规流中一个建立块格式化上下文的元素（触发BFC的元素）不会和任何浮动元素的外边界框重叠</strong><br>所以只要让div2形成BFC，就不会重叠了,这里还是用overflow的非visible属性生成BFC<br>  <div style="border:5px solid #000;color:#fff;"><div style="width: 200px;
            height: 50px;
            background-color: #43235e;
            margin-bottom: 20px;float:left">div1 左浮动 </div><div style="width: 600px;
            height: 100px;
            background-color: #ee5511;
            overflow:hidden;">div2触发BFC  </div><br>    </div> <div style="background-color: #666;
            height: 100px;"></div>          </p>
<h3 id="解决浮动元素父元素高度塌陷问题"><a href="#解决浮动元素父元素高度塌陷问题" class="headerlink" title="解决浮动元素父元素高度塌陷问题"></a>解决浮动元素父元素高度塌陷问题</h3><p>这里只有div1是浮动的，因为浮动元素脱离文档流，不参与父元素高度的计算</p>
<div style="border:5px solid #000;color:#fff;"><div style="width: 200px;
            height: 100px;
            background-color: #43235e;
            margin-bottom: 20px;float:left">div1 左浮动</div><div style="width: 500px;
            height: 50px;
            background-color: #ee5511;
            margin-top: 30px;
        ">div2   margin-top: 20px</div></div> <div style="background-color: #666;
            height: 100px;"></div>


<p>根据第六条，<br>如果一个生成BFC的元素有任何浮动后代的底部外边界超出了在这个元素底部内容边界，这些超出的边界也计算在元素的高度之内<br>所以，如果让container触发BFC，浮动元素div1超出container的那部分也会计入container的高度,<strong>包括浮动元素div1的外边距</strong></p>
<p><div style="border:5px solid #000;overflow:hidden;color:#fff;"><div style="width: 200px;
            height: 100px;
            background-color: #43235e;
            margin-bottom: 20px;float:left">div1左浮动</div><div style="width: 500px;
            height: 50px;
            background-color: #ee5511;
            margin-top: 30px;
        ">div2   margin-top: 20px</div></div> <div style="background-color: #666;
            height: 100px;"></div></p>
<h2 id="BFC兼容性"><a href="#BFC兼容性" class="headerlink" title="BFC兼容性"></a>BFC兼容性</h2><p>在IE6和IE7中不是所有元素都拥有布局，元素是否拥有布局由hasLayout属性决定，hasLayout与BFC相似，有触发hasLayoutyongyong（hasLayout == true）的条件，也有拥有布局后的一套规则。<br>触发hasLayout的条件有：</p>
<ul>
<li>float: 非none</li>
<li>display: inline-block</li>
<li>position: absolute</li>
<li>width: 非auto</li>
<li>height: 非auto</li>
<li>zoom: 非normal值</li>
<li>writing-mode: tb-rl</li>
</ul>
<p>hasLayout == true时的规则：</p>
<ul>
<li>相对定位的元素没有布局</li>
<li>拥有布局的元素外边距不叠加</li>
<li>等等。。</li>
</ul>
<p>在IE6和IE7中可以通过为元素添加zoom：1属性触发haslayout，修复因浮动引起的高度塌陷问题</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://www.w3.org/TR/CSS21/box.html#box-dimensions" target="_blank" rel="external">Box model</a></li>
<li><a href="Visual formatting model">Visual formatting model</a></li>
<li><a href="https://www.w3.org/TR/CSS21/visudet.html" target="_blank" rel="external">Visual formatting model details</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/display" target="_blank" rel="external">display</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> CSS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[移动端H5开发小经验]]></title>
      <url>/%E7%A7%BB%E5%8A%A8%E7%AB%AFH5%E5%BC%80%E5%8F%91%E5%B0%8F%E7%BB%8F%E9%AA%8C/</url>
      <content type="html"><![CDATA[<p>Android手机软键盘挡住输入框？Android设置border-radius,背景颜色溢出？页面上数字变成可以点击的电话号码？<br><a id="more"></a></p>
<h3 id="android手机软键盘挡住输入框"><a href="#android手机软键盘挡住输入框" class="headerlink" title="android手机软键盘挡住输入框"></a>android手机软键盘挡住输入框</h3><p>在点击输入框时，软键盘升起会挡住输入框，IOS手机则会把输入框顶起来不会遮住。<br>解决办法是:给输入框添加一个点击事件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">clickHandler(e)&#123;</div><div class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">        e.target.scrollIntoViewIfNeeded();</div><div class="line">    &#125;,<span class="number">400</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="android设置border-radius-背景颜色溢出"><a href="#android设置border-radius-背景颜色溢出" class="headerlink" title="android设置border-radius,背景颜色溢出"></a>android设置border-radius,背景颜色溢出</h3><p>background-clip  设置元素的背景（背景图片或颜色）是否延伸到边框下面</p>
<ul>
<li>border-box<br>  背景延伸到边框外沿（但是在边框之下）。</li>
<li>padding-box<br>  边框下面没有背景，即背景延伸到内边距外沿。</li>
<li>content-box<br>  背景裁剪到内容区 (content-box) 外沿。<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attribute">background-clip</span>: padding-box;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="页面上数字变成可以点击的电话号码"><a href="#页面上数字变成可以点击的电话号码" class="headerlink" title="页面上数字变成可以点击的电话号码"></a>页面上数字变成可以点击的电话号码</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"format-detection"</span> <span class="attr">content</span>=<span class="string">"telephone=no"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="点击输入框调出数字键盘"><a href="#点击输入框调出数字键盘" class="headerlink" title="点击输入框调出数字键盘"></a>点击输入框调出数字键盘</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'number'</span> <span class="attr">pattern</span>=<span class="string">"[0-9]*"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'tel'</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="ios-click事件300ms延时"><a href="#ios-click事件300ms延时" class="headerlink" title="ios click事件300ms延时"></a>ios click事件300ms延时</h3><p>最近有个项目，其中有个场景是这样的，一个批量选择图片的页面还带分页，在选择图片时checkbox从未选择状态变为已选择状态，在安卓上反映很快，在ios上表现很迟钝。原来这是因为click事件300ms延时导致的。</p>
<p>并不是只有ios才有click事件300ms延时，设计click事件300ms延时的原因是为了支持双击缩放，判断是否在300ms内有第二次点击。支持双机缩放这种功能的一都般会有单击延时的问题。<br>chrome 和 firefox 的移动版本禁用缩放就可以解决300ms延时的问题</p>
<p><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no, minimal-ui"><br>但是这在移动端safari上并不起作用。</p>
<p>可以通过监听 touchend事件处理， touchend事件没有延迟。<br>另外还可以使用fastclick，可以看下 <a href="https://github.com/ftlabs/fastclick" target="_blank" rel="external">fastclick github </a></p>
<h3 id="ios-autofocus不起作用"><a href="#ios-autofocus不起作用" class="headerlink" title="ios autofocus不起作用"></a>ios autofocus不起作用</h3><p>移动端safari上不支持autofocus，可以查看<a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLSelectElement/autofocus#Browser_compatibility" target="_blank" rel="external">MDN autofocus Browser_compatibility</a><br>只能通过用户主动出发事件时手动聚焦。<br>例如：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">id</span>=<span class="string">'focus'</span>/&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'touchend'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'focus'</span>).focus();</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[常用 Web API 接口]]></title>
      <url>/%E5%B8%B8%E7%94%A8WebAPI%E6%8E%A5%E5%8F%A3/</url>
      <content type="html"><![CDATA[<p>有时候是不是很容易头大，很多常见的api分不清，看下面这些，能弄明白它们的区别么？</p>
<ul>
<li>document.location 与 window.location</li>
<li>document.URL 与 document.documentURI</li>
<li>nodeValue、innerText 、textContent、innerHTML、outerHTML、outerText</li>
<li>clientHeight、scrollHeight、offsetHeight（Left/Top/Width）</li>
</ul>
<a id="more"></a>
<p>要想知道它们有什么不同，还是得先捋捋它们都是谁的属性和方法，看看常用web api的继承关系，想想它们都有哪些属性和方法</p>
<p><img src="/images/note_web_api.png" alt=""></p>
<h2 id="EventTarget"><a href="#EventTarget" class="headerlink" title="EventTarget"></a>EventTarget</h2><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><ul>
<li>EventTarget.addEventListener()</li>
<li>EventTarget.removeEventListener()</li>
<li>EventTarget.dispatchEvent()</li>
</ul>
<h2 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h2><p>Node是一个接口，许多DOM类型从这个接口继承,如Document，Element</p>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><ul>
<li>Node.baseURI</li>
<li>Node.childNodes      所有子节点</li>
<li>Node.firstChild      第一个子节点</li>
<li>Node.lastChild       最后一个子节点</li>
<li>Node.previousSibling 前一个兄弟节点</li>
<li>Node.nextSibling     下一个兄弟节点</li>
<li>Node.parentNode      父节点(可能是元素节点也可能是文档节点)</li>
<li>Node.parentElement   当前节点的父元素节点</li>
<li>Node.nodeValue   返回或设置当前节点的值</li>
<li>Node.nodeType    节点的类型</li>
<li>Node.nodeName    节点名称</li>
<li>Node.innerText    一个节点及其后代的“渲染”文本内容的属性   </li>
<li>Node.textContent  一个节点及其后代的文本内容</li>
<li>Node.replaceChild(newChild, oldChild)</li>
</ul>
<h3 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h3><ul>
<li>parentNode.appendChild(child)  将一个节点添加到指定父节点的子节点列表末尾</li>
<li>parentNode.removeChild(child) </li>
<li>Node.cloneNode  返回调用该方法的节点的一个副本</li>
<li>parentElement.contains( otherNode )   传入的节点是否为该节点的后代节点</li>
<li>parentElement.hasChildNodes() 当前节点是否包含有子节点</li>
<li>parentElement.insertBefore(newElement, referenceElement)</li>
</ul>
<h3 id="节点类型常量"><a href="#节点类型常量" class="headerlink" title="节点类型常量"></a>节点类型常量</h3><table>
<thead>
<tr>
<th style="text-align:left">常量</th>
<th style="text-align:left">值</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Node.ELEMENT_NODE</td>
<td style="text-align:left">1</td>
<td style="text-align:left">一个 元素 节点，例如 &lt;p&gt; 和 &lt;div&gt;</td>
</tr>
<tr>
<td style="text-align:left">Node.TEXT_NODE</td>
<td style="text-align:left">3</td>
<td style="text-align:left">Element 或者 Attr 中实际的  文字</td>
</tr>
<tr>
<td style="text-align:left">Node.PROCESSING_INSTRUCTION_NODE</td>
<td style="text-align:left">7</td>
<td style="text-align:left">一个用于XML文档的 ProcessingInstruction ，例如 &lt;?xml-stylesheet … ?&gt; 声明</td>
</tr>
<tr>
<td style="text-align:left">Node.COMMENT_NODE</td>
<td style="text-align:left">8</td>
<td style="text-align:left">一个 Comment 节点</td>
</tr>
<tr>
<td style="text-align:left">Node.DOCUMENT_NODE</td>
<td style="text-align:left">9</td>
<td style="text-align:left">一个 Document 节点。</td>
</tr>
<tr>
<td style="text-align:left">Node.DOCUMENT_TYPE_NODE</td>
<td style="text-align:left">10</td>
<td style="text-align:left">描述文档类型的 DocumentType 节点。例如 &lt;!DOCTYPE html&gt;  就是用于 HTML5 的。</td>
</tr>
<tr>
<td style="text-align:left">Node.DOCUMENT_FRAGMENT_NODE</td>
<td style="text-align:left">11</td>
<td style="text-align:left">一个 DocumentFragment 节点</td>
</tr>
</tbody>
</table>
<h2 id="ParentNode"><a href="#ParentNode" class="headerlink" title="ParentNode"></a>ParentNode</h2><h3 id="属性-1"><a href="#属性-1" class="headerlink" title="属性"></a>属性</h3><ul>
<li>childElementCount</li>
<li>children</li>
<li>firstElementChild</li>
<li>lastElementChild</li>
</ul>
<h3 id="方法-2"><a href="#方法-2" class="headerlink" title="方法"></a>方法</h3><ul>
<li>append()</li>
<li>prepend()</li>
<li>querySelectorAll()</li>
</ul>
<h2 id="ChildNode"><a href="#ChildNode" class="headerlink" title="ChildNode"></a>ChildNode</h2><h3 id="方法-3"><a href="#方法-3" class="headerlink" title="方法"></a>方法</h3><ul>
<li>after()</li>
<li>before()</li>
<li>remove()</li>
</ul>
<h2 id="Document"><a href="#Document" class="headerlink" title="Document"></a>Document</h2><h3 id="属性-2"><a href="#属性-2" class="headerlink" title="属性"></a>属性</h3><ul>
<li>document.body  </li>
<li>document.characterSet</li>
<li>document.doctype</li>
<li>document.domain</li>
<li>document.head</li>
<li>document.body</li>
<li>document.location</li>
<li>document.documentURI</li>
<li>document.URL</li>
</ul>
<h3 id="方法-4"><a href="#方法-4" class="headerlink" title="方法"></a>方法</h3><ul>
<li>document.createElement()</li>
<li>document.createTextNode</li>
<li>document.getElementById()</li>
<li>document.getElementsByClassName()</li>
<li>document.getElementsByName()</li>
<li>document.getElementsByTagName()</li>
<li>document.querySelector()</li>
<li>document.querySelectorAll()</li>
<li>document.write()</li>
<li>document.writeln()</li>
</ul>
<h2 id="Element"><a href="#Element" class="headerlink" title="Element"></a>Element</h2><h3 id="属性-3"><a href="#属性-3" class="headerlink" title="属性"></a>属性</h3><ul>
<li>Element.attributes</li>
<li>Element.classList<ul>
<li>Element.classList.add()</li>
<li>Element.classList.remove()</li>
<li>Element.classList.item()</li>
<li>Element.classList.toggle()</li>
<li>Element.classList.contains()</li>
</ul>
</li>
<li>Element.className</li>
<li>Element.tagName</li>
<li>Element.id</li>
<li><p>Element.name</p>
</li>
<li><p>Element.innerHTML</p>
</li>
<li><p>Element.outerHTML</p>
</li>
<li><p>Element.clientHeight</p>
</li>
<li>Element.clientLeft</li>
<li>Element.clientTop</li>
<li><p>Element.clientWidth</p>
</li>
<li><p>Element.scrollHeight</p>
</li>
<li>Element.scrollLeft</li>
<li>Element.scrollTop</li>
<li>Element.scrollWidth</li>
</ul>
<h3 id="方法-5"><a href="#方法-5" class="headerlink" title="方法"></a>方法</h3><ul>
<li>Element.getElementsByClassName()</li>
<li>Element.getElementsByTagName()</li>
<li>Element.querySelector()</li>
<li>Element.querySelectorAll()</li>
<li>Element.getAttribute()</li>
<li>Element.removeAttribute()</li>
</ul>
<h2 id="HTMLElement"><a href="#HTMLElement" class="headerlink" title="HTMLElement"></a>HTMLElement</h2><h3 id="属性-4"><a href="#属性-4" class="headerlink" title="属性"></a>属性</h3><ul>
<li>HTMLElement.offsetHeight</li>
<li>HTMLElement.offsetLeft</li>
<li>HTMLElement.offsetTop</li>
<li>HTMLElement.offsetWidth</li>
<li>HTMLElement.offsetParent 返回一个指向最近的包含该元素的定位元素</li>
<li><p>HTMLElement.style</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">elt.style.cssText = &quot;color: blue&quot;; // 设置多个样式属性 </div><div class="line">elt.setAttribute(&quot;style&quot;, &quot;color: blue&quot;); // 设置多个样式属性 </div><div class="line">elt.style.color = &quot;blue&quot;; // 直接设置样式属性</div></pre></td></tr></table></figure>
</li>
<li><p>HTMLElement.dataset  获取自定义的数据属性</p>
</li>
<li>HTMLElement.contentEditable  表明元素是否是可编辑的</li>
<li>HTMLElement.dir  获取或设置当前元素的元素内容的文本书写方向</li>
</ul>
<h3 id="方法-6"><a href="#方法-6" class="headerlink" title="方法"></a>方法</h3><ul>
<li>HTMLElement.click() 可以用来模拟鼠标左键单击一个元素</li>
<li>HTMLElement.blur()  用来移除当前元素所获得的键盘焦点</li>
<li>HTMLElement.focus() 可以设置指定元素获取焦点</li>
</ul>
<h2 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h2><h3 id="属性-5"><a href="#属性-5" class="headerlink" title="属性"></a>属性</h3><ul>
<li>window.console</li>
<li>window.document</li>
<li>window.history 用来获取History 对象的引用</li>
<li>window.innerHeight 浏览器窗口的视口（viewport）高度（以像素为单位），包括水平滚动条</li>
<li>window.innerWidth 浏览器视口（viewport）宽度（单位：像素）包括垂直滚动条</li>
<li>window.location</li>
<li>window.navigator 查询一些关于运行当前脚本的应用程序的相关信息</li>
<li>window.top  返回窗口体系中的最顶层窗口的引用</li>
<li>window.parent 返回当前窗口的父对象</li>
</ul>
<h3 id="方法-7"><a href="#方法-7" class="headerlink" title="方法"></a>方法</h3><ul>
<li>window.setInterval  重复调用一个函数或执行一个代码段，以固定的时间延迟在每次调用之间。返回一个 intervalID</li>
<li>window.setTimeout 在定时到期后执行一段代码</li>
<li>window.resizeTo(aWidth, aHeight)   动态调整窗口的大小</li>
</ul>
<h2 id="区分相似接口属性"><a href="#区分相似接口属性" class="headerlink" title="区分相似接口属性"></a>区分相似接口属性</h2><h3 id="document-location-与-window-location"><a href="#document-location-与-window-location" class="headerlink" title="document.location 与 window.location"></a>document.location 与 window.location</h3><p>没发现有啥区别</p>
<h3 id="Node-nodeValue、Node-innerText-、Node-textContent-、Element-innerHTML、Element-outerHTML"><a href="#Node-nodeValue、Node-innerText-、Node-textContent-、Element-innerHTML、Element-outerHTML" class="headerlink" title="Node.nodeValue、Node.innerText 、Node.textContent 、Element.innerHTML、Element.outerHTML"></a>Node.nodeValue、Node.innerText 、Node.textContent 、Element.innerHTML、Element.outerHTML</h3><p>1、Node.nodeValue<br>返回或设置当前节点的值,不同类型的节点nodeValue值不同.nodeValue为null,对它赋值也没效果.<br>|节点类型  | nodeValue的值<br>|:—|:—<br>|Node.COMMENT_NODE |注释的文本内容<br>|Node.DOCUMENT_FRAGMENT_NODE   | null<br>|Node.DOCUMENT_TYPE_NODE        | null<br>|Node.ELEMENT_NODE | null<br>|Node.TEXT_NODE |  文本节点的内容</p>
<p>2、Node.innerText<br>表示一个节点及其后代的“渲染”文本内容。<br>3、Node.textContent<br>表示一个节点及其后代的文本内容</p>
<p>4、Element.innerHTML<br>返回元素后代 HTML 文本</p>
<p>5、Element.outerHTML<br>返回包含描述元素及其后代的序列化HTML片段</p>
<p>innerText意识到样式，并且不会返回隐藏元素的文本，而textContent会。<br>innerText 受 CSS 样式的影响，它会触发重排（reflow），但textContent 不会<br>textContent会获取所有元素的内容，包括 script 和 style 元素，而 innerText 不会<br>innerHTML文本会被解析为HTML,但textContent不会，使用textContent可以防止XSS 攻击<br>outerHTML不仅返回元素后代 HTML 文本，还包括元素本身<br>例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p1"</span>&gt;</span>111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p2"</span>&gt;</span>222<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p3"</span>&gt;</span>333<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt;$(&apos;#container&apos;).innerText</div><div class="line">&quot;111</div><div class="line"></div><div class="line">222&quot;</div><div class="line">&gt;$(&apos;#container&apos;).textContent</div><div class="line">&quot;</div><div class="line">        111</div><div class="line">        222</div><div class="line">    &quot;</div><div class="line">&gt;$(&apos;#container&apos;).innerHTML</div><div class="line">&quot;</div><div class="line">        &lt;p class=&quot;p1&quot;&gt;111&lt;/p&gt;</div><div class="line">        &lt;p class=&quot;p2&quot;&gt;222&lt;/p&gt;</div><div class="line">    &quot;</div><div class="line">&gt;$(&apos;#container&apos;).outerHTML</div><div class="line">&quot;&lt;div id=&quot;container&quot;&gt;</div><div class="line">        &lt;p class=&quot;p1&quot;&gt;111&lt;/p&gt;</div><div class="line">        &lt;p class=&quot;p2&quot;&gt;222&lt;/p&gt;</div><div class="line">    &lt;/div&gt;&quot;</div><div class="line">&gt;$(&apos;#container&apos;).nodeValue</div><div class="line">null</div></pre></td></tr></table></figure>
<h3 id="Element-clientHeight、Element-scrollHeight、HTMLElement-offsetHeight（Left-Top-Width）"><a href="#Element-clientHeight、Element-scrollHeight、HTMLElement-offsetHeight（Left-Top-Width）" class="headerlink" title="Element.clientHeight、Element.scrollHeight、HTMLElement.offsetHeight（Left/Top/Width）"></a>Element.clientHeight、Element.scrollHeight、HTMLElement.offsetHeight（Left/Top/Width）</h3><p>1、Element.clientHeight<br>只读属性，返回<strong>元素内部</strong>的高度(单位像素)，包含内边距，但不包括水平滚动条、边框和外边距。<br>2、Element.scrollHeight<br>只读属性，计量<strong>元素内容高度</strong>，包括overflow样式属性导致的视图中不可见内容。<br>没有垂直滚动条的情况下，scrollHeight值与clientHeight值相同<br>3、HTMLElement.offsetHeight<br>只读属性,返回该元素的像素高度，高度包含该元素的垂直内边距和边框，且是一个整数。<br>通常，元素的offsetHeight是一种衡量标准，包括元素的边框、垂直内边距和元素的水平滚动条（如果存在且渲染的话）和元素的CSS高度。</p>
<p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> &lt;div id=&quot;container&quot;&gt;</div><div class="line">    &lt;div class=&quot;content&quot;&gt;111&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">#container&#123;</div><div class="line">    width: 200px;</div><div class="line">    height: 200px;</div><div class="line">    border: 5px solid #ff6633;</div><div class="line">    overflow: scroll;</div><div class="line">    padding: 3px;</div><div class="line">&#125;</div><div class="line">.content&#123;</div><div class="line">    height: 300px;</div><div class="line">    width: 100px;</div><div class="line">    border: 10px solid #000;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt;$(&apos;#container&apos;).clientHeight</div><div class="line">206  </div><div class="line">&gt;$(&apos;#container&apos;).scrollHeight</div><div class="line">326  </div><div class="line">&gt;$(&apos;#container&apos;).offsetHeight</div><div class="line">216</div><div class="line"></div><div class="line">&gt;$(&apos;.content&apos;).clientHeight</div><div class="line">300</div><div class="line">&gt;$(&apos;.content&apos;).scrollHeight</div><div class="line">300</div><div class="line">&gt;$(&apos;.content&apos;).offsetHeight</div><div class="line">320</div></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget" target="_blank" rel="external">EventTarget</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window" target="_blank" rel="external">Window</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Node" target="_blank" rel="external">Node</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ParentNode" target="_blank" rel="external">ParentNode</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ChildNode" target="_blank" rel="external">ChildNode</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element" target="_blank" rel="external">Element</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document" target="_blank" rel="external">Document</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement" target="_blank" rel="external">HTMLElement</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers" target="_blank" rel="external">GlobalEventHandlers</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> JavaScript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[小程序初体验]]></title>
      <url>/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%88%9D%E4%BD%93%E9%AA%8C/</url>
      <content type="html"><![CDATA[<p>小程序刚出来的时候就刷爆了朋友圈，各种铺天盖地的文章说是小程序的到来要改变前端的开发模式，不再需要客户端开发云云。。当时我也是热血沸腾，以为属于前端的时代来了，加入了“微信应用号开发群-4”，关注了微信公众号“很小的程序”，还加入了github上的组织“微信小程序开发者”。每天看着群里各种开发中遇到的问题抛出来，大家聊得很high，然而我也就运行了一下官方demo，浏览了一遍官网文档。大概那时候是没有太多时间去学习了。。。。<br><a id="more"></a><br>现在已经有很多小程序上线了，我也下载了很多，像</p>
<ul>
<li>滴滴出行</li>
<li>大众点评+</li>
<li>摩拜单车</li>
<li>印象笔记微清单</li>
<li>美柚App</li>
<li>京东购物</li>
</ul>
<p>然而体验了一番后，除了 印象笔记微清单 和  美柚App 其他的都删了。</p>
<p>出行类APP 滴滴出行和摩拜单车 因为体验没有下载的客户端应用好<br>购物类APP 大众点评+和京东购物   因为功能太简单了 不满足我的需求 </p>
<p>留下印象笔记微清单和美柚App只是因为功能比较简单又好用，一个记录我要做的事情，一个记录姨妈周期。</p>
<p>最近看到群里有人在问，小程序是不是要死了？哈哈，确实，还真没预期的那样好，我身边都没有人用呀。。。</p>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>正好最近事情不多，恩，可以写个小程序体验一下了。<br>找了个口碑外卖的模子，按照口碑外卖的视觉和交互，写了个小程序，半拉子，没有完全写好，以后有时间再补咯。</p>
<p>现在是长这样子，代码在 <a href="https://github.com/chang20159/weapp-waimai" target="_blank" rel="external">小程序-口碑外卖</a></p>
<p><img src="../images/weapp/wx_waimai.jpg" alt=""></p>
<h3 id="开发中遇到的问题"><a href="#开发中遇到的问题" class="headerlink" title="开发中遇到的问题"></a>开发中遇到的问题</h3><p>虽然只是简单的几个页面，遇到的问题还是不少。</p>
<h4 id="navigation无法跳转"><a href="#navigation无法跳转" class="headerlink" title="navigation无法跳转"></a>navigation无法跳转</h4><p>   页面跳转有两种方法，一个是用<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/component/navigator.html" target="_blank" rel="external">navigation组件</a>，还有一个是绑定事件，在事件处理器中调用小程序提供的<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/api/ui-navigate.html" target="_blank" rel="external">navigate api</a><br>   在使用navigation组件跳转页面时可能会出现无法跳转的问题，有几种可能原因：</p>
<ul>
<li>所有要跳转的页面都要配置在app.json的pages属性中</li>
<li>对于open-type=”navigate”和open-type=”redirect” 跳转的应用内得是 非 tabBar的页面的路径。</li>
<li>对于open-type=”switchTab”，跳转的页面必须在app.json的tabBar属性中配置  </li>
</ul>
<h4 id="无法使用js操作DOM"><a href="#无法使用js操作DOM" class="headerlink" title="无法使用js操作DOM"></a>无法使用js操作DOM</h4><p>如果想获得当前DOM的信息，可以在组件上自定义data-*属性，并通过绑定事件函数获取事件对象，从e.currentTarget.dataset中获取数据。如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;view data-shopId=<span class="string">"123"</span> bindtap=<span class="string">"toggleClick"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggleClick</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">    <span class="keyword">let</span> dataset = e.currentTarget.dataset;</div><div class="line">    <span class="built_in">console</span>.log(dataset.shopid);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>注意： data-<em>属性中的</em>都会被转成小写</p>
<h4 id="CSS尺寸单位最好使用rpx"><a href="#CSS尺寸单位最好使用rpx" class="headerlink" title="CSS尺寸单位最好使用rpx"></a>CSS尺寸单位最好使用rpx</h4><p>刚开始使用的px，同样的尺寸，在iphone6上显示正常，在iphone5上就被挤掉了，在iphone6 plus上尺寸又变得很小不美观。rpx对设备尺寸做了自适应。</p>
<table>
<thead>
<tr>
<th style="text-align:center">设备</th>
<th style="text-align:center">rpx换算px (屏幕宽度/750)</th>
<th style="text-align:center">px换算rpx (750/屏幕宽度)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">iPhone5</td>
<td style="text-align:center">1rpx = 0.42px</td>
<td style="text-align:center">1px = 2.34rpx</td>
</tr>
<tr>
<td style="text-align:center">iPhone6</td>
<td style="text-align:center">1rpx = 0.5px</td>
<td style="text-align:center">1px = 2rpx</td>
</tr>
<tr>
<td style="text-align:center">iPhone6 Plus</td>
<td style="text-align:center">1rpx = 0.552px</td>
<td style="text-align:center">1px = 1.81rpx</td>
</tr>
</tbody>
</table>
<h4 id="循环渲染时要加上wx-key-”id”"><a href="#循环渲染时要加上wx-key-”id”" class="headerlink" title="循环渲染时要加上wx:key=”id”"></a>循环渲染时要加上wx:key=”id”</h4><p>不然会warning，Now you can provide attr “wx:key” for a “wx:for” to improve performance.<br>加上可提升重新渲染时的效率</p>
<h4 id="swiper组件可支持垂直轮播，官方文档中没有写-不知道是为啥。"><a href="#swiper组件可支持垂直轮播，官方文档中没有写-不知道是为啥。" class="headerlink" title="swiper组件可支持垂直轮播，官方文档中没有写,不知道是为啥。"></a>swiper组件可支持垂直轮播，官方文档中没有写,不知道是为啥。</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">vertical</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="简单的组件化"><a href="#简单的组件化" class="headerlink" title="简单的组件化"></a>简单的组件化</h4><p>在index页面的js,wxml,wxss文件中分别引入组件Shop对应文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index.js</span></div><div class="line"><span class="keyword">import</span> Shop <span class="keyword">from</span> <span class="string">'../../component/shop/shop.js'</span>;</div><div class="line"></div><div class="line"><span class="comment">//index.wxml </span></div><div class="line">&lt;<span class="keyword">import</span> src=<span class="string">"../../component/shop/shop.wxml"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">//index.wxss</span></div><div class="line">@<span class="keyword">import</span> <span class="string">"../../component/shop/shop.wxss"</span>;</div></pre></td></tr></table></figure>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/MINA.html" target="_blank" rel="external">小程序 官方文档</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 小程序 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript浮点运算在某些情况下产生误差]]></title>
      <url>/javacript%E4%B8%AD%E6%B5%AE%E7%82%B9%E8%BF%90%E7%AE%97%E4%BA%A7%E7%94%9F%E8%AF%AF%E5%B7%AE/</url>
      <content type="html"><![CDATA[<p>商家创建一个发礼品券的活动，券金额0.1, 库存9999，那么活动成本是：0.1 × 9999 = 999.9000000000001<br>额。。。 不应该是99.99么？？<br>原来计算机进行四则运算时，在某些情况下会有误差，这是在safari上的测试结果。<br>0.1 + 0.2  = 0.30000000000000004<br>1.0 - 0.8  = 0.19999999999999996<br>1.6 × 9999 = 15998.400000000001<br>999.9 ÷ 9999 = 0.09999999999999999<br><a id="more"></a></p>
<h3 id="误差原因"><a href="#误差原因" class="headerlink" title="误差原因"></a>误差原因</h3><p>要弄明白出现这种问题的原因，得知道计算机是怎么处理小数的。计算机处理的是二进制数据，只有0和1。将十进制整数转换成二进制很简单，商除以2取余，小数点左侧从右向左排列就是整数部分二进制了。将小数部分转换成二进制，小数部分乘以2取整，小数点右侧从左向右排列就是小数部分的二进制，就可能出现无限循环。例如:<br>十进制  6.1<br>二进制  110.0001 1001 1001 1001 …<br>整数部分 6 ，余数在小数点左侧的顺序 110.<br>6 ÷ 2 = 3 … 0<br>3 ÷ 2 = 1 … 1<br>1 ÷ 2 = 0 … 1<br>小数部分 0.1 , 取结果的整数部分，结果的小数部分继续乘以2，知道结果没有小数部分为止<br>在小数点右侧的顺序  .0001 1001 1001 …<br>0.1 × 2 = 0.2   0.2 + 0<br>0.2 × 2 = 0.4   0.4 + 0<br>0.4 × 2 = 0.8   0.8 + 0<br>0.8 × 2 = 1.6   0.6 + 1<br>0.6 × 2 = 1.2   0.2 + 1<br>0.2 × 2 = 0.4   0.4 + 0<br>0.4 × 2 = 0.8   0.8 + 0<br>0.8 × 2 = 1.6   0.6 + 1<br>0.6 × 2 = 1.2   0.2 + 1<br>0.2 × 2 = 0.4   0.4 + 0<br>0.4 × 2 = 0.8   0.8 + 0<br>0.8 × 2 = 1.6   0.6 + 1<br>…<br>说明，有些十进制小数是不能用二进制有限位数表示的。</p>
<table>
<thead>
<tr>
<th style="text-align:center">十进制</th>
<th style="text-align:center">二进制        </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0.1</td>
<td style="text-align:center">0.0001 1001 1001 1001 …</td>
</tr>
<tr>
<td style="text-align:center">0.2</td>
<td style="text-align:center">0.0011 0011 0011 0011 …</td>
</tr>
<tr>
<td style="text-align:center">0.3</td>
<td style="text-align:center">0.0100 1100 1100 1100 …</td>
</tr>
<tr>
<td style="text-align:center">0.4</td>
<td style="text-align:center">0.0110 0110 0110 0110 …</td>
</tr>
<tr>
<td style="text-align:center">0.5</td>
<td style="text-align:center">0.1</td>
</tr>
<tr>
<td style="text-align:center">0.6</td>
<td style="text-align:center">0.1001 1001 1001 1001 …</td>
</tr>
</tbody>
</table>
<p>计算机无法表示无限小数，会进行取舍，从而造成误差。</p>
<h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><p>对于加减法和乘法，可以先将参加运算的小数扩大n倍，变成整数，整数运算后再缩小n倍。对于除法，可以两个参数同时扩大n倍，再运算。例如加法运算：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cadd</span>(<span class="params">arg1,arg2</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> max_decimal_length,l1,l2,expand_multiple;</div><div class="line">    l1 = arg1.toString().split(<span class="string">'.'</span>)[<span class="number">1</span>].length;</div><div class="line">    l2 = arg2.toString().split(<span class="string">'.'</span>)[<span class="number">1</span>].length;</div><div class="line">    max_decimal_length = l1 &gt; l2 ? l1 : l2; <span class="comment">//最长的小数位数</span></div><div class="line">    expand_multiple = <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="built_in">Math</span>.max(l1, l2)); <span class="comment">//扩大倍数</span></div><div class="line">    <span class="keyword">return</span> (arg1 * expand_multiple + arg2 * expand_multiple) / expand_multiple;</div><div class="line">&#125;</div><div class="line"><span class="built_in">Number</span>.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> cadd(arg,<span class="keyword">this</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://segmentfault.com/a/1190000004090283" target="_blank" rel="external">妥协与取舍，解构计算机中的二进制浮点数运算</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2010/06/ieee_floating-point_representation.html" target="_blank" rel="external">浮点数的二进制表示</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【jQuery源码】从事件绑定看缓存设计]]></title>
      <url>/jQuery%E6%BA%90%E7%A0%81-%E4%BB%8E%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E7%9C%8B%E7%BC%93%E5%AD%98%E8%AE%BE%E8%AE%A1/</url>
      <content type="html"><![CDATA[<p>当事件绑定顺序如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_content"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"J_jump"</span>&gt;</span>跳转<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"J_jump1"</span>&gt;</span>跳转1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery-3.1.1.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    $(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,clickHandler);</div><div class="line">    $(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,clickHandler);</div><div class="line">    $(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,<span class="string">'#J_jump'</span>,clickHandler);</div><div class="line">    $(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,<span class="string">'#J_jump1'</span>,clickHandler1);</div><div class="line">    $(<span class="string">'#J_content'</span>).on(<span class="string">'mousedown'</span>,<span class="string">'#J_jump1'</span>,clickHandler1);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>dataPriv.get(elem)得到的结果如下，其中elem是id为J_content的DOM节点,dataPriv.get(elem)中存放的是elem元素的相关数据（这里是绑定的事件信息)。</p>
<p>而dataPriv由 var dataPriv = new Data();而来，jQuery设计了缓存系统，在给元素绑定事件时，事件信息不是直接依附在dom元素上，而是将事件信息放在缓存中，与dom元素关联。这样可以有效的避免内存泄漏。<br><img src="/images/jqueryData/QQ20170208-223553@2x.png" alt=""></p>
<h3 id="jQuery缓存设计原理"><a href="#jQuery缓存设计原理" class="headerlink" title="jQuery缓存设计原理"></a>jQuery缓存设计原理</h3><p>var dataPriv = new Data();<br>elemData = dataPriv.get( elem );使用get方法去cache中取值。</p>
<p>jQuery缓存的设计思路是这样的：</p>
<ul>
<li>对于DOM元素，给其扩展一个属性，属性名是jQuery.expando + Data.uid++的值</li>
<li>将数据存放在该属性中，也就是该属性的属性值就是要存储的数据</li>
<li>这样在读取、设置、和移除都是操作这个属性</li>
</ul>
<p>直观一点就是下面这样，其实就是原本要直接附加到DOM元素上的对象，附加到DOM元素一个新的属性上。<br><img src="/images/jqueryData/QQ20170209-210553@2x.png" alt=""><br>给DOM节点elem绑定事件，事件对象都存放在elem的jQuery311093659233154491051属性中</p>
<h3 id="Data类"><a href="#Data类" class="headerlink" title="Data类"></a>Data类</h3><p>这个缓存机制的实现由Data类完成,Data类的提供的实例方法都是对扩展属性(jQuery311093659233154491051)及其对象属性的操作。<br><img src="/images/jqueryData/QQ20170208-223615@2x.png" alt=""><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Data</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//每个页面都会生成一个jQuery的唯一标识</span></div><div class="line">    <span class="comment">// jQuery.expando: "jQuery" + ( version + Math.random() ).replace( /\D/g, "" ),如jQuery31109365923315449105</span></div><div class="line">    <span class="keyword">this</span>.expando = jQuery.expando + Data.uid++;</div><div class="line">    <span class="comment">//结果是： jQuery311093659233154491051</span></div><div class="line">&#125;</div><div class="line">Data.uid = <span class="number">1</span>;</div><div class="line">Data.prototype = &#123;</div><div class="line">    <span class="attr">cache</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> owner </span>) </span>&#123; <span class="comment">//当owner是id为J_content的DOM节点</span></div><div class="line">        <span class="keyword">var</span> value = owner[ <span class="keyword">this</span>.expando ];</div><div class="line">        <span class="keyword">if</span> ( !value ) &#123;</div><div class="line">            value = &#123;&#125;; <span class="comment">// cache中如果没有，就创建&#123;&#125;,在内存中开辟区域存储</span></div><div class="line">            <span class="keyword">if</span> ( acceptData( owner ) ) &#123;</div><div class="line">                <span class="keyword">if</span> ( owner.nodeType ) &#123;</div><div class="line">                    <span class="comment">//并让DOM节点的jQuery311093659233154491051属性指向这个内存区域</span></div><div class="line">                    owner[ <span class="keyword">this</span>.expando ] = value;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="built_in">Object</span>.defineProperty( owner, <span class="keyword">this</span>.expando, &#123;</div><div class="line">                        <span class="attr">value</span>: value,</div><div class="line">                        <span class="attr">configurable</span>: <span class="literal">true</span></div><div class="line">                    &#125; );</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> value;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> owner, key </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> key === <span class="literal">undefined</span> ? <span class="keyword">this</span>.cache( owner ) :</div><div class="line">            <span class="comment">// Always use camelCase key (gh-2257)</span></div><div class="line">            owner[ <span class="keyword">this</span>.expando ] &amp;&amp; owner[ <span class="keyword">this</span>.expando ][ jQuery.camelCase( key ) ];</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> owner, data, value </span>) </span>&#123;... &#125;,</div><div class="line">    <span class="attr">access</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> owner, key, value </span>) </span>&#123;...&#125;,</div><div class="line">    <span class="attr">remove</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> owner, key </span>) </span>&#123;...&#125;,</div><div class="line">    <span class="attr">hasData</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> owner </span>) </span>&#123;...&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> dataPriv = <span class="keyword">new</span> Data(); <span class="comment">//jQuery内部使用,如事件</span></div><div class="line"><span class="keyword">var</span> dataUser = <span class="keyword">new</span> Data(); <span class="comment">//给开发者使用，如$.attr(),$.date()</span></div></pre></td></tr></table></figure></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://jquery.com/" target="_blank" rel="external">jQuery官网</a></li>
<li><a href="https://github.com/jquery/jquery" target="_blank" rel="external">jQuery GitHub</a></li>
<li><a href="http://www.imooc.com/learn/172" target="_blank" rel="external">慕课网 jQuery源码解析（架构与依赖模块）</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> JQuery </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jQuery3.1.1源码 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【jQuery源码】事件绑定与解绑]]></title>
      <url>/jQuery%E6%BA%90%E7%A0%81-%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E4%B8%8E%E8%A7%A3%E7%BB%91/</url>
      <content type="html"><![CDATA[<p>jQuery事件是DOM事件的封装，提供了一些事件绑定和触发的方法,并且支持自定义事件。</p>
<ul>
<li>绑定事件 <ul>
<li><a href="http://jquery.cuishifeng.cn/bind.html" target="_blank" rel="external">bind</a></li>
<li><a href="http://jquery.cuishifeng.cn/delegate.html" target="_blank" rel="external">delegate</a>  </li>
<li><a href="http://jquery.cuishifeng.cn/on.html" target="_blank" rel="external">on</a></li>
<li><a href="http://jquery.cuishifeng.cn/one.html" target="_blank" rel="external">one</a></li>
<li>blur focus focusin focusout resize scroll …等事件名方法</li>
</ul>
</li>
<li>解绑事件 <ul>
<li><a href="http://jquery.cuishifeng.cn/unbind.html" target="_blank" rel="external">unbind</a></li>
<li><a href="http://jquery.cuishifeng.cn/undelegate.html" target="_blank" rel="external">undelegate</a></li>
<li><a href="http://jquery.cuishifeng.cn/off.html" target="_blank" rel="external">off</a></li>
</ul>
</li>
<li>触发事件 <ul>
<li><a href="http://jquery.cuishifeng.cn/trigger.html" target="_blank" rel="external">trigger</a><a id="more"></a>
</li>
</ul>
</li>
</ul>
<h3 id="对外提供的方法"><a href="#对外提供的方法" class="headerlink" title="对外提供的方法"></a>对外提供的方法</h3><p>从源码看<br>1、绑定事件的bind、delegate最终都是调用jQuery.prototype.on方法，jQuery.prototype.on调用的是一个全局的on方法 on( elem, types, selector, data, fn, one ) ，与on方法的区别：</p>
<ul>
<li>bind方法的selector是null,不支持传入selector</li>
<li>delegate方法只是参数的传入顺序与on方法不同,jQuery 3.0中已弃用此方法，用 on()代替。</li>
</ul>
<p>2、 移除事件的unbind、undelegate最终都是调用jQuery.prototype.off方法function( types, selector, fn ) ,与off方法的区别：</p>
<ul>
<li>unbind方法的selector是null,不支持传入selector</li>
<li>undelegate方法只是参数的传入顺序与off方法不同</li>
</ul>
<p>3、 one方法绑定的事件处理器只执行一次，它与on方法相同，调用的全局的on方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">jQuery.fn.extend( &#123;</div><div class="line">    <span class="attr">bind</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, data, fn </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.on( types, <span class="literal">null</span>, data, fn );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">unbind</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, fn </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.off( types, <span class="literal">null</span>, fn );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">delegate</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> selector, types, data, fn </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.on( types, selector, data, fn );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">undelegate</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> selector, types, fn </span>) </span>&#123;</div><div class="line">        <span class="comment">// ( namespace ) or ( selector, types [, fn] )</span></div><div class="line">        <span class="keyword">return</span> <span class="built_in">arguments</span>.length === <span class="number">1</span> ?</div><div class="line">            <span class="keyword">this</span>.off( selector, <span class="string">"**"</span> ) :</div><div class="line">            <span class="keyword">this</span>.off( types, selector || <span class="string">"**"</span>, fn );</div><div class="line">    &#125;</div><div class="line">&#125; );</div><div class="line">jQuery.fn.extend( &#123;</div><div class="line">    <span class="attr">on</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, selector, data, fn </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> on( <span class="keyword">this</span>, types, selector, data, fn );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">one</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, selector, data, fn </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> on( <span class="keyword">this</span>, types, selector, data, fn, <span class="number">1</span> );</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">off</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, selector, fn </span>) </span>&#123;</div><div class="line">        ....</div><div class="line">    &#125;</div><div class="line">&#125; );</div></pre></td></tr></table></figure></p>
<p>jQuery还提供了一种绑定事件的方法,将事件类型名作为jQuery.prototype的方法属性名，所以我们还可以这样绑定事件：$(‘#id’).click(eventHandler)。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">jQuery.each( ( <span class="string">"blur focus focusin focusout resize scroll click dblclick "</span> +</div><div class="line">    <span class="string">"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "</span> +</div><div class="line">    <span class="string">"change select submit keydown keypress keyup contextmenu"</span> ).split( <span class="string">" "</span> ),</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"> i, name </span>) </span>&#123;</div><div class="line">    <span class="comment">// Handle event binding</span></div><div class="line">    jQuery.fn[ name ] = <span class="function"><span class="keyword">function</span>(<span class="params"> data, fn </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">arguments</span>.length &gt; <span class="number">0</span> ?</div><div class="line">            <span class="keyword">this</span>.on( name, <span class="literal">null</span>, data, fn ) :</div><div class="line">            <span class="keyword">this</span>.trigger( name );</div><div class="line">    &#125;;</div><div class="line">&#125; );</div><div class="line">jQuery.fn.extend( &#123;</div><div class="line">    <span class="attr">hover</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> fnOver, fnOut </span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.mouseenter( fnOver ).mouseleave( fnOut || fnOver );</div><div class="line">    &#125;</div><div class="line">&#125; );</div></pre></td></tr></table></figure></p>
<h3 id="on函数"><a href="#on函数" class="headerlink" title="on函数"></a>on函数</h3><p>jQuery.prototype上绑定事件的方法 bind、delegate、on、one最终都是调用全局的on( elem, types, selector, data, fn, one )方法，有这些参数：</p>
<ul>
<li>elem 数组类型 要绑定事件的dom元素 </li>
<li>types 事件对象(a map of types/handlers) 或者事件类型(click、change) </li>
<li>selector 选择器</li>
<li>data 附加参数，在使用trigger方法触发事件时传入，用户操作触发时，data是undefined</li>
<li>fn  事件处理函数，事件触发后要做的事情</li>
<li>one 传入参数为1，事件只执行一次，然后移除事件<br>on方法的绝大部分代码都是在处理参数不同（数量和类型）的情况下，统一调用jQuery.event.add( this, types, fn, data, selector )方法<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">on</span>(<span class="params"> elem, types, selector, data, fn, one </span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> origFn, type;</div><div class="line">    <span class="comment">// Types can be a map of types/handlers</span></div><div class="line">    <span class="comment">// 例如$('#id').on(&#123;click:clickHandler,change:changeHandler&#125;,'#id0',&#123;name:'on'&#125;)</span></div><div class="line">    <span class="keyword">if</span> ( <span class="keyword">typeof</span> types === <span class="string">"object"</span> ) &#123; </div><div class="line">        <span class="comment">// 【1】( types-Object, selector, data ) types是object时只有三个参数的情况</span></div><div class="line">        <span class="comment">// 当types是一个对象时，需要对每一个type依次绑定对应的事件处理器</span></div><div class="line">        <span class="comment">// 并在一次调用on方法前做个参数处理</span></div><div class="line">        <span class="keyword">if</span> ( <span class="keyword">typeof</span> selector !== <span class="string">"string"</span> ) &#123;</div><div class="line">            <span class="comment">//【2】( types-Object, data )</span></div><div class="line">            <span class="comment">// 如果第三个参数不是string类型，那参数中就没有selector</span></div><div class="line">            <span class="comment">// 例如$('#id').on(&#123;click:clickHandler,change:changeHandler&#125;,&#123;name:'on'&#125;)</span></div><div class="line">            data = data || selector; <span class="comment">// data = null || &#123;name:'on'&#125;</span></div><div class="line">            selector = <span class="literal">undefined</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> ( type <span class="keyword">in</span> types ) &#123;</div><div class="line">            on( elem, type, selector, data, types[ type ], one );</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> elem;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//如果第4位参数data 和第5位参数fn没有，即$('#id').on(param1,param2)这样只有两位参数</span></div><div class="line">    <span class="comment">//elem之后的参数依次是事件类型和事件处理函数</span></div><div class="line">    <span class="keyword">if</span> ( data == <span class="literal">null</span> &amp;&amp; fn == <span class="literal">null</span> ) &#123;</div><div class="line">        <span class="comment">// 【3】( types, fn ) 只有两个参数，事件类型和事件处理器</span></div><div class="line">        fn = selector;</div><div class="line">        data = selector = <span class="literal">undefined</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( fn == <span class="literal">null</span> ) &#123;</div><div class="line">        <span class="keyword">if</span> ( <span class="keyword">typeof</span> selector === <span class="string">"string"</span> ) &#123;</div><div class="line">            <span class="comment">// 【4】( types, selector, fn ) 三个参数，事件类型，过滤elem后代元素的选择器，事件处理器</span></div><div class="line">            fn = data;</div><div class="line">            data = <span class="literal">undefined</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">//【5】( types, data, fn )</span></div><div class="line">            fn = data;</div><div class="line">            data = selector;</div><div class="line">            selector = <span class="literal">undefined</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//【6】fn也可以是一个false值，在on方法中fn为false时，转为一个直接返回false的函数，作为后续调用的jQuery.event.add方法的参数</span></div><div class="line">    <span class="comment">// false值就是做一个直接返回false的函数的简写</span></div><div class="line">    <span class="keyword">if</span> ( fn === <span class="literal">false</span> ) &#123;</div><div class="line">        fn = <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( !fn ) &#123; <span class="comment">//如果没有事件处理器就啥也不干，返回这个dom元素</span></div><div class="line">        <span class="keyword">return</span> elem;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//【7】事件只会触发一次就移除时，对事件处理函数进行封装</span></div><div class="line">    <span class="comment">//第一次触发执行时，先移除事件处理器，再执行事件</span></div><div class="line">    <span class="keyword">if</span> ( one === <span class="number">1</span> ) &#123;</div><div class="line">        origFn = fn;</div><div class="line">        fn = <span class="function"><span class="keyword">function</span>(<span class="params"> event </span>) </span>&#123;</div><div class="line">            <span class="comment">// Can use an empty set, since event contains the info</span></div><div class="line">            jQuery().off( event );</div><div class="line">            <span class="keyword">return</span> origFn.apply( <span class="keyword">this</span>, <span class="built_in">arguments</span> );</div><div class="line">        &#125;;</div><div class="line">        <span class="comment">// Use same guid so caller can remove using origFn</span></div><div class="line">        fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> elem.each( <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        jQuery.event.add( <span class="keyword">this</span>, types, fn, data, selector );</div><div class="line">    &#125; );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="jQuery-event-add方法"><a href="#jQuery-event-add方法" class="headerlink" title="jQuery.event.add方法"></a>jQuery.event.add方法</h4><p>jQuery.event.add将每个事件处理器封装成事件处理对象，包括唯一标识、事件处理函数、选择器等属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line">add: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, types, handler, data, selector </span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> handleObjIn, eventHandle, tmp,</div><div class="line">            events, t, handleObj,</div><div class="line">            special, handlers, type, namespaces, origType,</div><div class="line">            elemData = dataPriv.get( elem );</div><div class="line">        <span class="comment">// 对elem第一次绑定事件前，elemData为空对象&#123;&#125;</span></div><div class="line">        <span class="keyword">if</span> ( !elemData ) &#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 传入的形式是&#123;handler：handler，selector：selector&#125;</span></div><div class="line">        <span class="keyword">if</span> ( handler.handler ) &#123;</div><div class="line">            handleObjIn = handler;</div><div class="line">            handler = handleObjIn.handler;</div><div class="line">            selector = handleObjIn.selector;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 判断选择器是否存在</span></div><div class="line">        <span class="keyword">if</span> ( selector ) &#123;</div><div class="line">            jQuery.find.matchesSelector( documentElement, selector );</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 给事件处理器添加唯一标识</span></div><div class="line">        <span class="keyword">if</span> ( !handler.guid ) &#123;</div><div class="line">            handler.guid = jQuery.guid++;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// 第一次给该元素绑定时初始化elemData的events属性和handle属性</span></div><div class="line">        <span class="keyword">if</span> ( !( events = elemData.events ) ) &#123;</div><div class="line">            events = elemData.events = &#123;&#125;;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> ( !( eventHandle = elemData.handle ) ) &#123;</div><div class="line">            eventHandle = elemData.handle = <span class="function"><span class="keyword">function</span>(<span class="params"> e </span>) </span>&#123;</div><div class="line">                <span class="comment">// Discard the second event of a jQuery.event.trigger() and</span></div><div class="line">                <span class="comment">// when an event is called after a page has unloaded</span></div><div class="line">                <span class="keyword">return</span> <span class="keyword">typeof</span> jQuery !== <span class="string">"undefined"</span> &amp;&amp; jQuery.event.triggered !== e.type ?</div><div class="line">                    jQuery.event.dispatch.apply( elem, <span class="built_in">arguments</span> ) : <span class="literal">undefined</span>;</div><div class="line">            &#125;;</div><div class="line">        &#125;</div><div class="line">        types = ( types || <span class="string">""</span> ).match( rnothtmlwhite ) || [ <span class="string">""</span> ];</div><div class="line">        t = types.length;</div><div class="line">        <span class="keyword">while</span> ( t-- ) &#123;</div><div class="line">            tmp = rtypenamespace.exec( types[ t ] ) || [];</div><div class="line">            type = origType = tmp[ <span class="number">1</span> ];</div><div class="line">            namespaces = ( tmp[ <span class="number">2</span> ] || <span class="string">""</span> ).split( <span class="string">"."</span> ).sort();</div><div class="line">            <span class="keyword">if</span> ( !type ) &#123; <span class="keyword">continue</span>; &#125;</div><div class="line">            <span class="comment">// If event changes its type, use the special event handlers for the changed type</span></div><div class="line">            special = jQuery.event.special[ type ] || &#123;&#125;;</div><div class="line">            <span class="comment">// If selector defined, determine special event api type, otherwise given type</span></div><div class="line">            type = ( selector ? special.delegateType : special.bindType ) || type;</div><div class="line">            <span class="comment">// Update special based on newly reset type</span></div><div class="line">            special = jQuery.event.special[ type ] || &#123;&#125;;</div><div class="line">            <span class="comment">// handleObj is passed to all event handlers</span></div><div class="line">            handleObj = jQuery.extend( &#123;</div><div class="line">                <span class="attr">type</span>: type,</div><div class="line">                <span class="attr">origType</span>: origType,</div><div class="line">                <span class="attr">data</span>: data,</div><div class="line">                <span class="attr">handler</span>: handler,</div><div class="line">                <span class="attr">guid</span>: handler.guid,</div><div class="line">                <span class="attr">selector</span>: selector,</div><div class="line">                <span class="attr">needsContext</span>: selector &amp;&amp; jQuery.expr.match.needsContext.test( selector ),</div><div class="line">                <span class="attr">namespace</span>: namespaces.join( <span class="string">"."</span> )</div><div class="line">            &#125;, handleObjIn );</div><div class="line"></div><div class="line">            <span class="comment">// 在events对象中，存储该元素绑定事件对应的事件处理器数组</span></div><div class="line">            <span class="comment">// 对该元素的某一类型事件第一次绑定事件处理器时，对handlers初始化为空数组[]</span></div><div class="line">            <span class="keyword">if</span> ( !( handlers = events[ type ] ) ) &#123;</div><div class="line">                handlers = events[ type ] = [];</div><div class="line">                handlers.delegateCount = <span class="number">0</span>;</div><div class="line">                <span class="comment">// Only use addEventListener if the special events handler returns false</span></div><div class="line">                <span class="comment">// 只有在此种条件下才会直接用addEventListener绑定事件</span></div><div class="line">                <span class="keyword">if</span> ( !special.setup ||</div><div class="line">                    special.setup.call( elem, data, namespaces, eventHandle ) === <span class="literal">false</span> ) &#123;</div><div class="line">                    <span class="keyword">if</span> ( elem.addEventListener ) &#123;</div><div class="line">                        elem.addEventListener( type, eventHandle );</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> ( special.add ) &#123;</div><div class="line">                special.add.call( elem, handleObj );</div><div class="line">                <span class="keyword">if</span> ( !handleObj.handler.guid ) &#123;</div><div class="line">                    handleObj.handler.guid = handler.guid;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// 将处理器对象存放在dataPriv.get( elem )[type].handlers中</span></div><div class="line">            <span class="comment">// 如果是事件代理，处理器对象放在列表前面，用splice实现，将handleObj插入最后一个事件代理处理器之后 </span></div><div class="line">            <span class="keyword">if</span> ( selector ) &#123;</div><div class="line">                handlers.splice( handlers.delegateCount++, <span class="number">0</span>, handleObj );</div><div class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">//如果不是事件代理，直接放在列表最后，用push即可</span></div><div class="line">                handlers.push( handleObj );</div><div class="line">            &#125;</div><div class="line">            jQuery.event.global[ type ] = <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>当事件绑定顺序如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,clickHandler);</div><div class="line">$(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,clickHandler);</div><div class="line">$(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,<span class="string">'#J_jump'</span>,clickHandler);</div><div class="line">$(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,<span class="string">'#J_jump1'</span>,clickHandler1);</div><div class="line">$(<span class="string">'#J_content'</span>).on(<span class="string">'mousedown'</span>,<span class="string">'#J_jump1'</span>,clickHandler1);</div></pre></td></tr></table></figure></p>
<p>events的内容为：<br><img src="/images/jqueryEventAdd/QQ20170208-213500@2x.png" alt=""></p>
<ul>
<li>其中guid为事件处理器的唯一标识，事件处理器clickHandler的guid为1，clickHandler1的guid为2。</li>
<li>events中存放每个事件对应的多个事件处理器对象</li>
<li>当类型相同、处理器相同是，也会存入一个事件处理器对象</li>
<li>对于同一类型的事件处理器，事件代理处理器总会放在前面<h4 id="事件绑定用法"><a href="#事件绑定用法" class="headerlink" title="事件绑定用法"></a>事件绑定用法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"事件处理"</span>);</div><div class="line">&#125;</div><div class="line">$(<span class="string">'#J_confirm'</span>).click(clickHandler);</div><div class="line">$(<span class="string">'#J_confirm'</span>).on(<span class="string">'click'</span>,clickHandler);</div><div class="line">$(<span class="string">'#J_confirm'</span>).on(&#123;</div><div class="line">    <span class="attr">click</span>:  clickHandler,</div><div class="line">    <span class="attr">mousedown</span>: clickHandler</div><div class="line">&#125;);</div><div class="line">$(<span class="string">'#J_confirm'</span>).bind(<span class="string">'click'</span>,clickHandler)</div><div class="line">$(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,<span class="string">'#J_jump'</span>,clickHandler);</div><div class="line">$(<span class="string">'#J_content'</span>).one(<span class="string">'click'</span>,<span class="string">'#J_jump'</span>,clickHandler);</div><div class="line">$(<span class="string">'#J_confirm'</span>).one(<span class="string">'click'</span>,clickHandler);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>用trigger触发事件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function clickHandler(e,name)&#123;</div><div class="line">    console.log(name + &quot; 事件处理&quot;);</div><div class="line">&#125;</div><div class="line">$(&quot;#J_confirm&quot;).click(clickHandler);</div><div class="line">$(&quot;#J_confirm&quot;).trigger(&quot;click&quot;, &quot;use trigger&quot;);</div><div class="line">// 可简写如下</div><div class="line">$(&quot;#J_confirm&quot;).click(clickHandler).trigger(&quot;click&quot;, &quot;use trigger&quot;);</div></pre></td></tr></table></figure></p>
<h3 id="off方法"><a href="#off方法" class="headerlink" title="off方法"></a>off方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">off: <span class="function"><span class="keyword">function</span>(<span class="params"> types, selector, fn </span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> handleObj, type;</div><div class="line">        <span class="keyword">if</span> ( types &amp;&amp; types.preventDefault &amp;&amp; types.handleObj ) &#123;</div><div class="line">            <span class="comment">// ( event )  dispatched jQuery.Event</span></div><div class="line">            handleObj = types.handleObj;</div><div class="line">            jQuery( types.delegateTarget ).off(</div><div class="line">                handleObj.namespace ?</div><div class="line">                    handleObj.origType + <span class="string">"."</span> + handleObj.namespace :</div><div class="line">                    handleObj.origType,</div><div class="line">                handleObj.selector,</div><div class="line">                handleObj.handler</div><div class="line">            );</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> ( <span class="keyword">typeof</span> types === <span class="string">"object"</span> ) &#123;</div><div class="line">            <span class="comment">// ( types-object [, selector] )</span></div><div class="line">            <span class="keyword">for</span> ( type <span class="keyword">in</span> types ) &#123;</div><div class="line">                <span class="keyword">this</span>.off( type, selector, types[ type ] );</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> ( selector === <span class="literal">false</span> || <span class="keyword">typeof</span> selector === <span class="string">"function"</span> ) &#123;</div><div class="line">            <span class="comment">// ( types [, fn] )</span></div><div class="line">            fn = selector;</div><div class="line">            selector = <span class="literal">undefined</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> ( fn === <span class="literal">false</span> ) &#123;</div><div class="line">            fn = returnFalse;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.each( <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            jQuery.event.remove( <span class="keyword">this</span>, types, fn, selector );</div><div class="line">        &#125; );</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="jQuery-event-remove方法"><a href="#jQuery-event-remove方法" class="headerlink" title="jQuery.event.remove方法"></a>jQuery.event.remove方法</h4><p>remove方法最终调用javascript提供的removeEventListener<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ( elem.removeEventListener ) &#123;</div><div class="line">        elem.removeEventListener( type, handle );</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<h4 id="事件解绑用法"><a href="#事件解绑用法" class="headerlink" title="事件解绑用法"></a>事件解绑用法</h4><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://jquery.com/" target="_blank" rel="external">jQuery官网</a></li>
<li><a href="https://github.com/jquery/jquery" target="_blank" rel="external">jQuery GitHub</a></li>
<li><a href="http://jquery.cuishifeng.cn/index.html" target="_blank" rel="external">jQuery API 3.1.0 速查表  –作者：Shifone</a></li>
<li><a href="http://www.imooc.com/learn/222" target="_blank" rel="external">慕课网 jQuery源码解析（DOM与核心模块）</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> JQuery </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jQuery3.1.1源码 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CSS小经验]]></title>
      <url>/CSS%E5%B0%8F%E7%BB%8F%E9%AA%8C/</url>
      <content type="html"><![CDATA[<h3 id="隐藏滚动条"><a href="#隐藏滚动条" class="headerlink" title="隐藏滚动条"></a>隐藏滚动条</h3><p>见<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/::-webkit-scrollbar" target="_blank" rel="external">::-webkit-scrollbar</a><br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.visible-scrollbar</span>, <span class="selector-class">.invisible-scrollbar</span> &#123;</div><div class="line">  <span class="attribute">display</span>: block;</div><div class="line">  <span class="attribute">width</span>: <span class="number">10em</span>;</div><div class="line">  <span class="attribute">overflow</span>: auto;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.invisible-scrollbar</span><span class="selector-pseudo">::-webkit-scrollbar</span> &#123;</div><div class="line">  <span class="attribute">display</span>: none;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h3 id="display-inline-block-元素之间有空白间隙"><a href="#display-inline-block-元素之间有空白间隙" class="headerlink" title="display:inline-block 元素之间有空白间隙"></a>display:inline-block 元素之间有空白间隙</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">ul</span>&#123;</div><div class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">li</span>&#123;</div><div class="line">    <span class="attribute">width</span>:<span class="number">50%</span>;</div><div class="line">    <span class="attribute">display</span>:inline-block;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果html结构写成这样，两个li中间会有间隙假设为n px ,那这一行就放不下两个li<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>第一个<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>第二个<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>最好的解决办法是将html结构写成这样<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></div><div class="line">    第一个<span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">li</span>&gt;</span></div><div class="line">    第二个<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="定宽不换行"><a href="#定宽不换行" class="headerlink" title="定宽不换行"></a>定宽不换行</h3><p>white-space: nowrap;</p>
<h3 id="单行文本溢出显示省略号"><a href="#单行文本溢出显示省略号" class="headerlink" title="单行文本溢出显示省略号"></a>单行文本溢出显示省略号</h3><p>有两个条件</p>
<ul>
<li>设置文本显示在一行  white-space:nowrap</li>
<li>溢出时隐藏内容   overflow:hidden<br>再设置：text-overflow:ellipsis       ellipsis翻译：（语法结构上的）省略</li>
</ul>
<h3 id="多行文本移除显示省略号"><a href="#多行文本移除显示省略号" class="headerlink" title="多行文本移除显示省略号"></a>多行文本移除显示省略号</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// 仅适用于webkit内核浏览器</div><div class="line">p&#123;</div><div class="line">  display: -webkit-box;   //设置display，将对象作为弹性伸缩盒子模型显示</div><div class="line">  -webkit-box-orient: vertical;  //规定框的子元素应该被水平或垂直排列</div><div class="line">  -webkit-line-clamp: 4;  //限制在一个块元素显示的文本的行数</div><div class="line">  overflow: hidden;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="z-index无效"><a href="#z-index无效" class="headerlink" title="z-index无效"></a>z-index无效</h3><p>需要设置position属性为非static值</p>
<h3 id="弹窗滚动到底时，后面的页面也跟着滚动"><a href="#弹窗滚动到底时，后面的页面也跟着滚动" class="headerlink" title="弹窗滚动到底时，后面的页面也跟着滚动"></a>弹窗滚动到底时，后面的页面也跟着滚动</h3><p>在点开弹窗时给html和body添加class ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">.forbidden-root-scroll&#123;</div><div class="line">  overflow:hidden;</div><div class="line">  height:100%;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>关闭弹窗时remove class</p>
<p>这样设置会让页面重置到没有滚动的状态。这样会造成一个问题，比如查看第二页时点击弹窗，页面会重置到第一页，关闭弹窗时就不是原来的位置了。所以在添加上面的属性之前要先记下body的scrollTop，remove class之后设置body的scrollTop为前面记下的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">this.html = document.getElementsByTagName(&apos;html&apos;)[0];</div><div class="line">this.body = document.getElementsByTagName(&apos;body&apos;)[0];</div><div class="line">this.scrollTop = 0</div><div class="line"></div><div class="line">forbiddenRootScroll(flag)&#123;</div><div class="line">    if(flag)&#123;</div><div class="line">        this.scrollTop = this.body.scrollTop</div><div class="line">        this.html.setAttribute(&apos;class&apos;,&apos;forbidden-root-scroll&apos;)</div><div class="line">        this.body.setAttribute(&apos;class&apos;,&apos;forbidden-root-scroll&apos;)</div><div class="line"></div><div class="line">    &#125;else&#123;</div><div class="line">        this.html.removeAttribute(&apos;class&apos;,&apos;forbidden-root-scroll&apos;)</div><div class="line">        this.body.removeAttribute(&apos;class&apos;,&apos;forbidden-root-scroll&apos;)</div><div class="line">        this.body.scrollTop = this.scrollTop</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//打开弹窗调用this.forbiddenRootScroll(true)</div><div class="line">//关闭弹窗调用this.forbiddenRootScroll(false)</div></pre></td></tr></table></figure>
<h2 id="input-placeholder与value重叠"><a href="#input-placeholder与value重叠" class="headerlink" title="input placeholder与value重叠"></a>input placeholder与value重叠</h2><p>妖孽的问题啊  等我复现了再研究是个什么鬼</p>
]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[下雨天]]></title>
      <url>/%E4%B8%8B%E9%9B%A8%E5%A4%A9/</url>
      <content type="html"><![CDATA[<p>周末依然宅公司<br>午餐是水果Family<br>留个照<br>欧耶~~<br><a id="more"></a></p>
<p><img src="/images/fruits/P70107-123326_mh1483763908233.jpg" width="300"><img src="/images/fruits/P70107-122828_mh1483764159420.jpg" width="300"><img src="/images/fruits/P70107-122930_mh1483764119073.jpg" width="300"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=368764&auto=0&height=66"></iframe></p>
]]></content>
      
        <categories>
            
            <category> 日常 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[【jQuery源码】第一篇]]></title>
      <url>/jQuery%E6%BA%90%E7%A0%81-%E7%AC%AC%E4%B8%80%E7%AF%87/</url>
      <content type="html"><![CDATA[<p>在使用jQuery的过程中遇到很多的疑惑。<br>jQuery为什么可以用美元符$表示？<br>事件绑定的几个方法bind、delegate、on之间有什么区别？<br>jQuery怎么判断checkbox是否被选中，有哪几种方法？<br>这样的问题有很多，还记不住，日常使用到的jQuery API，既然用到了，就学习一下源码吧~<br>理解了实现，就不怕忘记了。<br>目前学习的版本是3.1.1，代码已经1万+行了。最新源码可从<a href="https://github.com/jquery/jquery" target="_blank" rel="external">jquery GitHub</a>获取。<br><a id="more"></a></p>
<h2 id="总体结构"><a href="#总体结构" class="headerlink" title="总体结构"></a>总体结构</h2><p>JQuery的源码是一个立即执行的函数,带两个参数,对象global和函数factory</p>
<ul>
<li>global   &gt;  typeof window !== “undefined” ? window : this</li>
<li>factory  &gt;  function( window, noGlobal ) {  …  }</li>
<li><p>factory函数是构建jQuery的工厂，提供jQuery各种方法。当作为模块被引入时，输出jQuery，在浏览器中直接使用时，将jQuery赋给window.$。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">( <span class="function"><span class="keyword">function</span>(<span class="params"> global, factory </span>) </span>&#123;</div><div class="line"><span class="meta">	"use strict"</span>;</div><div class="line">	<span class="keyword">if</span> ( <span class="keyword">typeof</span> <span class="built_in">module</span> === <span class="string">"object"</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span>.exports === <span class="string">"object"</span> ) &#123;</div><div class="line">		<span class="built_in">module</span>.exports = global.document ?</div><div class="line">			factory( global, <span class="literal">true</span> ) :</div><div class="line">			<span class="function"><span class="keyword">function</span>(<span class="params"> w </span>) </span>&#123;</div><div class="line">				<span class="keyword">if</span> ( !w.document ) &#123;</div><div class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>( <span class="string">"jQuery requires a window with a document"</span>);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">return</span> factory( w );</div><div class="line">			&#125;;</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		factory( global );</div><div class="line">	&#125;</div><div class="line">&#125; )( <span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">"undefined"</span> ? <span class="built_in">window</span> : <span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> window, noGlobal </span>) </span>&#123;</div><div class="line">	<span class="comment">//jQuery 是一个函数</span></div><div class="line">	<span class="keyword">var</span>	jQuery = <span class="function"><span class="keyword">function</span>(<span class="params"> selector, context </span>) </span>&#123;</div><div class="line">			<span class="keyword">return</span> <span class="keyword">new</span> jQuery.fn.init( selector, context );</div><div class="line">		&#125;;</div><div class="line">		<span class="comment">// 核心方法</span></div><div class="line">		<span class="comment">// 回调系统</span></div><div class="line">		<span class="comment">// 异步队列</span></div><div class="line">		<span class="comment">// 数据缓存</span></div><div class="line">		<span class="comment">// 队列操作</span></div><div class="line">		<span class="comment">// 选择器引</span></div><div class="line">		<span class="comment">// 属性操作</span></div><div class="line">		<span class="comment">// 节点遍历</span></div><div class="line">		<span class="comment">// 文档处理</span></div><div class="line">		<span class="comment">// 样式操作</span></div><div class="line">		<span class="comment">// 属性操作</span></div><div class="line">		<span class="comment">// 事件体系</span></div><div class="line">		<span class="comment">// AJAX交互</span></div><div class="line">		<span class="comment">// 动画引擎</span></div><div class="line">	<span class="keyword">if</span> ( <span class="keyword">typeof</span> define === <span class="string">"function"</span> &amp;&amp; define.amd ) &#123;</div><div class="line">		define( <span class="string">"jquery"</span>, [], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			<span class="keyword">return</span> jQuery;</div><div class="line">		&#125; );</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//在没有作为模块引入时，将jQuery赋给window.$和window.jQuery</span></div><div class="line">	<span class="keyword">if</span> ( !noGlobal ) &#123;</div><div class="line">		<span class="built_in">window</span>.jQuery = <span class="built_in">window</span>.$ = jQuery;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> jQuery;</div><div class="line">&#125; );</div></pre></td></tr></table></figure>
</li>
<li><p>当在其他模块中通过require(jQuery)的形式（CommonJS AMD等规范引入模块的方式）引入，并且在浏览器环境下，那这个代码的逻辑是这样的，将jQuery输出</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"> window, true </span>) </span>&#123; </div><div class="line">	... </div><div class="line">	if ( <span class="keyword">typeof</span> define === <span class="string">"function"</span> &amp;&amp; define.amd ) &#123;</div><div class="line">		define( <span class="string">"jquery"</span>, [], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			<span class="keyword">return</span> jQuery;</div><div class="line">		&#125; );</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>当在其他模块中通过require(jQuery)的形式引入，但不是在浏览器环境下，比如在nodejs环境中，global.document是不存在的，那逻辑就是这样。输出模块时抛出错误，提示当前环境因为没有window.document而不支持jQuery</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"> w </span>) </span>&#123;</div><div class="line">				<span class="keyword">if</span> ( !w.document ) &#123;</div><div class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>( <span class="string">"jQuery requires a window with a document"</span> );</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">return</span> factory( w );</div><div class="line">			&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>如果不是用require(jQuery)的形式引入，比如直接使用window.$，逻辑就是这样的，将构建好的jQuery赋给window.$和window.jQuery，这样就可以直接使用$了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>(<span class="params"> window, false </span>) </span>&#123; </div><div class="line">	... </div><div class="line">	window.jQuery = <span class="built_in">window</span>.$ = jQuery;</div><div class="line">	<span class="keyword">return</span> jQuery;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>在浏览器中 window == this，window.document存在，在nodejs环境下 global == this，不存在global.document。所以在nodejs环境中是不支持jQuery的。</p>
<h2 id="JQuery扩展方法extend"><a href="#JQuery扩展方法extend" class="headerlink" title="JQuery扩展方法extend"></a>JQuery扩展方法extend</h2><h3 id="源码中extend方法的使用"><a href="#源码中extend方法的使用" class="headerlink" title="源码中extend方法的使用"></a>源码中extend方法的使用</h3><p>给jQuery自身和jQuery原型都定义了一个extend方法，在jQuery源码内部大部分jQuery和jQuery原型的属性都是用extend方法扩展的，jQuery的extend方法也常用来扩展对象，或者用于jQuery插件的开发。在jQuery中定义和使用extend如下<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//设置prototype属性</span></div><div class="line">jQuery.fn = jQuery.prototype = &#123; ... &#125;;</div><div class="line"><span class="comment">//给jQuery自身和jQuery原型都定义一个extend方法，</span></div><div class="line"><span class="comment">//用于扩展jQuery和jQuery.prototype的属性</span></div><div class="line">jQuery.extend = jQuery.fn.extend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; ... &#125;;</div><div class="line">jQuery.fn.extend( &#123;</div><div class="line">	<span class="attr">on</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, selector, data, fn </span>) </span>&#123; ... &#125;,</div><div class="line">	<span class="attr">one</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, selector, data, fn </span>) </span>&#123; ... &#125;,</div><div class="line">	<span class="attr">off</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> types, selector, fn </span>) </span>&#123; ... &#125; </div><div class="line">&#125;);</div><div class="line">jQuery.extend( &#123;</div><div class="line">	<span class="attr">attr</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, name, value </span>) </span>&#123; ... &#125;,</div><div class="line">	<span class="attr">removeAttr</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, value </span>) </span>&#123; ... &#125;</div><div class="line">&#125; );</div></pre></td></tr></table></figure></p>
<h3 id="extend方法实现解析"><a href="#extend方法实现解析" class="headerlink" title="extend方法实现解析"></a>extend方法实现解析</h3><p>extend方法将参数都合并到target中,用法是这种形式： $.extend(target,src1,src2,…)</p>
<ul>
<li>如果第一个参数是布尔值，target就是第二个参数</li>
<li>如果第一个参数不是布尔值，target就是第一个参数</li>
<li>如果只有一个参数，target就是jQuery本身</li>
<li>如果target不是object类型或者函数类型，target就是{}<br>扩展后返回的是target,所以如果不希望影响原有参数，可以设定一个空对象{}作为target,如$.extend({},src1,src2,…)或$.extend(true,{},src1,src2,…)<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">jQuery.extend = jQuery.fn.extend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> options, name, src, copy, copyIsArray, clone,</div><div class="line">		target = <span class="built_in">arguments</span>[ <span class="number">0</span> ] || &#123;&#125;,  i = <span class="number">1</span>, length = <span class="built_in">arguments</span>.length,deep =<span class="literal">false</span>;</div><div class="line">	<span class="comment">//如果第一个参数是一个布尔值，根据这个布尔值决定是否深拷贝</span></div><div class="line">	<span class="keyword">if</span> ( <span class="keyword">typeof</span> target === <span class="string">"boolean"</span> ) &#123; </div><div class="line">		deep = target;</div><div class="line">		<span class="comment">// 如果第一个参数是一个布尔值，第二个参数作为target</span></div><div class="line">		target = <span class="built_in">arguments</span>[ i ] || &#123;&#125;;</div><div class="line">		i++;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// 如果target不是对象也不是函数，则将&#123;&#125;作为target，并且这个非对象的target不会被合并</span></div><div class="line">	<span class="keyword">if</span> ( <span class="keyword">typeof</span> target !== <span class="string">"object"</span> &amp;&amp; !jQuery.isFunction( target ) ) &#123;</div><div class="line">		target = &#123;&#125;;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// target就是jQuery</span></div><div class="line">	<span class="keyword">if</span> ( i === length ) &#123;</div><div class="line">		target = <span class="keyword">this</span>;</div><div class="line">		i--;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> ( ; i &lt; length; i++ ) &#123;</div><div class="line">		<span class="comment">// 只处理非null 非undefined值</span></div><div class="line">		<span class="keyword">if</span> ( ( options = <span class="built_in">arguments</span>[ i ] ) != <span class="literal">null</span> ) &#123; </div><div class="line">			<span class="comment">// 合并每个参数对象的每一个属性</span></div><div class="line">			<span class="keyword">for</span> ( name <span class="keyword">in</span> options ) &#123;</div><div class="line">				src = target[ name ];</div><div class="line">				copy = options[ name ];</div><div class="line">				<span class="comment">// 已经合并的到target的就不再合并，如果要合并的参数中有相同的属性，但是属性值不同，会被覆盖</span></div><div class="line">				<span class="keyword">if</span> ( target === copy ) &#123;</div><div class="line">					<span class="keyword">continue</span>;</div><div class="line">				&#125;</div><div class="line">				<span class="comment">// 如果属性值是对象或者数组，并且deep为true,递归扩展，clone是子对象扩展的target</span></div><div class="line">				<span class="keyword">if</span> ( deep &amp;&amp; copy &amp;&amp; ( jQuery.isPlainObject( copy ) || ( copyIsArray = jQuery.isArray( copy ) ) ) ) &#123;</div><div class="line">					<span class="keyword">if</span> ( copyIsArray ) &#123;</div><div class="line">						copyIsArray = <span class="literal">false</span>;</div><div class="line">						clone = src &amp;&amp; jQuery.isArray( src ) ? src : [];</div><div class="line">					&#125; <span class="keyword">else</span> &#123;</div><div class="line">						clone = src &amp;&amp; jQuery.isPlainObject( src ) ? src : &#123;&#125;;</div><div class="line">					&#125;</div><div class="line">					<span class="comment">//子对象合并后的结果</span></div><div class="line">					target[ name ] = jQuery.extend( deep, clone, copy );</div><div class="line">				<span class="comment">// 如果属性值是undefined，不会合并到target中</span></div><div class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> ( copy !== <span class="literal">undefined</span> ) &#123;</div><div class="line">					target[ name ] = copy;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// 返回最终合并的结果</span></div><div class="line">	<span class="keyword">return</span> target;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="extend的用法"><a href="#extend的用法" class="headerlink" title="extend的用法"></a>extend的用法</h3><h4 id="如果有相同属性，且属性值都是对象"><a href="#如果有相同属性，且属性值都是对象" class="headerlink" title="如果有相同属性，且属性值都是对象"></a>如果有相同属性，且属性值都是对象</h4><p>var src1 = {name:”chang”,info:{age:24,sex:1,time:”2016”}};<br>var src2 = {name:”chen”,info:{age:26,sex:2,birth:”1945”}};</p>
<h5 id="子对象递归合并"><a href="#子对象递归合并" class="headerlink" title="子对象递归合并"></a>子对象递归合并</h5><p>$.extend(true,{},src1,src2);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Object</div><div class="line">	info: Object</div><div class="line">		age: 26</div><div class="line">		birth: &quot;1945&quot;</div><div class="line">		sex: 2</div><div class="line">		time: &quot;2016&quot;</div><div class="line">		__proto__: Object</div><div class="line">	name: &quot;chen&quot;</div><div class="line">	__proto__: Object</div></pre></td></tr></table></figure></p>
<h5 id="子对象后者属性值覆盖前者"><a href="#子对象后者属性值覆盖前者" class="headerlink" title="子对象后者属性值覆盖前者"></a>子对象后者属性值覆盖前者</h5><p>$.extend({},src1,src2); $.extend(false,{},src1,src2);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Object</div><div class="line">	info: Object</div><div class="line">		age: 26</div><div class="line">		birth: &quot;1945&quot;</div><div class="line">		sex: 2</div><div class="line">		__proto__: Object</div><div class="line">	name: &quot;chen&quot;</div><div class="line">	__proto__: Object</div></pre></td></tr></table></figure></p>
<h4 id="有相同属性，但是只有一个属性是对象的情况"><a href="#有相同属性，但是只有一个属性是对象的情况" class="headerlink" title="有相同属性，但是只有一个属性是对象的情况"></a>有相同属性，但是只有一个属性是对象的情况</h4><p>var src1 = {namee:”chang”,info:{age:24,sex:1,time:”2016”}};<br>var src2 = {namee:”chen”,info:1234};</p>
<h5 id="true-子对象info合并时不进行深度合并"><a href="#true-子对象info合并时不进行深度合并" class="headerlink" title="true + 子对象info合并时不进行深度合并"></a>true + 子对象info合并时不进行深度合并</h5><p>最后的src2合并时由于不是对象，所以不会进行深度合并，直接覆盖target中已有的info<br>$.extend(true,{},src1,src2);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Object &#123;namee: &quot;chen&quot;, info: 1234&#125;</div></pre></td></tr></table></figure></p>
<h5 id="true-子对象info合并时-target不是对象则不合并"><a href="#true-子对象info合并时-target不是对象则不合并" class="headerlink" title="true + 子对象info合并时,target不是对象则不合并"></a>true + 子对象info合并时,target不是对象则不合并</h5><p>子对象info合并时，是这样的，$.extend(true,1234,{age:24,sex:1,time:”2016”})<br>第一个合并参数不是对象，所有target是{}<br>$.extend(true,{},src2,src1)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Object</div><div class="line">	info: Object</div><div class="line">		age: 24</div><div class="line">		sex: 1</div><div class="line">		time: &quot;2016&quot;</div><div class="line">		__proto__: Object</div><div class="line">	namee: &quot;chang&quot;</div><div class="line">	__proto__: Object</div></pre></td></tr></table></figure></p>
<h4 id="合并到自身"><a href="#合并到自身" class="headerlink" title="合并到自身"></a>合并到自身</h4><p>$.extend(src1);<br>$.info;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Object &#123;age: 24, sex: 1, time: &quot;2016&quot;&#125;</div></pre></td></tr></table></figure></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://jquery.com/" target="_blank" rel="external">jquery官网</a></li>
<li><a href="https://github.com/jquery/jquery" target="_blank" rel="external">jquery GitHub</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> JQuery </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jQuery3.1.1源码 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[jQuery在动态生成的节点上绑定事件无效]]></title>
      <url>/Jquery%E5%9C%A8%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E7%9A%84DOM%E8%8A%82%E7%82%B9%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E6%97%A0%E6%95%88/</url>
      <content type="html"><![CDATA[<p>在有些情况下，需要在DOM节点存在之前就给这个节点绑定事件，在使用Jquery给尚不存在的dom节点绑定事件时发现并不起作用，事件并没有绑定在dom节点上，但也不报错。而使用原生的JavaScript绑定事件，如果绑定事件的DOM节点不存在，是会报错的。<br><a id="more"></a></p>
<h3 id="原生JS绑定事件"><a href="#原生JS绑定事件" class="headerlink" title="原生JS绑定事件"></a>原生JS绑定事件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> !<span class="attr">DOCTYPE</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>原生js绑定事件<span class="tag">&lt;/<span class="name">title</span>&gt;</span>	</div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"J_confirm"</span>&gt;</span>确定<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_content"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 动态生成dom节点 --&gt;</span></div><div class="line">			<span class="comment">&lt;!-- &lt;button id="J_jump"&gt;跳转&lt;/button&gt; --&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">			<span class="comment">// 已存在节点</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_confirm'</span>).onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">"J_confirm is clicked."</span>);</div><div class="line">			&#125;;</div><div class="line"></div><div class="line">			<span class="comment">// 在尚未生成的节点上绑定事件</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_jump'</span>).onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">"J_jump is clicked without event delegate using onclick."</span>);</div><div class="line">			&#125;;</div><div class="line"></div><div class="line">			<span class="comment">// 在尚未生成的节点上绑定事件</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_jump'</span>).addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			 	<span class="built_in">console</span>.log(<span class="string">"J_jump is clicked without event delegate using addEventListener."</span>);</div><div class="line">			&#125;);</div><div class="line"></div><div class="line">			<span class="comment">// 在事件绑定之后才生成节点</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_content'</span>).appendChild();</div><div class="line">			<span class="function"><span class="keyword">function</span> <span class="title">genNode</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="keyword">var</span> node = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</div><div class="line">				node.setAttribute(<span class="string">'id'</span>,<span class="string">'J_jump'</span>);</div><div class="line">				node.append(<span class="string">"跳转"</span>);</div><div class="line">				<span class="keyword">return</span> node;</div><div class="line">			&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>先给id为J_jump的dom节点绑定事件，然后再生成此节点，刷新页面就会报错，动态产生的跳转按钮也不会出现在页面上。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Uncaught TypeError: Cannot read property &apos;addEventListener&apos; of null</div><div class="line"></div><div class="line">Uncaught TypeError: Cannot set property &apos;onclick&apos; of null</div></pre></td></tr></table></figure>
<h3 id="JQuery绑定事件"><a href="#JQuery绑定事件" class="headerlink" title="JQuery绑定事件"></a>JQuery绑定事件</h3><p>而使用Jquery在未生成的节点上绑定事件，跳转按钮是会正常展示的，但是点击没有反应。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> !<span class="attr">DOCTYPE</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>动态生成的元素绑定事件<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"J_confirm"</span>&gt;</span>确定<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.0.0.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">			$(<span class="string">'#J_confirm'</span>).on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">"J_confirm is clicked."</span>);</div><div class="line">			&#125;);</div><div class="line">			$(<span class="string">'#J_jump'</span>).on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">"J_jump is clicked."</span>);</div><div class="line">			&#125;);</div><div class="line">			$(<span class="string">'#J_content'</span>).html(<span class="string">'&lt;button id="J_jump"&gt;跳转&lt;/button&gt;'</span>);</div><div class="line">		<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="原生JS事件委托"><a href="#原生JS事件委托" class="headerlink" title="原生JS事件委托"></a>原生JS事件委托</h3><p>可以通过事件代理解决这个问题，在使用原生的javascript绑定事件时，可以将事件绑定在确定会存在的祖先节点上，委托祖先节点处理事件.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> !<span class="attr">DOCTYPE</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>原生js绑定事件<span class="tag">&lt;/<span class="name">title</span>&gt;</span>	</div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"J_confirm"</span>&gt;</span>确定<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_content"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- &lt;button id="J_jump"&gt;跳转&lt;/button&gt; --&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 动态生成dom节点 --&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">			<span class="comment">// 已存在节点</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_confirm'</span>).onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">"J_confirm is clicked."</span>);</div><div class="line">			&#125;;</div><div class="line">			<span class="comment">// 事件委托</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_content'</span>).onclick=<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">				<span class="keyword">var</span> target = e.target;</div><div class="line">				<span class="built_in">console</span>.log(target.innerText + <span class="string">" is clicked with event delegate using onclick."</span>);</div><div class="line">			&#125;;</div><div class="line"></div><div class="line">			<span class="comment">// 事件委托</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_content'</span>).addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">			 	<span class="keyword">var</span> target = e.target;</div><div class="line">				<span class="built_in">console</span>.log(target.innerText + <span class="string">" is clicked with event delegate using addEventListener."</span>);</div><div class="line">			&#125;);</div><div class="line"></div><div class="line">			<span class="comment">// 在事件绑定之后才生成节点</span></div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_content'</span>).appendChild(genNode(<span class="string">"跳转1"</span>));</div><div class="line">			<span class="built_in">document</span>.getElementById(<span class="string">'J_content'</span>).appendChild(genNode(<span class="string">"跳转2"</span>));</div><div class="line">			<span class="function"><span class="keyword">function</span> <span class="title">genNode</span>(<span class="params">text</span>)</span>&#123;</div><div class="line">				<span class="keyword">var</span> node = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</div><div class="line">				node.setAttribute(<span class="string">'id'</span>,<span class="string">'J_jump'</span>);</div><div class="line">				node.append(text);</div><div class="line">				<span class="keyword">return</span> node;</div><div class="line">			&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">跳转1 is clicked with event delegate using onclick.</div><div class="line">跳转1 is clicked with event delegate using addEventListener.</div><div class="line">跳转2 is clicked with event delegate using onclick.</div><div class="line">跳转2 is clicked with event delegate using addEventListener.</div></pre></td></tr></table></figure></p>
<h3 id="JQuery事件委托"><a href="#JQuery事件委托" class="headerlink" title="JQuery事件委托"></a>JQuery事件委托</h3><p>在Jquery中还是可以用on方法实现事件代理。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> !<span class="attr">DOCTYPE</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>动态生成的元素绑定事件<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"J_confirm"</span>&gt;</span>确定<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"J_content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.0.0.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">			$(<span class="string">'#J_confirm'</span>).on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">"J_confirm is clicked."</span>);</div><div class="line">			&#125;);</div><div class="line">			$(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,<span class="string">'#J_jump1'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log($(<span class="keyword">this</span>).text() + <span class="string">" is clicked with event delegate."</span>);</div><div class="line">			&#125;);</div><div class="line">			$(<span class="string">'#J_content'</span>).on(<span class="string">'click'</span>,<span class="string">'#J_jump2'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">				<span class="built_in">console</span>.log($(<span class="keyword">this</span>).text() + <span class="string">" is clicked with event delegate."</span>);</div><div class="line">			&#125;);</div><div class="line">			$(<span class="string">'#J_content'</span>).append(<span class="string">'&lt;button id="J_jump1"&gt;跳转1&lt;/button&gt;'</span>);	</div><div class="line">			$(<span class="string">'#J_content'</span>).append(<span class="string">'&lt;button id="J_jump2"&gt;跳转2&lt;/button&gt;'</span>);</div><div class="line">		<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>所以，动态生成的节点上绑定事件无效，其实是如果事件在dom节点不存在时绑定，才会无效，对于动态生成的节点如果事件是在节点存在之后绑定的，是没有问题的。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://api.jquery.com/category/events/event-handler-attachment/" target="_blank" rel="external">JQuery Event Handler Attachment</a></li>
<li><a href="http://api.jquery.com/on/" target="_blank" rel="external">JQuery .on()</a></li>
<li><a href="http://jquery.cuishifeng.cn/index.html" target="_blank" rel="external">jQuery API </a></li>
<li><a href="http://www.jquery123.com/" target="_blank" rel="external">jQuery API 中文文档</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> JQuery </category>
            
        </categories>
        
        
        <tags>
            
            <tag> jQuery </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ECharts绘制图形，不同时间段区域颜色不同]]></title>
      <url>/ECharts%E7%BB%98%E5%88%B6%E5%9B%BE%E5%BD%A2%EF%BC%8C%E4%B8%8D%E5%90%8C%E6%97%B6%E9%97%B4%E6%AE%B5%E5%8C%BA%E5%9F%9F%E9%A2%9C%E8%89%B2%E4%B8%8D%E5%90%8C/</url>
      <content type="html"><![CDATA[<p>ECharts很强大，所以各种配置项和参数也超多，要想画出想要的效果，还真是一个细致活儿。在项目中使用echarts需要先 npm install echarts –save 或者直接下载js文件引入到项目中。<br>可以先在官网上用模拟数据调试好配置项，然后把options直接copy到项目里，刚开始不知道可以在官网上调试，耽误了好多时间。<br>这次画的曲线有一个特点：有促销和无促销的面积区域需要用颜色区分，有促销：橙色，无促销：灰色。</p>
<div align="center"><br><img src="../images/echarts/销售量曲线图.png" width="400"><br></div>

<a id="more"></a>
<h3 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h3><p><img src="../images/echarts/QQ20161210-1@2x.png" width="400"></p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>下面是在ECharts调试的代码，也可以到<a href="http://gallery.echartsjs.com/editor.html?c=xHJpzlHKQe查看" target="_blank" rel="external">http://gallery.echartsjs.com/editor.html?c=xHJpzlHKQe查看</a></p>
<ul>
<li>按照时间顺序和每天的状态status，将数据分割成多个series,每个series设置不同的areaStyle和itemStyle。</li>
<li>图例的颜色会与itemStyle.normal.color的颜色相同，例如这里有两个图例legend：有促销和无促销，它们的颜色对应series中有相同name的itemStyle.normal.color。</li>
<li>所以如果itemStyle.normal.color要求都是蓝色，图例就不能按需求展示有促销为橙色，无促销为灰色，而是展示的itemStyle.normal.color。</li>
<li>所以其实项目中的图例是我自己画的，并不是用的echarts的legend属性<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 数据 status为0表示这一天无促销，为1表示有促销</span></div><div class="line"><span class="keyword">var</span> effectDTOList = [</div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-10-30"</span>, <span class="string">"salesCnt"</span>: <span class="number">22</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-10-31"</span>, <span class="string">"salesCnt"</span>: <span class="number">27</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-01"</span>, <span class="string">"salesCnt"</span>: <span class="number">44</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-02"</span>, <span class="string">"salesCnt"</span>: <span class="number">64</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-03"</span>, <span class="string">"salesCnt"</span>: <span class="number">77</span>, <span class="string">"status"</span>: <span class="number">1</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-04"</span>, <span class="string">"salesCnt"</span>: <span class="number">99</span>, <span class="string">"status"</span>: <span class="number">1</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-05"</span>, <span class="string">"salesCnt"</span>: <span class="number">102</span>, <span class="string">"status"</span>: <span class="number">1</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-06"</span>, <span class="string">"salesCnt"</span>: <span class="number">116</span>, <span class="string">"status"</span>: <span class="number">1</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-07"</span>, <span class="string">"salesCnt"</span>: <span class="number">99</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-08"</span>, <span class="string">"salesCnt"</span>: <span class="number">77</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-09"</span>, <span class="string">"salesCnt"</span>: <span class="number">64</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;, </div><div class="line">    &#123; <span class="string">"date"</span>: <span class="string">"2016-11-10"</span>, <span class="string">"salesCnt"</span>: <span class="number">70</span>, <span class="string">"status"</span>: <span class="number">0</span> &#125;</div><div class="line">    ];</div><div class="line"><span class="comment">//准备数据源和配置项</span></div><div class="line"><span class="keyword">var</span> xAxis = [], <span class="comment">//x轴数据</span></div><div class="line">    yAxis = [], <span class="comment">//y轴数据</span></div><div class="line">    data = [],  <span class="comment">//每个系列（series）图表数据，是个二维数组</span></div><div class="line">    series = [], </div><div class="line">    seriesItem;</div><div class="line"><span class="keyword">var</span> st = effectDTOList[<span class="number">0</span>].status;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; effectDTOList.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> date = effectDTOList[i].date.substring(<span class="number">5</span>);</div><div class="line">    xAxis.push(date);</div><div class="line">    yAxis.push(effectDTOList[i].salesCnt);</div><div class="line">    data.push([date, effectDTOList[i].salesCnt]);</div><div class="line">    <span class="keyword">if</span> (st != effectDTOList[i].status || (i == effectDTOList.length - <span class="number">1</span>)) &#123;</div><div class="line">        <span class="keyword">var</span> color = st == <span class="number">1</span> ? <span class="string">'#ff8c66'</span> : <span class="string">"#e2e2e2"</span>;</div><div class="line">        <span class="keyword">var</span> name1 = st == <span class="number">1</span> ? <span class="string">'有促销'</span> : <span class="string">"无促销"</span>;</div><div class="line">        seriesItem = &#123;</div><div class="line">            <span class="attr">name</span>: name1,</div><div class="line">            <span class="attr">type</span>: <span class="string">'line'</span>,</div><div class="line">            <span class="attr">smooth</span>: <span class="literal">true</span>,</div><div class="line">            <span class="attr">symbolSize</span>: <span class="number">7</span>, <span class="comment">//转折点的大小</span></div><div class="line">            data: data,</div><div class="line">            <span class="attr">areaStyle</span>: &#123;</div><div class="line">                <span class="attr">normal</span>: &#123;</div><div class="line">                    <span class="attr">color</span>: color,</div><div class="line">                    <span class="attr">opacity</span>: <span class="number">1</span></div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">lineStyle</span>: &#123; <span class="comment">//曲线样式</span></div><div class="line">                normal: &#123;</div><div class="line">                    <span class="attr">color</span>: <span class="string">'#ff8c66'</span></div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">itemStyle</span>: &#123; <span class="comment">//转折点的样式</span></div><div class="line">                normal: &#123;</div><div class="line">                    <span class="attr">color</span>: color,</div><div class="line">                    <span class="attr">borderWidth</span>: <span class="number">2</span>,</div><div class="line">                    <span class="attr">borderType</span>: <span class="string">'solid'</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        series.push(seriesItem);</div><div class="line">        data = [</div><div class="line">            [date, effectDTOList[i].salesCnt]</div><div class="line">        ];</div><div class="line">        st = effectDTOList[i].status;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//配置项</span></div><div class="line">option = &#123;</div><div class="line">    <span class="attr">grid</span>: &#123;</div><div class="line">        <span class="attr">left</span>: <span class="string">'3%'</span>,</div><div class="line">        <span class="attr">right</span>: <span class="string">'4%'</span>,</div><div class="line">        <span class="attr">bottom</span>: <span class="string">'3%'</span>,</div><div class="line">        <span class="attr">containLabel</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">title</span>: &#123;</div><div class="line">        <span class="attr">text</span>: <span class="string">'销售量曲线图'</span>,</div><div class="line">        <span class="attr">subtext</span>: <span class="string">'不同时间段面积标记不同颜色'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">legend</span>: &#123;</div><div class="line">        <span class="attr">right</span>: <span class="number">50</span>,</div><div class="line">        <span class="attr">top</span>: <span class="number">20</span>,</div><div class="line">        <span class="attr">data</span>: [&#123;</div><div class="line">                <span class="attr">name</span>: <span class="string">'无促销'</span>,</div><div class="line">                <span class="attr">icon</span>: <span class="string">'circle'</span>,</div><div class="line">                <span class="attr">textStyle</span>: &#123;</div><div class="line">                    <span class="attr">color</span>: <span class="string">'#333'</span>,</div><div class="line">                    <span class="attr">fontSize</span>: <span class="string">'14'</span></div><div class="line">                &#125;</div><div class="line">            &#125;, &#123;</div><div class="line">                <span class="attr">name</span>: <span class="string">'有促销'</span>,</div><div class="line">                <span class="attr">icon</span>: <span class="string">'circle'</span>,</div><div class="line">                <span class="attr">textStyle</span>: &#123;</div><div class="line">                    <span class="attr">color</span>: <span class="string">'#333'</span>,</div><div class="line">                    <span class="attr">fontSize</span>: <span class="string">'14'</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">//工具栏</span></div><div class="line">    toolbox: &#123;  </div><div class="line">        <span class="attr">feature</span>: &#123;</div><div class="line">            <span class="attr">saveAsImage</span>: &#123;&#125;  <span class="comment">//下载图片</span></div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">//缩放配置</span></div><div class="line">    dataZoom: [&#123;</div><div class="line">        <span class="attr">type</span>: <span class="string">'inside'</span>, <span class="comment">//内嵌缩放，如鼠标滚轮滚动、两指滑动</span></div><div class="line">        xAxisIndex: [<span class="number">0</span>] <span class="comment">//x轴可缩放</span></div><div class="line">    &#125;],</div><div class="line">    <span class="attr">tooltip</span>: &#123;</div><div class="line">        <span class="attr">trigger</span>: <span class="string">'axis'</span>,</div><div class="line">        <span class="attr">formatter</span>: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (params[i].value) &#123;</div><div class="line">                    <span class="keyword">return</span> params[i].value[<span class="number">1</span>];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="string">'loading'</span>;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">backgroundColor</span>: <span class="string">'#ff6633'</span>,</div><div class="line">        <span class="attr">padding</span>: [<span class="number">10</span>],</div><div class="line">        <span class="attr">axisPointer</span>: &#123;</div><div class="line">            <span class="attr">lineStyle</span>: &#123;</div><div class="line">                <span class="attr">color</span>: <span class="string">'#ddd'</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">xAxis</span>: &#123;</div><div class="line">        <span class="attr">axisTick</span>: &#123;</div><div class="line">            <span class="attr">show</span>: <span class="literal">true</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">type</span>: <span class="string">'category'</span>,</div><div class="line">        <span class="attr">boundaryGap</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">data</span>: xAxis,</div><div class="line">        <span class="attr">axisLine</span>: &#123;</div><div class="line">            <span class="attr">lineStyle</span>: &#123;</div><div class="line">                <span class="attr">color</span>: <span class="string">'#ddd'</span></div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">axisLabel</span>: &#123;</div><div class="line">            <span class="attr">textStyle</span>: &#123;</div><div class="line">                <span class="attr">color</span>: <span class="string">'#333'</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">yAxis</span>: &#123;</div><div class="line">        <span class="attr">axisTick</span>: &#123;</div><div class="line">            <span class="attr">show</span>: <span class="literal">false</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">type</span>: <span class="string">'value'</span>,</div><div class="line">        <span class="attr">axisLine</span>: &#123;</div><div class="line">            <span class="attr">show</span>: <span class="literal">false</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">splitLine</span>: &#123;</div><div class="line">            <span class="attr">lineStyle</span>: &#123;</div><div class="line">                <span class="attr">color</span>: <span class="string">'#ddd'</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">series</span>: series</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><p><a href="http://echarts.baidu.com/tutorial.html" target="_blank" rel="external">ECharts官网</a></p>
</li>
<li><p><a href="https://github.com/ecomfe/echarts" target="_blank" rel="external">ECharts GitHub</a></p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工作 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ECharts </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[小桔子]]></title>
      <url>/%E5%B0%8F%E6%A1%94%E5%AD%90/</url>
      <content type="html"><![CDATA[<p>最近有点忙晕，周末来公司坐坐。<br>平时的周末，一般都是待在家里。<br>早上起床，跟室友聊聊天，吃个饭，看个视频，看看书，睡个觉，一天就这么过去了。<br>偶尔出来，也能发现一些小惊喜。<br>要不，以后都记录下来吧~~<br><a id="more"></a><br>同组的姑娘，周末也来了公司，给了一个小桔子。<br>一眼就被萌到了，长得太萌，一个小桔子吃了半个小时。。<br>怎么连桔子都这么美丽@^@<br><img src="/images/life/2016121018113.jpg" class="full-image"><br><img src="/images/life/2016121018112.jpg" class="full-image"><br><img src="/images/life/2016121018111.jpg" class="full-image"></p>
]]></content>
      
        <categories>
            
            <category> 日常 </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript事件]]></title>
      <url>/JavaScript%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/</url>
      <content type="html"><![CDATA[<p>在web浏览器中操作页面时，会发生各种不同的事件，比如光标停留，鼠标点击。我们可以使用javascript应用程序关注特定类型的事件，并注册当事件发生时要调用的函数,即事件处理器。<br>事件有几个重要的概念：这几个概念：</p>
<ul>
<li>事件类型 event type</li>
<li>事件目标 event target</li>
<li>事件处理程序（event handler）或 事件监听程序（event listener）</li>
<li>事件对象：与特定事件相关的，包含该事件详细信息的对象，作为参数传递给事件处理函数。<a id="more"></a>
</li>
</ul>
<h3 id="事件注册和移除"><a href="#事件注册和移除" class="headerlink" title="事件注册和移除"></a>事件注册和移除</h3><h4 id="设置事件目标的onxxx属性"><a href="#设置事件目标的onxxx属性" class="headerlink" title="设置事件目标的onxxx属性"></a>设置事件目标的onxxx属性</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onclick</span>=<span class="string">"clickHandler()"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"2017，你好。"</span>);</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id0"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).onclick = <span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2017，你好。"</span>);</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这种设置事件处理程序属性的方法适用于所有浏览器的所有常用事件类型，但是对于每个事件目标的每个事件类型最多只有一个处理程序，如果给某一个事件目标的某一个事件类型绑定多个事件处理程序，后面的事件处理程序会覆盖前面的，就是说只会执行最后一个事件处理函数。<br>例如下面的元素id0绑定了两个click事件函数，点击后控制台只会输出 【2016，再见。】<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id0"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).onclick = <span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2017，你好。"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).onclick = <span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2016，再见。"</span>);</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>设置属性的方法注册事件，那移除事件自然是移除onxxx方法。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).removeAttribute(<span class="string">"onclick"</span>);</div></pre></td></tr></table></figure></p>
<h4 id="addEventListener-eventType-eventHandler-boolean-方法"><a href="#addEventListener-eventType-eventHandler-boolean-方法" class="headerlink" title="addEventListener(eventType,eventHandler,boolean)方法"></a>addEventListener(eventType,eventHandler,boolean)方法</h4><ul>
<li>第一个参数 eventType 注册处理程序的事件类型</li>
<li>第二个参数 eventHandler 事件处理函数</li>
<li>第三个参数 boolean  是一个布尔值，表示是否注册为事件捕获处理函数，默认是false</li>
</ul>
<p><strong>注：</strong>addEventListener的更多用法参见 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener" target="_blank" rel="external">MDN &gt; Web 技术文档 &gt; Web API 接口 &gt; EventTarget &gt; EventTarget.addEventListener()</a><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id0"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2017，你好。"</span>);</div><div class="line">    &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>addEventListener方法在IE9之前的IE浏览器版本不支持，使用的方法是attachEvent()。<br>使用addEventListener可以对同一事件目标的同一事件类型绑定多个处理函数并且一次执行。控制台输出：<br>2017，你好。<br>2016，再见。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id0"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2017，你好。"</span>);</div><div class="line">    &#125;);</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2016，再见。"</span>);</div><div class="line">    &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>并且不会修改或影响其他方式注册的事件处理程序，如下还是会打印两条信息<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id0"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2016，再见。"</span>);</div><div class="line">    &#125;);</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).onclick = <span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2017，你好。"</span>);</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>如果使用相同的参数在同一对象上调用，只会注册一次处理程序。如下只会打印一条信息。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id0"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).addEventListener(<span class="string">"click"</span>,clickHandler);</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"id0"</span>).addEventListener(<span class="string">"click"</span>,clickHandler);</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"2016，再见。"</span>);</div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>与addEventListener注册事件对应的移除事件的方法是removeEventListener方法，参数与addEventListener方法相同。<br>可见，使用addEventListener可以将事件注册为两种，默认都是冒泡事件处理程序</p>
<ul>
<li>冒泡事件处理程序 在冒泡阶段调用</li>
<li>捕获事件处理程序 在捕获阶段调用</li>
</ul>
<h4 id="IE浏览器中的attachEvent和detachEvent方法"><a href="#IE浏览器中的attachEvent和detachEvent方法" class="headerlink" title="IE浏览器中的attachEvent和detachEvent方法"></a>IE浏览器中的attachEvent和detachEvent方法</h4><p>IE5 ~ IE8 这些版本支持attachEvent和detachEvent方法，与addEventListener和removeEventListener方法类似。但也有几点不同：</p>
<ul>
<li>只接收两个参数，这也说明IE9版本之前的IE浏览器不支持事件捕获。</li>
<li>第一个参数事件类型带前缀‘on’</li>
<li>如果使用相同的参数在同一对象上调用，调用次数和注册次数相同。而且调用顺序可能和注册顺序不同。</li>
</ul>
<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><p>调用事件处理程序时，会向其传入一个参数：事件对象event,但在IE8及以前的IE版本中不会传入，需要通过window.event获取事件对象 ,所以获取对象时可以这样写: event || window.event</p>
<h3 id="事件传播"><a href="#事件传播" class="headerlink" title="事件传播"></a>事件传播</h3><p>如果事件对象是文档或者文档元素，大部分事件会冒泡到DOM树根，再到document对象，再到window对象。有几种特例：</p>
<ul>
<li>focus、blur、srcoll事件不会冒泡；</li>
<li>还有load事件会冒泡到document对象停止，不再冒泡到window对象</li>
</ul>
<p><strong>事件传播的三个阶段：</strong></p>
<ul>
<li>事件捕获阶段<br>  依次调用 window对象的捕获处理程序 》 document对象的捕获处理程序 》 body对象的捕获处理程序 》 …（DOM树这条路径上的捕获处理程序）… 》 事件目标父元素的捕获处理程序</li>
<li>目标阶段<br>会触发目标对象上的所有监听器,不管是冒泡还是捕获事件处理程序</li>
<li>事件冒泡阶段  与捕获阶段的调用顺序相反，但调用的是这条路径上注册的冒泡处理程序<br>注： 事件捕获在IE9之前的IE中无法使用，一般用在程序调试或事件取消技术中。</li>
</ul>
<p><strong>阻止事件传播:</strong></p>
<ul>
<li>event.stopPropagation()<br>  IE9之前的IE不支持<br>  阻止事件在其他对象上的传播，在事件目标上的其他事件程序仍然会被调用<br>  适用于捕获阶段、目标对象本身、冒泡阶段</li>
<li>event.stopImmediatePropagation()<br>  部分浏览器支持<br>  阻止事件在其他对象上的传播，在事件目标上的其他事件程序也会被阻止调用<br>  适用于捕获阶段、目标对象本身、冒泡阶段<br>  jquery、YUI提供跨浏览器的stopImmediatePropagation()方法</li>
<li>event.cancelBubble = true<br>  IE的事件对象提供<br>  阻止事件在其他对象上的传播<br>  适用于目标对象本身、冒泡阶段</li>
</ul>
<h3 id="事件代理"><a href="#事件代理" class="headerlink" title="事件代理"></a>事件代理</h3><p>利用事件冒泡可以实现事件代理，在目标元素的祖先元素上注册事件处理程序，并可以通过事件对象的event.target || event.srcElement获取目标对象。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li>Javascript权威指南(第六版) 第17章 事件处理</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document_Object_Model/Events" target="_blank" rel="external">MDN &gt; Web 技术文档 &gt; Web API 接口 &gt; 文档对象模型 (DOM) &gt; 事件及DOM</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener" target="_blank" rel="external">MDN &gt; Web 技术文档 &gt; Web API 接口 &gt; EventTarget<br>EventTarget.addEventListener()</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> JavaScript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[前端构建工具Gulp]]></title>
      <url>/%E5%89%8D%E7%AB%AF%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7Gulp/</url>
      <content type="html"><![CDATA[<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>全局安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp -g</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>项目开发安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp -dev --save</div></pre></td></tr></table></figure>
<p>插件安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-concat gulp-minify-html gulp-minify-css gulp-rename  -dev --save</div></pre></td></tr></table></figure>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>在项目根目录下需要创建一个名为gulpfile.js的文件,例如</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp       = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> minifyHTML = <span class="built_in">require</span>(<span class="string">'gulp-minify-html'</span>);</div><div class="line"><span class="keyword">var</span> concat     = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</div><div class="line"><span class="keyword">var</span> minifyCSS  = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);</div><div class="line"><span class="keyword">var</span> rename     = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>);</div><div class="line"><span class="keyword">var</span> minifyJS   = <span class="built_in">require</span>(<span class="string">'gulp-jsmin'</span>);</div><div class="line"><span class="keyword">var</span> babel      = <span class="built_in">require</span>(<span class="string">'gulp-babel'</span>);</div><div class="line"><span class="keyword">var</span> connect    = <span class="built_in">require</span>(<span class="string">'gulp-connect'</span>);</div><div class="line"><span class="keyword">var</span> open       = <span class="built_in">require</span>(<span class="string">'gulp-open'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(<span class="string">'./src/html/*.html'</span>)</div><div class="line">        .pipe(minifyHTML())</div><div class="line">        .pipe(gulp.dest(<span class="string">'./'</span>))</div><div class="line">        .pipe(connect.reload())</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'css'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(<span class="string">'./src/css/*.css'</span>)</div><div class="line">        .pipe(concat(<span class="string">'style.css'</span>))</div><div class="line">        .pipe((minifyCSS()))</div><div class="line">        .pipe(rename(&#123; <span class="attr">suffix</span> : <span class="string">'.min'</span>&#125;))</div><div class="line">        .pipe(gulp.dest(<span class="string">'./assets/'</span>))</div><div class="line">        .pipe(connect.reload())</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'js'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(<span class="string">'./src/js/*.js'</span>)</div><div class="line">        .pipe(concat(<span class="string">'main.js'</span>))</div><div class="line">        .pipe(rename(&#123; <span class="attr">suffix</span> : <span class="string">'.min'</span>&#125;))</div><div class="line">        .pipe(gulp.dest(<span class="string">'./assets/'</span>))</div><div class="line">        .pipe(connect.reload())</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'babel'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(<span class="string">'./src/exercise/**/*.js'</span>)</div><div class="line">        .pipe(babel())</div><div class="line">        .pipe(gulp.dest(<span class="string">'./exercise/'</span>))</div><div class="line">        .pipe(connect.reload())</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'watch'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.watch(<span class="string">'./src/html/*.html'</span>,[<span class="string">'html'</span>]);</div><div class="line">    gulp.watch(<span class="string">'./src/css/*.css'</span>,[<span class="string">'css'</span>]);</div><div class="line">    gulp.watch(<span class="string">'./src/js/*.js'</span>,[<span class="string">'js'</span>]);</div><div class="line">    gulp.watch(<span class="string">'./src/exercise/**/*.js'</span>,[<span class="string">'babel'</span>]);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'connect'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    connect.server(&#123;</div><div class="line">        <span class="attr">root</span>:<span class="string">'./'</span>,</div><div class="line">        <span class="attr">ip</span>:<span class="string">'127.0.0.0'</span>,</div><div class="line">        <span class="attr">port</span>:<span class="string">'2000'</span>,</div><div class="line">        <span class="attr">livereload</span>:<span class="literal">true</span></div><div class="line">    &#125;)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'html'</span>,<span class="string">'css'</span>,<span class="string">'js'</span>,<span class="string">'babel'</span>,<span class="string">'watch'</span>,<span class="string">'connect'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(__filename)</div><div class="line">        .pipe(open(&#123;<span class="attr">uri</span>:<span class="string">'http://localhost:2000'</span>&#125;))</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><h4 id="gulp-src-globs"><a href="#gulp-src-globs" class="headerlink" title="gulp.src(globs)"></a>gulp.src(globs)</h4><p>输出符合glob匹配模式的文件，返回Vinyl files的stream,可以pipe到别的文件或插件中。</p>
<h4 id="gulp-dest-path"><a href="#gulp-dest-path" class="headerlink" title="gulp.dest(path)"></a>gulp.dest(path)</h4><p>stream能被pipe进来写入一个文件，文件的上级路径在path下，path下文件的路径根据base路径和相对于base的路径计算，如果文件夹不存在会自动创建。</p>
<h4 id="gulp-task-name-function"><a href="#gulp-task-name-function" class="headerlink" title="gulp.task(name,function)"></a>gulp.task(name,function)</h4><p>定义一个任务，接收两个参数。第一个参数是任务的名字，第二个参数是要做的事情。如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    gulp.src(<span class="string">'./src/html/*.html'</span>)</div><div class="line">        .pipe(minifyHTML())</div><div class="line">        .pipe(gulp.dest(<span class="string">'./'</span>))</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>任务的名字叫html,要做的事情就是把./src/html/目录下已.html结尾的文件进行压缩后，放到./目录下。<br>如果要执行多个任务，可以这样定义：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'dev'</span>,[<span class="string">'html'</span>,<span class="string">'css'</span>,<span class="string">'js'</span>,<span class="string">'babel'</span>,<span class="string">'watch'</span>]，<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</div></pre></td></tr></table></figure>
<p>任务dev就是执行任务html，css，js，babel，watch<br>css，js，babel，watch都要像任务html一样被定义</p>
<p>默认情况下，这些task会以最大的并发数执行</p>
<h4 id="gulp-watch-glob-tasks"><a href="#gulp-watch-glob-tasks" class="headerlink" title="gulp.watch(glob,tasks)"></a>gulp.watch(glob,tasks)</h4><p>监听文件，当文件改动时，做一些事情。</p>
<h3 id="常用插件"><a href="#常用插件" class="headerlink" title="常用插件"></a>常用插件</h3><ul>
<li><a href="https://github.com/stevelacy/gulp-open" target="_blank" rel="external">gulp-open</a>    –打开一个文件</li>
<li><a href="https://github.com/hparra/gulp-rename" target="_blank" rel="external">gulp-rename</a>  –重命名文件</li>
<li><a href="https://github.com/lazd/gulp-replace" target="_blank" rel="external">gulp-replace</a> –替换路径</li>
<li><a href="https://github.com/robrich/gulp-rimraf" target="_blank" rel="external">gulp-rimraf</a> –删除目录</li>
<li><a href="https://github.com/sanfords/gulp-minify-html" target="_blank" rel="external">gulp-minify-html</a> –压缩html文件</li>
<li><a href="https://github.com/nfroidure/gulp-minify-css" target="_blank" rel="external">gulp-minify-css</a> –压缩css文件</li>
<li><a href="https://github.com/chilijung/gulp-jsmin" target="_blank" rel="external">gulp-jsmin</a> –压缩js文件</li>
<li><a href="https://github.com/terinjokes/gulp-uglify" target="_blank" rel="external">gulp-uglify</a> –压缩javascript文件</li>
<li><a href="https://github.com/contra/gulp-concat" target="_blank" rel="external">gulp-concat</a>  –合并文件</li>
<li><a href="https://github.com/babel/gulp-babel" target="_blank" rel="external">gulp-babel</a> –把es6编译成es5</li>
<li><a href="https://github.com/plus3network/gulp-less" target="_blank" rel="external">gulp-less</a> –将less文件编译成css文件</li>
<li><a href="https://github.com/gulpjs/gulp-util" target="_blank" rel="external">gulp-util</a> –gulp插件的工具方法</li>
</ul>
<h3 id="Gulp插件开发"><a href="#Gulp插件开发" class="headerlink" title="Gulp插件开发"></a>Gulp插件开发</h3><p>待研究。。。</p>
]]></content>
      
        <categories>
            
            <category> 前端构建 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Gulp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Prism 轻量级代码语法高亮库]]></title>
      <url>/Prism%E8%BD%BB%E9%87%8F%E7%BA%A7%E4%BB%A3%E7%A0%81%E8%AF%AD%E6%B3%95%E9%AB%98%E4%BA%AE%E5%BA%93/</url>
      <content type="html"><![CDATA[<p>Prism是一个轻量的、可扩展的代码语法高亮库，根据现代web标准设计。目前有很多网站在用，JavaScript的创始人Brendan Eich的个人博客也是用的Prism。Prism支持很多种语言，并且扩展性很好，它要求代码放在code标签下，code标签可包含在pre标签内。下面是多种写法下的显示效果。</p>
<p><img src="/images/prism/QQ20161123-1@2x.png" alt=""><br><a id="more"></a><br>Prism支持多种代码高亮风格，多种语言，并且可以添加插件来丰富Prism的功能。只需要在HTML中引入prism.js和prism.css。</p>
<p>在<a href="http://prismjs.com/" target="_blank" rel="external">Prism官网</a>点击下载，依次选择：</p>
<ul>
<li>是否压缩</li>
<li>选主题，代码风格这里用的okaidia</li>
<li>选语言，按需选择，选择语言越多文件越大</li>
<li>选插件，在prism.js中可以看到每个插件都对应一个立即执行的函数</li>
</ul>
<p>下载prism.js文件和prism.css文件，引入html文件中<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"./prism.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"language-markup"</span> <span class="attr">id</span>=<span class="string">"different-markup"</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!--这种写法需要插件File Highlight支持--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">pre</span> <span class="attr">data-src</span>=<span class="string">"./test.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">pre</span> <span class="attr">class</span>=<span class="string">"language-css"</span>&gt;</span><span class="tag">&lt;<span class="name">code</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">pre</span> <span class="attr">class</span>=<span class="string">"language-css"</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">"language-*"</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!--pre和code标签之间有空格ode标签之间，展示出来的效果可以看到代码与边框上下左右间隔不均匀--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">pre</span> <span class="attr">class</span>=<span class="string">"language-css"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">"language-css"</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">code</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">"language-css"</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- No language, should inherit .language-markup --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">"language-css"</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- 没有设置language,会继承父节点的class .language-markup --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">"language-*"</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- 没有高亮 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">"language-none"</span>&gt;</span>p &#123; color: red; &#125;<span class="tag">&lt;/<span class="name">code</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./prism.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>搞定~~</p>
<p>相关    </p>
<ul>
<li><a href="https://github.com/PrismLibrary" target="_blank" rel="external">Prism GitHub</a></li>
<li><a href="http://prismjs.com/" target="_blank" rel="external">Prism官网</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 语法高亮 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[NexT主题中vendors目录下资源找不到报404]]></title>
      <url>/hexo-theme-next%E4%B8%BB%E9%A2%98vendors%E7%9B%AE%E5%BD%95%E4%B8%8B%E8%B5%84%E6%BA%90%E6%89%BE%E4%B8%8D%E5%88%B0/</url>
      <content type="html"><![CDATA[<p>昨天发了一篇新文章，部署之后博客都打不开了，两个站点控制台都抛红,NexT主题的source目录下有一个vendors目录，这个目录下的资源文件都无法加载，这是因为github和coding都升级了Jekyll的版本，新版本会忽略vendors文件，github在<a href="https://github.com/blog/2277-what-s-new-in-github-pages-with-jekyll-3-3" target="_blank" rel="external">What’s new in GitHub Pages with Jekyll 3.3</a>中给了解释和解决办法。</p>
<p> to make it easier to vendor third-party dependencies via package managers     like Bundler or NPM (or Yarn), Jekyll now ignores the vendor and node_modules directories by default, speeding up build times and avoiding potential errors. If you need those directories included in your site, set exclude: [] in your site’s configuration file.</p>
<a id="more"></a>
<p><img src="/images/vendors404/QQ20161110-1@2x.png" alt=""><br>这里有几个解决办法</p>
<ul>
<li>把vendors全部手动替换成lib</li>
<li>重新clone主题，NeXT的作者已经修复了这个问题，但是重新clone需要重新设置</li>
<li>项目根目录下新建一个 .nojekyll 隐藏文件 ，内容为!vendor/*</li>
</ul>
<p>参考：</p>
<ul>
<li><a href="https://github.com/blog/2277-what-s-new-in-github-pages-with-jekyll-3-3" target="_blank" rel="external">What’s new in GitHub Pages with Jekyll 3.3</a></li>
<li><a href="https://github.com/hexojs/hexo/issues/2238" target="_blank" rel="external">关于vendors文件夹里面的js文件和css文件404</a></li>
<li><a href="https://github.com/iissnan/hexo-theme-next/issues/1214" target="_blank" rel="external">Hexo本地预览没问题 deploy后主页空白</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 静态博客 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Jekyll </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hexo博客迁移至GitCafe(Coding)的Pages服务]]></title>
      <url>/Hexo%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB%E8%87%B3GitCafe%E7%9A%84Pages%E6%9C%8D%E5%8A%A1/</url>
      <content type="html"><![CDATA[<p>这个博客之前是挂在GitHub的Pages空间，这两天发现访问博客的速度好慢啊。啊不对，是一直都很慢，这两天是完全打不开了。。。找了找能优化访问速度的办法，最后决定在GitCafe上也部署一个。GitCafe是国内版的GitHub，有了它访问速度真的快好多。国内的支持部署静态博客的代码托管仓库还有Coding，不过打开<a href="https://coding.net/gitcafe.html" target="_blank" rel="external">GitCafe官网</a>发现，它已经被<a href="https://coding.net/" target="_blank" rel="external">Coding</a>收购了。。。<br><img src="/images/ToGitCafe/QQ20161109-2@2x.png" class="full-image"><br><a id="more"></a></p>
<h3 id="迁移步骤"><a href="#迁移步骤" class="headerlink" title="迁移步骤"></a>迁移步骤</h3><h4 id="注册Coding账号"><a href="#注册Coding账号" class="headerlink" title="注册Coding账号"></a>注册Coding账号</h4><p>用户名要想好，因为无法更改，而且博客的项目名称要跟用户名一致，作为博客网址的一部分。<br>比如用户名是chang20159,项目名是chang20159，博客网址就是<a href="http://chang20159.coding.me/" target="_blank" rel="external">http://chang20159.coding.me/</a><br><img src="/images/ToGitCafe/QQ20161109-3@2x.png" class="full-image"></p>
<h4 id="创建项目并开启Pages服务"><a href="#创建项目并开启Pages服务" class="headerlink" title="创建项目并开启Pages服务"></a>创建项目并开启Pages服务</h4><p>新建项目很简单，注意项目名最好与用户名一直，至于为什么我也不知道，没研究。。<br>进入项目，在Pages服务中开启Pages服务，并设置分支为master,因为你的项目开发分支是master。<br>这个与你要发布的分支名一直就可以。<br><img src="/images/ToGitCafe/QQ20161109-6@2x.png" class="full-image"><br>如果有自己的域名的话，可以将它的cname指向博客地址，并在开启Pages服务后绑定到自己的域名。   <img src="/images/ToGitCafe/QQ20161109-7@2x.png" class="full-image"></p>
<h4 id="编辑Hexo配置文件-config-yml"><a href="#编辑Hexo配置文件-config-yml" class="headerlink" title="编辑Hexo配置文件_config.yml"></a>编辑Hexo配置文件_config.yml</h4><p>这个跟部署到GitHub是一样的，加上在coding.net上刚创建项目的仓库地址。</p>
<pre><code>deploy:
  type: git
  repo: 
     github: git@github.com:chang20159/chang20159.github.io.git
     coding: git@git.coding.net:chang20159/chang20159.git
  branch: master
</code></pre><h4 id="配置SSH"><a href="#配置SSH" class="headerlink" title="配置SSH"></a>配置SSH</h4><p>如果之前生成过ssh,可以直接使用，存放在~/.ssh/id_rsa.pub这个目录下。<br>打开个人设置-SSH公钥，把id_rsa.pub这个文件里的内容粘贴上去，点击添加就可以了。<br>这一步不做的话，在hexo deploy的时候会提示没有权限，无法部署的。<br><img src="/images/ToGitCafe/QQ20161109-4@2x.png" class="full-image"></p>
<h4 id="添加Staticfile文件"><a href="#添加Staticfile文件" class="headerlink" title="添加Staticfile文件"></a>添加Staticfile文件</h4><p>最后需要在source/目录下放置一个名为Staticfile的文件，coding.net需要这个文件来作为以静态文件部署的标志。如果没有这个文件，打开<a href="http://chang20159.coding.me/就会看到**404" target="_blank" rel="external">http://chang20159.coding.me/就会看到**404</a> page not found**。</p>
<pre><code>cd source/
touch Staticfile  #名字必须是Staticfile
</code></pre><p>这样hexo deploy时就会同时部署到GitHub和Coding.net的Page服务上啦~~~   </p>
<pre><code>changdeMacBook-Pro:blog chang$ hexo deploy
INFO  Deploying: git
INFO  Clearing .deploy_git folder...
INFO  Copying files from public folder...
On branch master
nothing to commit, working directory clean
To git@git.coding.net:chang20159/chang20159.git
   c8979a1..18777cd  HEAD -&gt; master
Branch master set up to track remote branch master from git@git.coding.net:chang20159/chang20159.git.
On branch master
nothing to commit, working directory clean
To git@github.com:chang20159/chang20159.github.io.git
   c8979a1..18777cd  HEAD -&gt; master
Branch master set up to track remote branch master from git@github.com:chang20159/chang20159.github.io.git.
INFO  Deploy done: git 
</code></pre><p>然后<a href="http://chang20159.coding.me/和https://chang20159.github.io/都可以看到新发的内容啦~~~" target="_blank" rel="external">http://chang20159.coding.me/和https://chang20159.github.io/都可以看到新发的内容啦~~~</a><br>不过，新发布的内容coding上需要等几分钟才会更新。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>附上一篇写得很好的文章 》》》》》    </p>
<ul>
<li><a href="https://segmentfault.com/a/1190000004548638" target="_blank" rel="external">hexo同时托管到coding.net与github</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 静态博客 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Coding </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[制作WebIcon字体]]></title>
      <url>/%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>字体图标，又名IconFont。<br>在画页面的时候常常会碰到向下的箭头、向上的箭头、向左的箭头、向右的箭头。 额，当然除了箭头还有这样一些东西…<br><img src="/images/IconMoon/QQ20161108-4@2x.png"><br><a id="more"></a></p>
<p>一个页面可能会有很多这种小图标，如果每个图标当用作图片来加载，速度会很慢。像对勾（√）这种简单又有规则的图标，可以用border+rotate画出来，也可以用雪碧图（CSS Sprit），但都没有字体图标扩展性好，而且放大不失真，比较好维护。    </p>
<p>要制作想要的字体图标样式，推荐<a href="http://www.iconfont.cn/plus" target="_blank" rel="external">阿里巴巴字体图标库</a>和<a href="http://iconmoon.io/" target="_blank" rel="external">IcoMoon</a>,下面记录一下我的使用心得。</p>
<h3 id="收集或自己制作SVG格式图标"><a href="#收集或自己制作SVG格式图标" class="headerlink" title="收集或自己制作SVG格式图标"></a>收集或自己制作SVG格式图标</h3><p>在<a href="http://www.iconfont.cn/plus" target="_blank" rel="external">阿里巴巴字体图标库</a>找到需要的图标并下载，比如我需要一个“加”的图标，像这样<br><img src="/images/IconMoon/QQ20161109-0@2x.png" alt=""><br>点开后可以看到下载图标，点击下载图标进入编辑状态，这时可以选择设置图标的颜色和大小</p>
<p>下面两个图标长得一样，但其实不一样    </p>
<ul>
<li>第一个图标只有一个路径，所以整个图标的颜色只能设置成一样的</li>
<li>第二个图标有两个路径，可以对每个路径分别编辑</li>
</ul>
<p><img src="/images/IconMoon/QQ20161109-1@2x.png" alt=""><br><img src="/images/IconMoon/QQ20161108-7@2x.png" alt=""><br>设置完成后，点击【SVG下载】<br>如此，收集到想要的SVG格式图标，如果找不到多路径分别设置的图标，也可以自己用SVG编辑器重新设计成多条路径。</p>
<h3 id="Web-Icon制作"><a href="#Web-Icon制作" class="headerlink" title="Web Icon制作"></a>Web Icon制作</h3><p>这里制作工具用的IcoMoon App,<a href="http://iconmoon.io/" target="_blank" rel="external">IcoMoon官网</a></p>
<p>点击右上角IconMoon App<br><img src="/images/IconMoon/QQ20161108-0@2x.png" alt=""><br>点击左上角图标选择 new empty set,新建一个空集合<br><img src="/images/IconMoon/QQ20161108-1@2x.png" alt=""><br>点击import to set,把刚才下载的svg图标导进来<br><img src="/images/IconMoon/QQ20161108-2@2x.png" alt=""><br>可以看到这些图标有很多都是有颜色的，这些颜色都是在下载的时候设置的<br><img src="/images/IconMoon/QQ20161108-3@2x.png" alt=""><br>全部选中，点击右下角的 generate font,生成字体，又会出来一个编辑页面<br><img src="/images/IconMoon/QQ20161108-5@2x.png" alt=""><br>在这个页面会发现，除了有多条路径的图标颜色还在，其他的图标都是灰色的，只有一条路径的图标其实不用设定颜色，因为设了也没用，这个我们可以在css文件里设置color属性添加颜色。<br>这里可以编辑图标的位置（居中 居右  向左 向下 翻转 镜像等），然后点击Duplicate保存下来<br><img src="/images/IconMoon/QQ20161108-6@2x.png" alt=""></p>
<p>最后一步就是点击右下角的Download,下载一个包，里面有字体文件fonts，和css文件，在项目里引入就好了。</p>
]]></content>
      
        <categories>
            
            <category> CSS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 字体图标 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ES6语法简要笔记]]></title>
      <url>/ES6%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<h2 id="let和const"><a href="#let和const" class="headerlink" title="let和const"></a>let和const</h2><h3 id="块级作用域"><a href="#块级作用域" class="headerlink" title="块级作用域"></a>块级作用域</h3><p>let和const具有块级作用域，只在所在的代码块内有效。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//块级作用域</span></div><div class="line"><span class="keyword">var</span> a = [];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</div><div class="line">    a[i] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(i);</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">a[<span class="number">6</span>]();  <span class="comment">//10</span></div></pre></td></tr></table></figure></p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> b = [];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++)&#123;</div><div class="line">    b[j] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        println(j)</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">b[<span class="number">6</span>](); <span class="comment">//6</span></div></pre></td></tr></table></figure>
<h3 id="不存在变量提升"><a href="#不存在变量提升" class="headerlink" title="不存在变量提升"></a>不存在变量提升</h3><p>let/const不像var那样会发生“变量提升”现象。所以，变量一定要在声明后使用，否则报错。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 变量提升</span></div><div class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// 输出undefined</span></div><div class="line"><span class="built_in">console</span>.log(bar); <span class="comment">// 报错ReferenceError</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</div><div class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</div></pre></td></tr></table></figure></p>
<h3 id="暂时性死区"><a href="#暂时性死区" class="headerlink" title="暂时性死区"></a>暂时性死区</h3><p>只要块级作用域内存在let/const命令，它所声明的变量就“绑定”（binding）这个区域，不再受外部声明的影响。<br>所以在此区域内的，在声明之前不能使用该变量。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//暂时性死区</span></div><div class="line"><span class="keyword">var</span> a = <span class="number">20159</span>;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    a = <span class="string">"chang"</span>;</div><div class="line">    <span class="keyword">let</span> a ;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="不允许重复声明"><a href="#不允许重复声明" class="headerlink" title="不允许重复声明"></a>不允许重复声明</h3><p>let/const不允许在相同作用域内，重复声明同一个变量。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//不允许重复声明</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">let</span> name;</div><div class="line">    <span class="keyword">var</span> name;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="字符串模板"><a href="#字符串模板" class="headerlink" title="字符串模板"></a>字符串模板</h2><h3 id="字符串中嵌入变量"><a href="#字符串中嵌入变量" class="headerlink" title="字符串中嵌入变量"></a>字符串中嵌入变量</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//字符串模板</span></div><div class="line"><span class="keyword">let</span> number = <span class="number">20159</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`chang <span class="subst">$&#123;number&#125;</span>`</span>);</div></pre></td></tr></table></figure>
<h3 id="支持多行字符串反斜杠"><a href="#支持多行字符串反斜杠" class="headerlink" title="支持多行字符串反斜杠"></a>支持多行字符串反斜杠</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> idea = <span class="string">`I like to do the front end.</span></div><div class="line">How can I do ?`;</div><div class="line"><span class="built_in">console</span>.log(idea);</div></pre></td></tr></table></figure>
<h2 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h2><p>ES6允许按照一定模式，从数组和对象中提取值，对变量进行赋值,称为解构赋值。<br>解构赋值的规则是，只要等号右边的值不是对象，就先将其转为对象。按照此规则可以分为两类：数组的解构和对象的解构。</p>
<h3 id="对象的解构赋值"><a href="#对象的解构赋值" class="headerlink" title="对象的解构赋值"></a>对象的解构赋值</h3><p>等号左侧是{}，则按右侧数据进行对象解构，此时等号右侧必须是对象或可转为对象的值(undefined和null无法转为对象)。<br><strong>对象的结构根据属性名来匹配。</strong><br>如下，是先找到左侧的同名属性name，再赋给该属性对应的变量name1。最终将profile.name的值付给了name1。如果左侧的属性在对象中没有，对应的变量值将会是undefined,比如sex<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> profile = &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">"chang"</span>,</div><div class="line">    <span class="attr">number</span>:<span class="number">20159</span></div><div class="line">&#125;;</div><div class="line"><span class="keyword">let</span> &#123; <span class="attr">name</span>:name1,<span class="attr">number</span>:number1,<span class="attr">age</span>:age1 = <span class="number">24</span>,<span class="attr">sex</span>:sex1 &#125; = profile;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"name1:%s,number1:%d,age1:%d,sex1:%s"</span>, name1,number1,age1,sex1);</div><div class="line">alert(<span class="string">`name1:<span class="subst">$&#123;name1&#125;</span>,number1:<span class="subst">$&#123;number1&#125;</span>,age1:<span class="subst">$&#123;age1&#125;</span>,sex1:<span class="subst">$&#123;sex1&#125;</span>`</span>);</div></pre></td></tr></table></figure></p>
<p>如果新的变量名与对象的属性名相同，可以简写成下面这样，等同于 let name = profile.name;<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; name,number,age,sex &#125; = profile;</div></pre></td></tr></table></figure></p>
<h3 id="数组的解构赋值"><a href="#数组的解构赋值" class="headerlink" title="数组的解构赋值"></a>数组的解构赋值</h3><p>等号的右边的数据结构必须具Iterator接口，等号左边用[]表示<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> array = [<span class="string">"ch"</span>]</div></pre></td></tr></table></figure></p>
<h3 id="指定变量的默认值"><a href="#指定变量的默认值" class="headerlink" title="指定变量的默认值"></a>指定变量的默认值</h3><p>等号左侧是[],则对右侧数据进行数组解构，此时等号右侧必须是具有Iterator结构的值。<br><strong>数组解构根据元素的顺序进行模式匹配。</strong></p>
<h3 id="解构赋值的应用"><a href="#解构赋值的应用" class="headerlink" title="解构赋值的应用"></a>解构赋值的应用</h3><p>1.交换变量值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x,y] = [y,x];</div></pre></td></tr></table></figure></p>
<p>2.提取对象属性<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;userInfo,shopInfo&#125; = <span class="keyword">this</span>.props;</div></pre></td></tr></table></figure></p>
<p>3.解构赋值也可用于函数调用时传参，形参相当于解构等式左侧值，实际传入的参数相当于等式右侧的值。</p>
<h2 id="…-运算符"><a href="#…-运算符" class="headerlink" title="… 运算符"></a>… 运算符</h2><p>..运算符有两种，spread运算符和rest运算符,作用相反</p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h4 id="spread运算符"><a href="#spread运算符" class="headerlink" title="spread运算符"></a>spread运算符</h4><p>spread运算符是将数组或类数组对象展开成一系列用逗号隔开的值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">let</span> new_array = [...array,<span class="number">4</span>,<span class="number">5</span>];    <span class="comment">//数组合并</span></div><div class="line"><span class="built_in">console</span>.log(new_array);</div><div class="line"><span class="keyword">let</span> copy_array = [...array];   <span class="comment">//数组深拷贝</span></div><div class="line"><span class="built_in">console</span>.log(copy_array);</div></pre></td></tr></table></figure></p>
<h4 id="rest运算符"><a href="#rest运算符" class="headerlink" title="rest运算符"></a>rest运算符</h4><p>将逗号隔开的值序列组合成一个数组<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//结合数组的解构赋值</span></div><div class="line"><span class="keyword">let</span> [ value,...array ] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`value:<span class="subst">$&#123;value&#125;</span>, array:<span class="subst">$&#123;array&#125;</span>`</span>); <span class="comment">//value:1, array:2,3,4</span></div><div class="line"></div><div class="line"><span class="comment">//用于函数不定长的参数,可避免使用arguments对象</span></div><div class="line"><span class="keyword">var</span> rest = <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>)</span>&#123;</div><div class="line">-    <span class="built_in">console</span>.log(<span class="string">`rest.args:<span class="subst">$&#123;args[<span class="number">1</span>]&#125;</span>`</span>); <span class="comment">//rest.args:es5</span></div><div class="line">&#125;;</div><div class="line">rest(<span class="string">"es6"</span>,<span class="string">"es5"</span>,<span class="string">"es3"</span>);</div></pre></td></tr></table></figure></p>
<h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><h4 id="spread运算符-1"><a href="#spread运算符-1" class="headerlink" title="spread运算符"></a>spread运算符</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> object = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;;</div><div class="line"><span class="keyword">let</span> object1 = &#123;...object&#125;;</div><div class="line">object1.a = <span class="number">2</span>;</div><div class="line"><span class="comment">//object1 : &#123;a:2,b:2&#125;</span></div><div class="line"><span class="comment">//object : &#123;a:1,b:2&#125;</span></div></pre></td></tr></table></figure>
<h4 id="rest运算符-1"><a href="#rest运算符-1" class="headerlink" title="rest运算符"></a>rest运算符</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> object = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;;</div><div class="line"><span class="keyword">let</span> &#123;...object2&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.dir(object2);</div><div class="line"><span class="comment">//&#123;a:1,b:2&#125;</span></div></pre></td></tr></table></figure>
<h2 id="for…of循环"><a href="#for…of循环" class="headerlink" title="for…of循环"></a>for…of循环</h2><p>for…of可遍历数组的键值，for…in循环只能获得键名<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> array = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>];</div><div class="line">array.name = <span class="string">'es6'</span>;</div><div class="line"><span class="comment">//只返回可数字索引的键值 of: 10   of: 20  of: 30</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">of</span> array)&#123;  <span class="built_in">console</span>.log(<span class="string">`of: <span class="subst">$&#123;value&#125;</span>`</span>); &#125; </div><div class="line"></div><div class="line"><span class="comment">//in: 0  in: 1  in: 2  in: name</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">in</span> array)&#123;  <span class="built_in">console</span>.log(<span class="string">`in: <span class="subst">$&#123;value&#125;</span>`</span>); &#125; </div><div class="line"></div><div class="line"><span class="comment">//forEach: 0:10  forEach: 1:20  forEach: 2:30</span></div><div class="line">array.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item,index</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`forEach: <span class="subst">$&#123;index&#125;</span>:<span class="subst">$&#123;item&#125;</span>`</span>);  </div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="Promise对象"><a href="#Promise对象" class="headerlink" title="Promise对象"></a>Promise对象</h2><p>Promise是一个构造函数，函数的参数是一个未来才会结束的事件，而函数的实例是这个事件执行的状态。简洁的说，Promise对象代表一个异步操作，可以获取异步操作的状态。<br>有三种状态：</p>
<ul>
<li>pending 进行中</li>
<li>resolved 已完成</li>
<li>rejected 已失败</li>
</ul>
<p>而且状态的改变只会从pending到resolved，或则从pending到rejected<br>注意：Promise一旦new了就会立即执行，无法中断</p>
<p>用法:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    ...</div><div class="line">  if (<span class="comment">/* 异步操作成功 */</span>)&#123;</div><div class="line">    resolve(value);  <span class="comment">//执行resolve函数将状态从Pending变为Resolved</span></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    reject(error);   <span class="comment">//执行reject函数将状态从Pending变为rejected</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">／/then方法分别指定Resolved状态和Reject状态的回调函数。</div><div class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">  <span class="comment">// Resolved状态时执行，value是resolve函数的参数</span></div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="comment">// rejected状态时执行，value是reject函数的参数</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>实例方法：<br>1、Promise.prototype.then()  为Promise实例添加状态改变时的回调函数<br>2、Promise.prototype.catch() 指定发生错误时的回调函数<br>3、Promise.all()  接收多个Promise实例，返回一个新的Promise实例<br>  <strong>如果希望多个请求并发执行，可以使用Promise.all方法</strong><br>  例如：p = new Promise([p1,p2,p3])</p>
<ul>
<li>只有p1,p2,p3的状态都是已完成时，p的状态才会变成已完成，并将p1,p2,p3的返回值组成一个数组，传递给p的回调函数；</li>
<li>只要p1,p2,p3有一个失败，p的状态就会变成失败，第一个被reject的实例的返回值，会传递给p的回调函数</li>
<li>注意：p1、p2、p3都是Promise对象的实例，如果不是，就会先调用Promise.resolve方法，将参数转为Promise实例<br>4、Promise.race()  只要p1、p2、p3之中有一个实例率先改变状态，p的状态就跟着改变。率先改变状态的Promise 实例的返回值，传递给p的回调函数。<br>5、Promise.resolve()  返回一个新的 Promise 实例,实例的状态为resolved<br>6、Promise.reject()  返回一个新的 Promise 实例，实例的状态为rejected<br>7、Promise内部的错误不会冒泡到全局，可以通过在回调链尾端添加done方法抛出可能出现的错误<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.prototype.done = <span class="function"><span class="keyword">function</span> (<span class="params">onFulfilled, onRejected</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.then(onFulfilled, onRejected)</div><div class="line">    .catch(<span class="function"><span class="keyword">function</span> (<span class="params">reason</span>) </span>&#123;</div><div class="line">      <span class="comment">// 抛出一个全局错误</span></div><div class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="keyword">throw</span> reason &#125;, <span class="number">0</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>8、finally(callback) 用于指定不管Promise对象最后状态如何，都会执行的操作.<br>接受一个普通的回调函数作为参数，该函数不管怎样都必须执行</p>
<h2 id="Generator函数"><a href="#Generator函数" class="headerlink" title="Generator函数"></a>Generator函数</h2><p>Generator函数与yield关键字配合可以让代码分布执行，异步操作也是将一个任务分段执行，因此 可以使用Generator函数实现异步编程，拿到第一步的执行结果后再执行第二步，但是程序的写法却跟同步写法一样。看个例子：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">generator</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> x = <span class="number">1</span>;</div><div class="line">  <span class="keyword">let</span> y = <span class="keyword">yield</span> x+<span class="number">1</span>;</div><div class="line">  <span class="keyword">let</span> z =  <span class="keyword">yield</span> x + <span class="number">2</span>;</div><div class="line">  <span class="built_in">console</span>.log(z);</div><div class="line">&#125;</div><div class="line"></div><div class="line">g = generator();</div><div class="line"><span class="keyword">let</span> step1 = g.next()</div><div class="line"><span class="built_in">console</span>.dir(step1)</div><div class="line"><span class="keyword">let</span> step2 = g.next(step1.value)</div><div class="line"><span class="built_in">console</span>.dir(step2)</div><div class="line"><span class="keyword">let</span> step3 = g.next(step2.value)</div><div class="line"><span class="built_in">console</span>.dir(step3)</div></pre></td></tr></table></figure></p>
<p>结果如下，执行Generator函数返回一个指针对象，调用指针对象的next方法移动指针到yield语句，每次执行都从上一次结束的位置开始。next方法可以传入参数，这个参数是上一个阶段的执行结果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt;Object</div><div class="line">  &gt;done: false</div><div class="line">  &gt;value: 2_</div><div class="line">  &gt;_proto__: Object</div><div class="line">&gt;Object</div><div class="line">  &gt;done: false</div><div class="line">  &gt;value: 3_</div><div class="line">  &gt;_proto__: Object</div><div class="line">3</div><div class="line">&gt;Object</div><div class="line">  &gt;done: true</div><div class="line">  &gt;value: undefined</div><div class="line">  &gt;__proto__: Object</div><div class="line">undefined</div></pre></td></tr></table></figure></p>
<p>Generator函数能够让异步编程可以像写同步执行的代码一样，但是阶段执行的管理却很麻烦，我得知道什么时候执行那一步。有些方法可以让Generator函数自动执行，这里还没研究。</p>
<h2 id="Set和Map"><a href="#Set和Map" class="headerlink" title="Set和Map"></a>Set和Map</h2><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>Set实例是不重复值的集合</p>
<p><strong>Set实例的属性和方法</strong><br>let list = new Set([1,2,2,4])</p>
<p><strong>属性</strong></p>
<ul>
<li>size  返回成员数量</li>
</ul>
<p><strong>操作方法</strong></p>
<ul>
<li>add(value)：添加某个值，返回的是当前的Set对象，可以采用链式写法</li>
<li>delete(value)：删除某个值，返回一个布尔值，表示删除是否成功。</li>
<li>has(value)：返回一个布尔值，表示该值是否为Set的成员。</li>
<li>clear()：清除所有成员，没有返回值。</li>
</ul>
<p><strong>遍历方法</strong></p>
<ul>
<li>keys()：返回键名的遍历器</li>
<li>values()：返回键值的遍历器</li>
<li>entries()：返回键值对的遍历器</li>
<li>forEach()：使用回调函数遍历每个成员</li>
</ul>
<p>注意：WeakSet 结构与 Set 类似，也是不重复的值的集合，但WeakSet的成员只能是对象。并且WeakSet 中的对象都是弱引用，即垃圾回收机制不考虑 WeakSet 对该对象的引用</p>
<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>Map是键值对的集合，“键”的范围不限于字符串，各种类型的值（包括对象）都可以当作键<br>注意，只有对同一个对象的引用，Map 结构才将其视为同一个键。</p>
<p><strong>Map实例的属性和方法</strong><br>let map = new Map([[‘name1’,’chang’],[‘name2’,’chen’]])</p>
<p><strong>属性</strong></p>
<ul>
<li>size  返回成员数量</li>
</ul>
<p><strong>操作方法</strong></p>
<ul>
<li>set(value)：添加键值对，返回的是当前的Map对象，可以采用链式写法</li>
<li>delete(value)：删除某个键，返回一个布尔值，表示删除是否成功。</li>
<li>has(value)：返回一个布尔值，表示某个键是否在当前 Map 对象</li>
<li>clear()：清除所有成员，没有返回值。</li>
</ul>
<p><strong>遍历方法</strong></p>
<ul>
<li>keys()：返回键名的遍历器</li>
<li>values()：返回键值的遍历器</li>
<li>entries()：返回键值对的遍历器</li>
<li>forEach()：使用回调函数遍历每个成员</li>
</ul>
<p>注意：WeakMap结构与Map结构类似，也是用于生成键值对的集合，但WeakMap只接受对象作为键名（null除外），并且WeakMap的键名所指向的对象，不计入垃圾回收机制。</p>
<p><strong>提示：垃圾回收机制依赖引用计数，如果一个值的引用次数不为0，垃圾回收机制就不会释放这块内存</strong></p>
<h2 id="类修饰器"><a href="#类修饰器" class="headerlink" title="类修饰器"></a>类修饰器</h2><h2 id="import和export"><a href="#import和export" class="headerlink" title="import和export"></a>import和export</h2><p>ES6 模块的设计思想，是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。<br>模块功能由export和import两个命令完成。export对外输出模块，import用于引入模块。</p>
<h3 id="export-写法"><a href="#export-写法" class="headerlink" title="export 写法"></a>export 写法</h3><p>import接受一对大括号，指定从其他模块导入的变量名。大括号中的变量名，必须与被导入模块对外接口的名称相同。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// 写法一</div><div class="line">export var value = 1;</div><div class="line">export function func()&#123;...&#125;;</div><div class="line"></div><div class="line">// 写法二</div><div class="line">var value = 1;</div><div class="line">function func()&#123;...&#125;;</div><div class="line">export &#123;value,func&#125;;</div><div class="line"></div><div class="line">// 写法三</div><div class="line">var value = 1;</div><div class="line">function func()&#123;...&#125;;</div><div class="line">export &#123;</div><div class="line">  value as value1,</div><div class="line">  func as func1,</div><div class="line">  func as func2</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="import写法"><a href="#import写法" class="headerlink" title="import写法"></a>import写法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 写法一</div><div class="line">import &#123; value, func&#125; from &apos;module&apos;</div><div class="line"></div><div class="line">// 写法二</div><div class="line">import * as Module from &apos;module&apos;</div></pre></td></tr></table></figure>
<h3 id="export-default写法"><a href="#export-default写法" class="headerlink" title="export default写法"></a>export default写法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">export var value = 1;</div><div class="line">export default function func()&#123;...&#125;;</div><div class="line"></div><div class="line">import func, &#123;value&#125; from &apos;module&apos;</div></pre></td></tr></table></figure>
<h2 id="async-函数"><a href="#async-函数" class="headerlink" title="async 函数"></a>async 函数</h2><p>其实是Generator函数的语法糖，将<strong>Generator函数</strong>和<strong>自动执行器</strong>，包装在一个函数里<br>Generator 函数需要调用next方法，每调一次执行一段。</p>
<ul>
<li>async函数返回一个Promise 对象，一旦遇到await就会先返回，等到异步操作完成再接着执行函数体内后面的语句。</li>
<li>async函数的返回值，会作为then方法回调函数的参数。</li>
<li>await命令后面是一个Promise 对象。如果不是，会被转成一个立即resolve的Promise 对象。<br>下面代码的执行结果是： 哈哈   嘿嘿    4<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">async function cal(x)&#123;</div><div class="line">    let result = await x + 1;</div><div class="line">    console.log(&apos;嘿嘿&apos;)</div><div class="line">    return result;</div><div class="line">&#125;</div><div class="line">cal(3).then(function(data)&#123;</div><div class="line">  console.log(data)</div><div class="line">&#125;)</div><div class="line">console.log(&apos;哈哈&apos;)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>与Generator 函数相比</p>
<ul>
<li>async函数内置了执行器，像普通函数一样执行</li>
<li>async和await，比星号和yield语义更清楚。async表示函数里有异步操作，await表示紧跟在后面的表达式需要等待结果。</li>
<li>async函数的返回值是 Promise 对象</li>
</ul>
<h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">x,y</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(x+y &gt; <span class="number">5</span>)&#123;</div><div class="line">       <span class="keyword">return</span> x * y</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有了箭头函数，上面的方法可以写成：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(x,y) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span>(x+y &gt; <span class="number">5</span>)&#123;</div><div class="line">      <span class="keyword">return</span> x * y</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果函数体只有一个return语句，可以将大括号和return省略<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(x,y) =&gt;  x * y</div></pre></td></tr></table></figure></p>
<p>如果返回的是个对象,得加上（），参数如果只有一个，可以不要()<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(name) =&gt;  (&#123;<span class="attr">name</span>:name&#125;)</div></pre></td></tr></table></figure></p>
<p>箭头函数其实就是一个用箭头简化了的匿名函数，不过与匿名函数有点区别。<br><strong>箭头函数内部的this是词法作用域，由上下文确定，指向函数定义时的上下文。</strong><br>下面的代码，obj.sayHello()得到的结果是undefined,因为this.name指向window或undefined<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var obj = &#123;</div><div class="line">    name: &apos;chang&apos;,</div><div class="line">    sayHello: function () &#123;</div><div class="line">        var fn = function () &#123;</div><div class="line">            return this.name; // this指向window或undefined</div><div class="line">        &#125;;</div><div class="line">        return fn();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>为了正常执行我们会这样做<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var obj = &#123;</div><div class="line">    name: &apos;chang&apos;,</div><div class="line">    sayHello: function () &#123;</div><div class="line">        let _this = this</div><div class="line">        var fn = function () &#123;</div><div class="line">            return _this.name; // this指向window或undefined</div><div class="line">        &#125;;</div><div class="line">        return fn();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>但是有了箭头函数就不需要了,可以写成这样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var obj = &#123;</div><div class="line">    name: &apos;chang&apos;,</div><div class="line">    sayHello: function () &#123;</div><div class="line">        var fn = () =&gt; this.name;</div><div class="line">        return fn();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://es6.ruanyifeng.com/" target="_blank" rel="external">ECMAScript 6 入门</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise#参见" target="_blank" rel="external">MDN Promise</a></li>
<li><a href="http://www.infoq.com/cn/es6-in-depth/" target="_blank" rel="external">深入浅出ES6 </a></li>
<li><a href="https://promisesaplus.com/" target="_blank" rel="external">Promises/A+</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> JavaScript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[模块管理与打包实践]]></title>
      <url>/%E6%A8%A1%E5%9D%97%E7%AE%A1%E7%90%86%E4%B8%8E%E6%89%93%E5%8C%85%E5%AE%9E%E8%B7%B5/</url>
      <content type="html"><![CDATA[<p>关于javascript模块化编程的介绍可以参考<a href="http://www.ruanyifeng.com/blog/2012/10/asynchronous_module_definition.html" target="_blank" rel="external">阮一峰的Javascript模块化编程系列</a>和<a href="http://zhaoda.net/webpack-handbook/index.html" target="_blank" rel="external">webpack中文指南</a>，详细讲述了模块系统的演进以及各种方式的使用方法。看完之后特来实践一下。<br><a id="more"></a></p>
<h2 id="原始的JS文件加载"><a href="#原始的JS文件加载" class="headerlink" title="原始的JS文件加载"></a>原始的JS文件加载</h2><p>来看下在html中用script标签引入js文件的情况      </p>
<p>新建一个文件目录   <code>mkdir ScriptTag</code>    </p>
<p>进入此目录   <code>cd ScriptTag</code></p>
<p>在此文件中新建文件    <code>touch index.html</code>       </p>
<p>内容如下：    </p>
<pre><code>&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;webpack&lt;/title&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&quot;module1.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;module2.js&quot;&gt;&lt;/script&gt;

        &lt;script type=&quot;text/javascript&quot;&gt;
            printModule1FileName();
            printModule2FileName();
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>新建module1.js  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var filename = &quot;module1&quot;;</div><div class="line">function printModule1FileName()&#123;</div><div class="line">	document.write(`This is $&#123;filename&#125;&lt;br/&gt;`);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>新建module2.js      </p>
<pre><code>var filename = &quot;module2&quot;;
function printModule2FileName(){
    document.write(`This is ${filename}&lt;br/&gt;`);
}
</code></pre><p>打开index.html文件，浏览器中显示:    </p>
<pre><code>This is module2    
This is module2     
</code></pre><p>将index.html中引入的js文件交换顺序    </p>
<pre><code>&lt;script src=&quot;module2.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;module1.js&quot;&gt;&lt;/script&gt;    
</code></pre><p>此时浏览器中显示：  </p>
<pre><code>This is module1    
This is module1     
</code></pre><p>使用这种方式引入js文件，每个js文件中的变量和方法都暴露在全局作用域下，并按照js文件的引入顺序加载，所以当module1和module2中都有filename这个变量且最后引入module2时，加载完成后的filename最终指向的是module2.js中定义的字符串“module2”。当引入的多个js文件中存在多个相同名字的function，在调用此function是也会造成冲突。  </p>
<p>除了<strong>全局作用域下容易造成变量冲突</strong>这种弊端之外，还有：   </p>
<ul>
<li>当js文件之间存在依赖关系时，必须严格保证加载顺序，被依赖的文件要放在前面。   </li>
<li>加载时，浏览器会停止渲染（同步加载），加载文件越多，浏览器响应的时间越长。  </li>
</ul>
<p><strong>注</strong>： 这里用到了ES6模板文本特性，我用的chrome,说明chrome是支持ES6的，但不是全部都支持，比如export和import.</p>
<h2 id="使用RequireJS加载模块"><a href="#使用RequireJS加载模块" class="headerlink" title="使用RequireJS加载模块"></a>使用RequireJS加载模块</h2><p>RequireJS是基于AMD规范实现的，在学习RequireJS之前，先介绍一下CommonJS和AMD这两种模块规范。    </p>
<h3 id="CommonJS规范"><a href="#CommonJS规范" class="headerlink" title="CommonJS规范"></a>CommonJS规范</h3><p>CommonJS是为了解决javascript的作用域问题而定义的模块形式，使每个模块可以在它自身的作用域中执行。规范的主要内容是：必须通过module.exports暴露对外的变量或接口；通过require()方法导入其他模块的的输出到当前模块，并且require模块是同步加载。    </p>
<p>用于在服务端解析javacript的<a href="https://nodejs.org/en/" target="_blank" rel="external">Nodejs</a>就是参照CommonJS规范实现的，在浏览器端也有对CommonJS模块规范的实现，比如<a href="http://browserify.org/" target="_blank" rel="external">Browserify</a>。但同步加载  模块的方式不适合在浏览器环境中,因为需要等待所有模块都加载完成才开始渲染页面，响应时间很长。</p>
<p>因而，浏览器端的模块只能采用异步加载，这才有了AMD规范的诞生。</p>
<h3 id="AMD规范"><a href="#AMD规范" class="headerlink" title="AMD规范"></a>AMD规范</h3><p>AMD(异步模块定义)规范支持在浏览器环境中异步加载模块。<a href="http://requirejs.org/" target="_blank" rel="external">RequireJS</a>正是AMD规范的一种实现。 </p>
<p><strong>AMD规范的的核心思想</strong>：模块的加载不影响在它之后的程序的执行，所有依赖这个模块的语句都定义在一个回调函数中，模块加载完成后，再运行回调函数。</p>
<h3 id="RequireJS"><a href="#RequireJS" class="headerlink" title="RequireJS"></a>RequireJS</h3><p>RequireJS定义了三个变量：requirejs, require, define.其中requirejs === require</p>
<p><strong>模块的定义</strong>：通过<strong>define函数</strong>定义在闭包中，define函数格式为： </p>
<pre><code>define(String id,String[] dependencies,Function|Object factory)
</code></pre><ul>
<li>id:模块的名字，可选参数</li>
<li>dependencies： 自身依赖的模块列表，这些依赖模块的输出作为factory的参数。可选参数。如果没有指定，则默认的依赖模块为[‘require’,’exports’,’module’]</li>
<li>factory: 一个函数或者对象。若是一个函数，该函数的返回值就是模块的输出。</li>
</ul>
<p><strong>模块的加载</strong>：require方法用来加载依赖模块，并执行加载完之后的逻辑，require定义格式为：    </p>
<pre><code>require(String[] dependencies,Function callback)
</code></pre><p>下面来画个页面，用RequireJS来解决模块的定义、依赖和加载问题。目录结构如下：</p>
<pre><code>.
├── entry.js
├── index.html
├── lib
│   └── require.js
└── module
    ├── module1.js
    └── module2.js
</code></pre><p>要使用define和require函数定义和加载模块需要引入require.js文件。<br>从<a href="http://requirejs.org/docs/download.html" target="_blank" rel="external">RequireJS 官网</a>下载最新版本，放在lib文件下。</p>
<p>其中module1和module2是打印文件名的两个模块，定义如下：<br>module1.js  </p>
<pre><code>define(function(){
    function printModule1FileName(){
        document.write(&apos;This is module1&lt;br/&gt;&apos;);
    }
    return {
        filename:&quot;module1&quot;,
        printModule1FileName:printModule1FileName
    };
});
</code></pre><p>module2.js     </p>
<pre><code>define(function(){
    var printModule2FileName = function(){
        document.write(&apos;This is module2&lt;br/&gt;&apos;);
    }
    return {
        filename:&quot;module2&quot;,
        printModule2FileName:printModule2FileName
    };
});
</code></pre><p>在entry.js中导入模块并调用依赖模块中的方法打印文件名  </p>
<pre><code>require.config({
    path: {
        module: &apos;./module&apos;,
    }
});
require([&apos;module/module1.js&apos;,&apos;module/module2.js&apos;],function(module1,module2){
    document.write(`${module1.filename} and ${module2.filename}&lt;br/&gt;`);
    module1.printModule1FileName();
    module2.printModule2FileName();
});
</code></pre><p>在index.html中引入require.js和entry.js    </p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;RequireJS&lt;/title&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&quot;lib/require.js&quot;&gt;&lt;/script&gt;   
        &lt;script src=&quot;entry.js&quot;&gt;&lt;/script&gt;
        &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>chrome浏览器打开index.html,显示   </p>
<pre><code>module1 and module2
This is module1
This is module2
</code></pre><p>RequireJS解决了并行加载模块的问题，但因为还有以下弊端</p>
<ul>
<li>代码书写不太符合常规习惯，模块的引入与代码逻辑掺杂在一起。    </li>
<li>只能将js文件作为模块加载。    </li>
<li>一个加载依赖多个模块就要并行发出多次HTTP请求，影响网页加载速度。虽然require.js提供了一个优化工具可以将多个模块合并在一个文件中只发出一次请求，但一次加载所有模块也很浪费流量，初始化过程慢。</li>
</ul>
<p>关于RequireJS可参考：  </p>
<ul>
<li><a href="http://requirejs.org/" target="_blank" rel="external">RequireJS 官网</a>   </li>
<li><a href="http://www.requirejs.cn/" target="_blank" rel="external">RequireJS 中文网</a>   </li>
<li><a href="https://github.com/requirejs" target="_blank" rel="external">RequireJS GitHub</a> 这里有很多RequireJS使用demo</li>
</ul>
<h2 id="webpack模块管理"><a href="#webpack模块管理" class="headerlink" title="webpack模块管理"></a>webpack模块管理</h2><p>webpack可以做到按需异步加载所有资源，除了js文件，图片、样式文件、html、模板库等都可以视作模块加载。当然，webpack本身只能加载js文件，需要借助Loader转换器来完成。</p>
<p>在用RequireJS加载非AMD规范模块前，需要先用require.config()方法定义shim属性，标注依赖模块的输出值和依赖性。webpack则只需要直接require,不管模块形式是CommonJS、AM还是普通的JS文件。</p>
<p>在webpack-demo文件目录下新建文件目录如下：   </p>
<pre><code>.
├── entry.js
├── index.html
└── module
    ├── module1.js
    └── module2.js
</code></pre><p>index.html    </p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;webpack&lt;/title&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;script src=&quot;./dist/bundle.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>entry.js    </p>
<pre><code>var printModule1 = require(&apos;./module/module1.js&apos;)
var printModule2 = require(&apos;./module/module2.js&apos;)

function printEntryFileName(){    
    printModule1();
    printModule2();
}

printEntryFileName();
</code></pre><p>module1.js    </p>
<pre><code>var filename = &quot;module1&quot;;
function printModule1FileName(){
    document.write(`This is ${filename}&lt;br/&gt;`);
}

module.exports = printModule1FileName;
</code></pre><p>html中引入的是bundle.js文件，这个文件是从哪里来的呢？<br>在得到这个文件之前需要先一次安装nodejs和webpack,node安装和升级参见：xxx<br>全局安装webpack    <code>npm install webpack -g</code><br>在webpack目录下执行  <code>webpack entry.js ./dist.bundle.js</code>,命令行会输出如下信息： </p>
<pre><code>Hash: 71d45b6722deab7e60ec
Version: webpack 1.13.2
Time: 75ms
        Asset              Size     Chunks  Chunk      Names
        bundle.js          2 kB       0     [emitted]  main
   [0] ./entry.js          192 bytes {0}    [built]
   [1] ./module/module1.js 147 bytes {0}    [built]
   [2] ./module/module2.js 145 bytes {0}    [built]
</code></pre><p>打开index.html文件可以看到输出   </p>
<pre><code>This is module1    
This is module2
</code></pre><p>这里涉及到了webpack几个重要的概念：入口(entry)、模块(module)、分块(chunk)<br>Asset这一列是webpack编译输出的文件，bundle.js是入口，在html中通过script标签引入，其他的是被entry依赖的模块，webpack将他们按照依赖顺序进行编号.</p>
<p>若要给输出加一个样式，需要在package.json文件中加入loader转换器依赖。   </p>
<pre><code>npm init    
npm install css-loader style-loader
</code></pre><p>然后在entry.js中引入css模块，然后重新编译  </p>
<pre><code>require(&quot;!style!css!./style/style.css&quot;)
var printModule1 = require(&apos;./module/module1.js&apos;)
var printModule2 = require(&apos;./module/module2.js&apos;)

function printEntryFileName(){    
    printModule1();
    printModule2();
}

printEntryFileName();
</code></pre><p>webpack还可以根据配置文件编译打包，不需要在webpack命令后写参数（输入文件和输出文件），<br>默认情况下会搜索当前目录下webpack.config.js文件，也可以通过  –config来指定配置文件。在webpack-demo文件目录下新增webpack.config.js<br>var webpack = require(‘webpack’);</p>
<pre><code>module.exports = {
    entry:&apos;./entry.js&apos;,
    output: {
        path: __dirname + &apos;/dist&apos;,
        filename: &apos;bundle.js&apos;
    },
    module: {
        loaders:[
            {
                test:/\.css$/,loader:&apos;style!css&apos;
            }
        ]

    }
}
</code></pre><p>在终端运行webpack,会得到跟webpack entry.js ./dist.bundle.js一样的结果。最后的文件目录是这样子的    </p>
<pre><code>.
├── dist
│   └── bundle.js
├── entry.js
├── index.html
├── module
│   ├── module1.js
│   └── module2.js
├── package.json
├── style
│   └── style.css
└── webpack.config.js
</code></pre><h2 id="当webpack遇见ES6"><a href="#当webpack遇见ES6" class="headerlink" title="当webpack遇见ES6"></a>当webpack遇见ES6</h2><p>把上面最后的文件目录copy出来放到webpack-es6文件目录中，进入webpack-es6目录下操作。在项目中使用ES6语法需要做一些配置。</p>
<h3 id="babelrc文件"><a href="#babelrc文件" class="headerlink" title=".babelrc文件"></a>.babelrc文件</h3><p>在webpack-demo目录下新建.babelrc，这个是将ES6转码成ES5必须要有的文件。文件中的配置如下：    </p>
<pre><code>{
  &quot;presets&quot;: [&quot;es2015&quot;],
  &quot;plugins&quot;: []
}
</code></pre><p>.babelrc文件的配置可以参考<a href="http://www.ruanyifeng.com/blog/2016/01/babel.html" target="_blank" rel="external">Babel 入门教程</a>，如果项目使用的React+ES6，presets中则加入 “react”。</p>
<h3 id="配置webpack-config-js"><a href="#配置webpack-config-js" class="headerlink" title="配置webpack.config.js"></a>配置webpack.config.js</h3><p>在loaders中加入babel配置</p>
<pre><code>var webpack = require(&apos;webpack&apos;);
module.exports = {
    entry:&apos;./entry.js&apos;,
    output: {
        path: __dirname + &apos;/dist&apos;,
        filename: &apos;bundle.js&apos;
    },
    module: {
        loaders:[
            {
                test:/\.css$/,loader:&apos;style!css&apos;
            },
            {
              test: /\.js$/,
              loader: &apos;babel&apos;,
              exclude: /node_modules/
            }
        ]
    }
}
</code></pre><p>这里既然用到了npm install babel babel-loader –save</p>
<h3 id="安装必须的依赖"><a href="#安装必须的依赖" class="headerlink" title="安装必须的依赖"></a>安装必须的依赖</h3><p>.babelrc这个配置加了之后需要安装规则集    </p>
<pre><code>ES2015转码规则
npm install babel-preset-es2015 --save

react转码规则
npm install babel-preset-react --save
</code></pre><p>webpack.config.js中加入babel-loader也需要安装，还有最基本的bable模块  </p>
<pre><code>npm install babel babel-loader --save
</code></pre><h3 id="使用ES6语法改造项目"><a href="#使用ES6语法改造项目" class="headerlink" title="使用ES6语法改造项目"></a>使用ES6语法改造项目</h3><p>module1.js 与 module2.js    </p>
<pre><code>export function printModule1FileName(filename){
    document.getElementById(&apos;module1&apos;).innerHTML = `This is ${filename}`
}
</code></pre><p>entry.js    </p>
<pre><code>import &quot;!style!css!./style/style.css&quot;
import * as Module1 from &apos;./module/module1.js&apos;
import * as Module2 from &apos;./module/module2.js&apos;

class Entry{
    constructor(filename1,filename2){
        Module1.printModule1FileName(filename1);
        Module2.printModule2FileName(filename2);
    }
}

(() =&gt; new Entry(&quot;es6module1&quot;,&quot;es6module1&quot;))();
</code></pre><p>或者这样的entry.js    </p>
<pre><code>import &quot;!style!css!./style/style.css&quot;
import * as Module1 from &apos;./module/module1.js&apos;
import * as Module2 from &apos;./module/module2.js&apos;

class Entry{
    constructor(filename1,filename2){
        this.filename1 = filename1;
        this.filename2 = filename2;        
    }

    printModuleFileName(){
        Module1.printModule1FileName(this.filename1);
        Module2.printModule2FileName(this.filename2);
    }
}

var entry = new Entry(&quot;es6module1&quot;,&quot;es6module2&quot;);
entry.printModuleFileName();
</code></pre><p>其他的文件内容不变，在webpack-es6目录下执行webpack输出内容：    </p>
<pre><code>This is es6module1
This is es6module1
</code></pre><p>最后的目录    </p>
<pre><code>.
├── .babelrc
├── dist
│   └── bundle.js
├── entry.js
├── index.html
├── module
│   ├── module1.js
│   └── module2.js
├── package.json
├── style
│   └── style.css
└── webpack.config.js
</code></pre><p>关于ES6可参考： </p>
<ul>
<li><a href="http://es6.ruanyifeng.com/" target="_blank" rel="external">ECMAScript 6入门</a>    </li>
<li><a href="http://www.ruanyifeng.com/blog/2016/01/babel.html" target="_blank" rel="external">Babel 入门教程</a>    </li>
<li><a href="http://ruanyf.github.io/es-checker/index.cn.html" target="_blank" rel="external">检测浏览器支持的ES6特性</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 模块化编程 </tag>
            
            <tag> webpack </tag>
            
            <tag> requirejs </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[各种深拷贝方法]]></title>
      <url>/%E5%90%84%E7%A7%8D%E6%B7%B1%E6%8B%B7%E8%B4%9D%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>ECMAScript有5种简单数据类型（也叫基本数据类型）： Null 、 Undefined  、 Number   、String 、 Boolean<br>还有一种复杂数据类型：对象Object。ECMAScript提供了很多原生的引用类型，如Array、Object、Function.<br>基本数据类型保存在栈内存，引用类型的引用地址保存在栈内存，而引用的值保存在堆内存中。<br>我们常会遇到复制一个值的情况，直接复制一个基本数据类型值，能得到一个副本，栈内存中开辟了新的空间存放，<br>而直接复制一个引用类型值时，会为引用地址开辟一个栈内存存放，但引用的值还是同一块堆内存，新的引用地址和老的引用地址相同都指向这一块堆内存。<br><a id="more"></a><br>Object类型和Array类型是在程序计算复制过程最需要注意的，看两个例子。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> object = &#123;</div><div class="line">	<span class="attr">name</span>: <span class="string">'chang'</span>,</div><div class="line">	<span class="attr">age</span>: <span class="number">25</span>,</div><div class="line">	<span class="attr">other</span>: &#123;</div><div class="line">		<span class="attr">company</span>: <span class="string">'dianping'</span>,</div><div class="line">		<span class="attr">time</span>: <span class="string">'201505'</span></div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> object_new = object;  <span class="comment">//object赋给object_new</span></div><div class="line">object_new.age = <span class="number">18</span>;   <span class="comment">//修改了object_new的age</span></div><div class="line">alert(object.age);  <span class="comment">//18  object的age也变了，因为object和object_new指向的是同一块堆内存</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//数组也是一样</span></div><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</div><div class="line"><span class="keyword">var</span> array_new = array;</div><div class="line">array.push(<span class="number">5</span>);</div><div class="line">alert(array_new); <span class="comment">//1,2,3,4,5</span></div></pre></td></tr></table></figure>
<p>然而有时候并不希望新的对象和老的对象的值一改变就会互相影响。<br>所以要想办法解决这个问题。</p>
<h2 id="深拷贝实现"><a href="#深拷贝实现" class="headerlink" title="深拷贝实现"></a>深拷贝实现</h2><p>为了能对数组和对象进行深度复制，需要对他们的属性递归复制，直到属性是基本类型值才直接赋值，这样就需要实现一个深度赋值的函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">typeOf</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> map = &#123;</div><div class="line">		<span class="string">'[object Array]'</span> : <span class="string">'array'</span>,</div><div class="line">		<span class="string">'[object Object]'</span> : <span class="string">'object'</span>,</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> map[<span class="built_in">Object</span>.prototype.toString.call(data)];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">   <span class="keyword">var</span> result,i;</div><div class="line">   <span class="keyword">if</span>(typeOf(data) == <span class="string">'object'</span>)&#123;</div><div class="line">   		result =  &#123;&#125;;</div><div class="line">   		<span class="keyword">for</span>(i <span class="keyword">in</span> data)&#123;</div><div class="line">   			result[i] = deepClone(data[i]);</div><div class="line">   		&#125;</div><div class="line">   		<span class="keyword">return</span> result;</div><div class="line">   &#125;<span class="keyword">else</span> <span class="keyword">if</span>(typeOf(data) == <span class="string">'array'</span>)&#123;</div><div class="line">   		result =  [];</div><div class="line">   		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;data.length;i++)&#123;</div><div class="line">   			result.push(deepClone(data[i]));</div><div class="line">   		&#125;</div><div class="line">   		<span class="keyword">return</span> result;</div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">   		<span class="keyword">return</span> data;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> object_new = deepClone(object); </div><div class="line">object_new.age = <span class="number">18</span>;  </div><div class="line">alert(object.age);  <span class="comment">//25</span></div></pre></td></tr></table></figure>
<h2 id="借用JSON方法"><a href="#借用JSON方法" class="headerlink" title="借用JSON方法"></a>借用JSON方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> object = <span class="built_in">Object</span>.create(&#123;</div><div class="line">	<span class="attr">other</span>: &#123;</div><div class="line">		<span class="attr">company</span>: <span class="string">'dianping'</span>,</div><div class="line">		<span class="attr">time</span>: <span class="string">'201505'</span></div><div class="line">	&#125;</div><div class="line">&#125;,&#123;</div><div class="line">	<span class="attr">name</span>:&#123;</div><div class="line">		<span class="attr">value</span>:<span class="string">'chang'</span>,</div><div class="line">		<span class="attr">configurable</span>:<span class="literal">true</span>,</div><div class="line">		<span class="attr">enumerable</span>:<span class="literal">true</span>,</div><div class="line">		<span class="attr">writable</span>:<span class="literal">true</span></div><div class="line">	&#125;,</div><div class="line">	<span class="attr">age</span>:&#123;</div><div class="line">		<span class="attr">value</span>: <span class="number">25</span>,</div><div class="line">		<span class="attr">configurable</span>:<span class="literal">true</span>,</div><div class="line">		<span class="attr">enumerable</span>:<span class="literal">true</span>,</div><div class="line">		<span class="attr">writable</span>:<span class="literal">true</span></div><div class="line">	&#125;,</div><div class="line">	<span class="attr">sayHello</span>:&#123;</div><div class="line">		<span class="attr">value</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">		<span class="attr">configurable</span>:<span class="literal">true</span>,</div><div class="line">		<span class="attr">enumerable</span>:<span class="literal">true</span>,</div><div class="line">		<span class="attr">writable</span>:<span class="literal">true</span></div><div class="line">	&#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">var</span> temp = <span class="built_in">JSON</span>.stringify(object);</div><div class="line"><span class="keyword">var</span> object_new = <span class="built_in">JSON</span>.parse(temp);</div><div class="line">object.age = <span class="number">18</span>;</div><div class="line">alert(object_new.age); <span class="comment">//25 互不影响</span></div></pre></td></tr></table></figure>
<p>但是这种方法有个缺点，<strong>JSON不支持变量、函数或对象实例，在使用JSON.stringify()序列化对象时所有函数及原型成员会被忽略，不体现在结果中。</strong><br>所以object_new中的prototype指向了Object.prototype, sayHello函数也丢失了。</p>
<h2 id="数组深拷贝"><a href="#数组深拷贝" class="headerlink" title="数组深拷贝"></a>数组深拷贝</h2><p>数组有一些自己的深拷贝方法</p>
<h3 id="spread运算符"><a href="#spread运算符" class="headerlink" title="spread运算符"></a>spread运算符</h3><p>spread运算符是将数组或类数组对象展开成一系列用逗号隔开的值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> array_new = [...array];</div><div class="line">array_new.push(<span class="number">4</span>);</div><div class="line">alert(array); <span class="comment">//1,2,3</span></div></pre></td></tr></table></figure>
<h3 id="concat-和slice"><a href="#concat-和slice" class="headerlink" title="concat()和slice()"></a>concat()和slice()</h3><p>Array的concat()方法:先创建当前数组的一个副本，然后将接收到的参数添加到副本的末尾，最后返回新构建的数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> array_new = array.concat();</div><div class="line">array_new.push(<span class="number">4</span>);</div><div class="line">alert(array); <span class="comment">//1,2,3</span></div></pre></td></tr></table></figure>
<p>Array的slice()方法: 可以返回一个新数组，新数组是原数组的一个片段，接收1个或2个参数，第一个参数表示片段在原数组中的起始位置，第二个参数表示片段在原数组中的结束位置，如果第二个参数省略，结束位置在yuan数组的末尾项。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> array_new = array.slice(<span class="number">0</span>); <span class="comment">//不带参数与此效果一样</span></div><div class="line">array_new.push(<span class="number">4</span>);</div><div class="line">alert(array); <span class="comment">//1,2,3</span></div></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li>JavaScript高级程序设计 第3章 基本概念 3.4 数据类型</li>
<li>JavaScript高级程序设计 第5章 引用类型 5.2.6 Array类型 操作方法</li>
<li>JavaScript高级程序设计 第6章 面向对象的程序设计 6.1.3 属性特性 6.3.4 原型式继承 Object.create()</li>
<li>JavaScript高级程序设计 第20章 JSON  20.2 解析与序列化</li>
</ul>
]]></content>
      
        <categories>
            
            <category> JavaScript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[水平垂直居中方法]]></title>
      <url>/%E6%B0%B4%E5%B9%B3%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>水平垂直居中在工作中经常遇见，学习了下CSS布局，顺便总结一些水平垂直居中布局的方法。</p>
<div style="box-sizing: border-box;border: 1px solid #ff6633;
  color:#fff;
  margin: auto;
  height:200px;
  padding: 50px 0;"><div style="width: 200px;height: 100px;background-color:#ff6633;text-align:center;margin:auto;"><span style="line-height:100px;">少年锦时</span></div></div>

<a id="more"></a>
<p><br></p>
<p>利用子元素margin实现居中时要注意:</p>
<ul>
<li>水平格式化有7个相关属性：margin-left、border-left、padding-left、width、padding-right、border-right、margin-right</li>
<li>垂直格式化也有7个相关属性:margin-top、border-top、padding-top、height、padding-bottom、border-bottom、margin-bottom</li>
<li>在正常流中一个块元素的margin-top和margin-bottom设置为auto时，会自动计算为0；</li>
<li>而将会计元素的margin-left和margin-right设置为auto时，会自动计算为相等的长度；</li>
<li>所以对于定宽的块级元素margin-left:auto;margin-right：auto;可使元素水平居中。</li>
</ul>
<h3 id="一、单行文本垂直居中"><a href="#一、单行文本垂直居中" class="headerlink" title="一、单行文本垂直居中"></a>一、单行文本垂直居中</h3><p><strong>利用line-height + text-align</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>少年锦时<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ff6633</span>;</div><div class="line">  <span class="attribute">color</span>:<span class="number">#ff6633</span>;</div><div class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</div><div class="line">  <span class="attribute">height</span>:<span class="number">200px</span>;</div><div class="line">  <span class="attribute">text-align</span>:center;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">span</span>&#123;</div><div class="line">   <span class="attribute">line-height</span>:<span class="number">200px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="二、padding填充"><a href="#二、padding填充" class="headerlink" title="二、padding填充"></a>二、padding填充</h3><p>计算父元素与子元素宽高差，设置父元素padding<br>paddingLeft = paddingRight = (parent.width - child.width)/2<br>paddingTop = paddingBottom = (parent.height - child.height)/2 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">*&#123;</div><div class="line">  <span class="attribute">box-sizing</span>: border-box;</div><div class="line"> &#125;</div><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ff6633</span>;</div><div class="line">  <span class="attribute">color</span>:<span class="number">#fff</span>;</div><div class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</div><div class="line">  <span class="attribute">height</span>:<span class="number">200px</span>;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">50px</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.content</span>&#123;</div><div class="line">   <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">background-color</span>:<span class="number">#ff6633</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="三、margin填充"><a href="#三、margin填充" class="headerlink" title="三、margin填充"></a>三、margin填充</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">*&#123;</div><div class="line">  <span class="attribute">box-sizing</span>: border-box;</div><div class="line"> &#125;</div><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ff6633</span>;</div><div class="line">  <span class="attribute">color</span>:<span class="number">#fff</span>;</div><div class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</div><div class="line">  <span class="attribute">height</span>:<span class="number">200px</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.content</span>&#123;</div><div class="line">   <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">background-color</span>:<span class="number">#ff6633</span>;</div><div class="line">   <span class="attribute">margin</span>: <span class="number">50px</span> <span class="number">100px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="四、absolute布局的水平垂直居中"><a href="#四、absolute布局的水平垂直居中" class="headerlink" title="四、absolute布局的水平垂直居中"></a>四、absolute布局的水平垂直居中</h3><p><strong>结合position和transform水平移动</strong><br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">  <span class="attribute">position</span>: relative;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ff6633</span>;</div><div class="line">  <span class="attribute">color</span>:<span class="number">#fff</span>;</div><div class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</div><div class="line">  <span class="attribute">height</span>:<span class="number">200px</span>;</div><div class="line">  &#125;</div><div class="line"><span class="selector-class">.content</span>&#123;</div><div class="line">   <span class="attribute">position</span>: absolute;</div><div class="line">   <span class="attribute">top</span>: <span class="number">50%</span>;</div><div class="line">   <span class="attribute">left</span>: <span class="number">50%</span>;</div><div class="line">   <span class="attribute">transform</span>: <span class="built_in">translate</span>(-50%,-50%);</div><div class="line">   <span class="attribute">-webkit-transform</span>: <span class="built_in">translate</span>(-50%,-50%);</div><div class="line">   <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">background-color</span>:<span class="number">#ff6633</span>;           </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="五、IFC布局上下文的水平垂直居中"><a href="#五、IFC布局上下文的水平垂直居中" class="headerlink" title="五、IFC布局上下文的水平垂直居中"></a>五、IFC布局上下文的水平垂直居中</h3><p><strong>主要是垂直居中使用vertical-align属性</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hidden"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ff6633</span>;</div><div class="line">  <span class="attribute">color</span>:<span class="number">#fff</span>;</div><div class="line">  <span class="attribute">height</span>:<span class="number">200px</span>;</div><div class="line">  <span class="attribute">text-align</span>: center;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.hidden</span>&#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</div><div class="line">  <span class="attribute">height</span>: inherit;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.hidden</span>,<span class="selector-class">.content</span>&#123;</div><div class="line">  <span class="attribute">display</span>: inline-block;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.content</span>&#123;</div><div class="line">   <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">background-color</span>:<span class="number">#ff6633</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="六、table布局上下文下的水平垂直居中"><a href="#六、table布局上下文下的水平垂直居中" class="headerlink" title="六、table布局上下文下的水平垂直居中"></a>六、table布局上下文下的水平垂直居中</h3><p><strong>将div模拟成表格,利用单元格的vertical-align属性垂直居中，水平居中可以用text-align和margin：auto</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">    <span class="attribute">display</span>: table;</div><div class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ff6633</span>;</div><div class="line">    <span class="attribute">color</span>:<span class="number">#fff</span>;</div><div class="line">    &#125;</div><div class="line"><span class="selector-class">.row</span>&#123;</div><div class="line">    <span class="attribute">display</span>: table-cell;</div><div class="line">    <span class="attribute">text-align</span>: center;</div><div class="line">    <span class="attribute">vertical-align</span>: middle;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.col</span>&#123;</div><div class="line">   <span class="attribute">display</span>: inline-block;</div><div class="line">   <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">   <span class="attribute">background-color</span>:<span class="number">#ff6633</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="七、FFC布局上下文下的水平垂直居中"><a href="#七、FFC布局上下文下的水平垂直居中" class="headerlink" title="七、FFC布局上下文下的水平垂直居中"></a>七、FFC布局上下文下的水平垂直居中</h3><p><strong>利用flex布局的justify-content和align-items</strong><br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">    <span class="attribute">display</span>: flex;</div><div class="line">    <span class="attribute">justify-content</span>: center;</div><div class="line">    <span class="attribute">align-items</span>: center;</div><div class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ff6633</span>;</div><div class="line">    <span class="attribute">color</span>:<span class="number">#fff</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.content</span>&#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">    <span class="attribute">background-color</span>:<span class="number">#ff6633</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面的这些方法按css布局分个类能加深一些理解<br><img src="/images/center/css布局.png" alt=""></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Visual_formatting_model" target="_blank" rel="external">视觉格式化模型</a></li>
<li><a href="https://www.w3.org/TR/CSS2/visuren.html" target="_blank" rel="external">Visual formatting model</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> CSS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[call、apply和bind函数的polyfill实现]]></title>
      <url>/call%E3%80%81apply%E5%92%8Cbind%E5%87%BD%E6%95%B0%E7%9A%84polyfill%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">'chen'</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = &#123;</div><div class="line">	<span class="attr">name</span>: <span class="string">'chang'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params">age,sex</span>)</span>&#123;</div><div class="line">	alert(<span class="keyword">this</span>.name + age + sex);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里有一个对象foo，一个函数sayHello，如果直接调用sayHello(),结果是弹出<code>chenundefinedundefined</code><br>我们希望调用函数sayHello,this能指向foo,通过this.name获得foo.name.<br><a id="more"></a><br>Javascript提供了几个改变函数this指向的方法，call、apply和ES5提出的bind.<br>如果我们要寄己实现这些方法的polyfill呢，我们知道作为对象的方法调用，方法内的this是指向对象实例的。<br>如果想让函数的this指向对象foo,可以让sayHello成为foo的属性，但在调用完成后要delete这个属性。</p>
<p>实现中要注意一点：</p>
<ul>
<li>在非严格模式下使用函数的apply()或call()方法时，第一个参数为null或undefined时，会被转换为全局对象，也就是在浏览器中this指向window            </li>
<li>在严格模式下，函数的this值始终是指定的值，也就是说第一个参数指定是null,this就是null。（JavaScript高级程序设计 附录B 严格模式 B.7 抑制this）</li>
</ul>
<p>那么执行下面代码会报错</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="meta">	'use strict'</span></div><div class="line">	sayHello.apply(<span class="literal">null</span>,[<span class="number">27</span>,<span class="string">'男'</span>])</div><div class="line">&#125;)()</div></pre></td></tr></table></figure>
<pre style="color:red">Uncaught TypeError: Cannot read property 'name' of null</pre>

<p>这里都按非严格模式来实现</p>
<h2 id="call函数"><a href="#call函数" class="headerlink" title="call函数"></a>call函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.call_ = <span class="function"><span class="keyword">function</span>(<span class="params">ctx</span>)</span>&#123;</div><div class="line">	ctx = ctx || <span class="built_in">window</span>;</div><div class="line">    ctx.fn = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">let</span> args = [];</div><div class="line">    <span class="keyword">let</span> length = <span class="built_in">arguments</span>.length;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>;i&lt;length;i++)&#123;</div><div class="line">    	args.push(<span class="built_in">arguments</span>[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> result = ctx.fn(...args);</div><div class="line">    <span class="keyword">delete</span> ctx.fn;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//调用</span></div><div class="line">sayHello.call_(foo,<span class="number">25</span>,<span class="string">'女'</span>)  <span class="comment">//chang25女</span></div><div class="line">sayHello.call_(<span class="literal">null</span>,<span class="number">27</span>,<span class="string">'男'</span>) <span class="comment">//chen27男</span></div></pre></td></tr></table></figure>
<h2 id="apply函数"><a href="#apply函数" class="headerlink" title="apply函数"></a>apply函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.apply_ = <span class="function"><span class="keyword">function</span>(<span class="params">ctx</span>)</span>&#123;</div><div class="line">	ctx = ctx || <span class="built_in">window</span>;</div><div class="line">	ctx.fn = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">let</span> args = <span class="built_in">arguments</span>[<span class="number">1</span>] || [];</div><div class="line">    <span class="keyword">let</span> result = ctx.fn(...args);</div><div class="line">    <span class="keyword">delete</span> ctx.fn;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//调用</span></div><div class="line">sayHello.apply_(foo,[<span class="number">25</span>,<span class="string">'女'</span>])  <span class="comment">//chang25女</span></div><div class="line">sayHello.apply_(<span class="literal">null</span>,[<span class="number">27</span>,<span class="string">'男'</span>]) <span class="comment">//chen27男</span></div></pre></td></tr></table></figure>
<h2 id="bind函数"><a href="#bind函数" class="headerlink" title="bind函数"></a>bind函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.bind_ = <span class="function"><span class="keyword">function</span>(<span class="params">ctx</span>)</span>&#123;</div><div class="line">	<span class="keyword">let</span> _this = <span class="keyword">this</span>; <span class="comment">//this指向Function实例，即调用bind_的函数</span></div><div class="line">	<span class="keyword">let</span> outerArgs = <span class="built_in">Array</span>.prototype.slice.call_(<span class="built_in">arguments</span>,<span class="number">1</span>);</div><div class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">let</span> innerArgs = <span class="built_in">Array</span>.prototype.slice.call_(<span class="built_in">arguments</span>);</div><div class="line">		<span class="keyword">let</span> finalArgs = outerArgs.concat(innerArgs);</div><div class="line">		_this.apply_(ctx,finalArgs);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//调用</span></div><div class="line">fn = sayHello.bind_(foo,<span class="number">25</span>);</div><div class="line">fn(<span class="string">'女'</span>)  <span class="comment">//chang25女</span></div><div class="line"></div><div class="line">fn = sayHello.bind_(<span class="literal">null</span>,<span class="number">27</span>);</div><div class="line">fn(<span class="string">'男'</span>)  <span class="comment">//chen27男</span></div></pre></td></tr></table></figure>
<p><strong>注意</strong></p>
<ul>
<li>ctx是要改变的函数内部的执行环境，即this指向</li>
<li>每个函数在被调用时都会自动取得两个特殊变量：this和arguments,内部函数在搜索这两个变量时，只会搜索到其活动对象为止，永远不可能访问到外部函数中的这两个变量。如果想访问作用域链中的this和arguments，必须将他们的对象引用保存在另一个闭包能访问到的变量中。</li>
<li>ES6提供spread运算符 …，可将数组或类数组对象展开成一系列用逗号隔开的值</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li>JavaScript高级程序设计 第5章  引用类型 5.5.4  函数内部属性   this和arguments</li>
<li>JavaScript高级程序设计 第5章  引用类型 5.5.5  函数属性和方法 call()和apply()</li>
<li>JavaScript高级程序设计 第7章  函数表达式 7.2.2 （闭包）关于this对象）</li>
<li>JavaScript高级程序设计 第22章 高级技巧 22.1.4 函数绑定bind()</li>
</ul>
]]></content>
      
        <categories>
            
            <category> JavaScript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用Hexo+GitHub搭建静态博客]]></title>
      <url>/%E4%BD%BF%E7%94%A8Hexo+GitHub%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<p>一直都想有个自己的空间写写东西，现在终于动起来啦~<br>网上找了好久的教程，选择方案也有很多，最后还是觉得基于GitHub，用Hexo来搭建最省事。（ps: 一开始还想自己写个主题来着，后来写哭了。。太费时费力）<br>关于主题的选择也是纠结了很久，一直找不到喜欢的主题，这个博客主题也是无意在一个网友的个人博客看到的，有了喜欢的主题，我才开始搭建这个博客。。。<br><a id="more"></a><br>来记录一下博客搭建的过程吧~<br>首先，使用任何有官方的东东都别忘了去官网溜一圈，<a href="https://hexo.io/" target="_blank" rel="external">Hexo官网</a>，还有<a href="https://hexo.io/docs/" target="_blank" rel="external">官方文档</a>和<a href="https://hexo.io/themes/" target="_blank" rel="external">官网提供的主题</a><br><!-- more --></p>
<h3 id="这样只能本地查看个人博客"><a href="#这样只能本地查看个人博客" class="headerlink" title="这样只能本地查看个人博客"></a>这样只能本地查看个人博客</h3><h4 id="安装-hexo"><a href="#安装-hexo" class="headerlink" title="安装 hexo"></a>安装 hexo</h4><pre><code>npm install hexo-cli -g
</code></pre><h4 id="新建项目目录blog-并在此目录下初始化hexo"><a href="#新建项目目录blog-并在此目录下初始化hexo" class="headerlink" title="新建项目目录blog,并在此目录下初始化hexo"></a>新建项目目录blog,并在此目录下初始化hexo</h4><pre><code>mkdir blog
cd blog
hexo init
</code></pre><h4 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h4><pre><code>npm install
</code></pre><h4 id="启动hexo"><a href="#启动hexo" class="headerlink" title="启动hexo"></a>启动hexo</h4><pre><code>hexo server
</code></pre><p>命令行会有提示，在浏览器地址栏输入<a href="http://localhost:4000，就能看到hexo的实例页面。" target="_blank" rel="external">http://localhost:4000，就能看到hexo的实例页面。</a></p>
<h3 id="这样就能让别人看到你的博客"><a href="#这样就能让别人看到你的博客" class="headerlink" title="这样就能让别人看到你的博客"></a>这样就能让别人看到你的博客</h3><h4 id="GitHub新建项目"><a href="#GitHub新建项目" class="headerlink" title="GitHub新建项目"></a>GitHub新建项目</h4><p>项目的名字得是这样： chang20159.github.io ，chang20159是github的账号</p>
<h4 id="编辑hexo的配置文件-config-yml"><a href="#编辑hexo的配置文件-config-yml" class="headerlink" title="编辑hexo的配置文件 _config.yml"></a>编辑hexo的配置文件 _config.yml</h4><pre><code># Deployment
## Docs: https://hexo.io/docs/deployment.html
deploy:
  type: git
  repo: git@github.com:chang20159/chang20159.github.io.git
  branch: master
</code></pre><p>注意：   </p>
<ul>
<li>type、repo、branch的前面有两个空格，后面的:后面有一个空格    </li>
<li>repo的值是上面创建的项目的github仓库地址<br>这样就把项目关联到这个github项目上了。</li>
</ul>
<h4 id="部署hexo"><a href="#部署hexo" class="headerlink" title="部署hexo"></a>部署hexo</h4><p>首先要安装git插件，这样才能把本地资源部署到github服务器上 </p>
<pre><code>npm install hexo-deployer-git --save
</code></pre><p>然后执行</p>
<pre><code>hexo deploy
</code></pre><p>现在可以打开<a href="https://chang20159.github.io/，并且别人也可以来访问了。" target="_blank" rel="external">https://chang20159.github.io/，并且别人也可以来访问了。</a></p>
<h3 id="写博客"><a href="#写博客" class="headerlink" title="写博客"></a>写博客</h3><p>发布的文章都在soource/_posts目录下，要写一篇文章可以直接在这个目录下新建一个markdown文件，也可以用这个命令</p>
<pre><code>hexo new &quot;使用Hexo+GitHub搭建静态博客&quot;
</code></pre><p>写好之后保存下来，依次执行下面的命令：</p>
<pre><code>hexo clean
hexo generate
hexo server
hexo deploy
</code></pre><p><a href="https://chang20159.github.io/就能看到最新文章。" target="_blank" rel="external">https://chang20159.github.io/就能看到最新文章。</a></p>
<p>可以先在本地写好再部署，执行hexo server后，在本地修改是可以实时更新到<a href="http://localhost:4000的" target="_blank" rel="external">http://localhost:4000的</a></p>
<h3 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h3><p>hexo默认的主题是landscape,我使用的主题是hexo-theme-next</p>
<h4 id="下载主题"><a href="#下载主题" class="headerlink" title="下载主题"></a>下载主题</h4><p>找到喜欢的主题，从github上clone到themes目录下，<a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external">https://github.com/iissnan/hexo-theme-next</a></p>
<h4 id="配置主题"><a href="#配置主题" class="headerlink" title="配置主题"></a>配置主题</h4><p>编辑_config.yml文件</p>
<pre><code># Extensions
## Plugins: https://hexo.io/plugins/
## Themes: https://hexo.io/themes/
theme: hexo-theme-next
</code></pre><p>theme的值设置成主题名，保存后重新部署就好了。<br>hexo-theme-next这个主题功能蛮强大的，现在有三种页面模式，改一个配置相当于换一个主题，只要在主题的配置文件中设置这个字段</p>
<pre><code># Schemes
# scheme: Muse
# scheme: Mist
scheme: Pisces
</code></pre><p>它还有很全的配置文档。</p>
<ul>
<li><a href="http://notes.iissnan.com/" target="_blank" rel="external">hexo-theme-next 作者博客</a></li>
<li><a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external">hexo-theme-next GitHub</a></li>
<li><a href="http://theme-next.iissnan.com/" target="_blank" rel="external">hexo-theme-next 配置文档</a></li>
</ul>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><ul>
<li><a href="http://www.jianshu.com/p/ce1619874d34" target="_blank" rel="external">静态博客框架之Hexo &amp; Jekyll</a></li>
<li><a href="https://maintao.com/2014/hexo-theme-from-scratch/" target="_blank" rel="external">从零开始定制hexo主题</a></li>
<li><a href="https://segmentfault.com/a/1190000005590795" target="_blank" rel="external">手把手教从零开始在GitHub上使用Hexo搭建博客教程(一)-附GitHub注册及配置</a></li>
<li><a href="https://segmentfault.com/a/1190000005609509" target="_blank" rel="external">手把手教从零开始在GitHub上使用Hexo搭建博客教程(二)-Hexo参数设置</a></li>
<li><a href="https://www.aswifter.com/2016/01/18/hexo-themes/" target="_blank" rel="external">Hexo博客主题推荐</a></li>
<li><a href="https://leancloud.cn/" target="_blank" rel="external">leancloud官网</a></li>
<li><a href="http://duoshuo.com/" target="_blank" rel="external">多说官网</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 静态博客 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> GitHub </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JavaScript基础笔记]]></title>
      <url>/JavaScript%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<p>基础很重要，基础很重要，基础很重要，基础很重要，基础很重要，基础很重要，基础很重要，重要的事情要说N遍！</p>
<a id="more"></a>
<h2 id="原始值与对象"><a href="#原始值与对象" class="headerlink" title="原始值与对象"></a>原始值与对象</h2><h3 id="原始值"><a href="#原始值" class="headerlink" title="原始值"></a>原始值</h3><p>JavaScript中的原始值有：undefined、null、字符串、数字、布尔值。对象有函数、数组等。对象可以访问自己的属性和方法，原始值也可以访问属性和方法    </p>
<pre><code>&gt; var str = &quot;chang&quot;;
str.concat(&quot;20159&quot;);
&lt; &quot;chang20159&quot;
</code></pre><h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><p>ECMA-262 把对象定义为:“无序属性的集合，其属性可以包含基本值、对象或者函数。每个对象都是基于一个引用类型创建的</p>
<h4 id="对象属性"><a href="#对象属性" class="headerlink" title="对象属性"></a>对象属性</h4><p><strong>添加属性</strong></p>
<pre><code>profile.age = 100;
</code></pre><p><strong>删除属性</strong></p>
<pre><code>delete profile.name;
</code></pre><p><strong>设置属性值</strong> </p>
<pre><code>profile.age = 24;
</code></pre><p><strong>查看属性值</strong></p>
<ul>
<li>. 点运算符  book.name</li>
<li><p>[]运算符  book[‘name’]  []括号内必须是字符串或可转为字符串</p>
<p>  profile.age;<br>  或 profile[“age”];</p>
</li>
</ul>
<p><strong>检测属性</strong></p>
<p>in运算符用来检测对象中是否包含属性（自有属性和继承属性）</p>
<pre><code>&quot;age&quot; in profile
</code></pre><p>可以用对象的hasOwnProperty()检测是否自有属性</p>
<pre><code>profile.hasOwnProperty(&quot;age&quot;);
profile.hasOwnProperty(&quot;toString&quot;);
</code></pre><p>注意：   </p>
<ul>
<li>全局范围内定义的属性无法删除</li>
<li>delete运算符只能删除自有属性，不能删除继承属性</li>
</ul>
<h4 id="属性特性"><a href="#属性特性" class="headerlink" title="属性特性"></a>属性特性</h4><p>1、数据属性特性</p>
<ul>
<li>[[Configurable]] 是否可配置</li>
<li>[[Enumerable]]   是否可枚举（for…in）</li>
<li>[[Writable]]     是否可修改属性值</li>
<li>[[Value]]        属性的数据值</li>
</ul>
<p>2、访问器属性特性</p>
<ul>
<li>[[Configurable]] 是否可配置</li>
<li>[[Enumerable]]   是否可枚举（for…in）</li>
<li>[[Get]]         读取属性时调用</li>
<li>[[Set]]         写入属性时调用</li>
</ul>
<p><strong>相关方法</strong>    </p>
<ul>
<li><code>Object.defineProperty(object,name,{..属性特性})</code>  设置属性特性</li>
<li><code>Object.defineProperties(object,{..})</code>  设置属性特性</li>
<li><code>Object.getOwnPropertyDescriptor(object,name)</code> 获得自有属性的特性</li>
</ul>
<p>例: 下面定义了一个对象的属性，p是没有自有属性的，使用Object.defineProperty（）方法后创建了自有属性，x和y是数据属性，z是访问器属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="built_in">Object</span>.defineProperties(&#123;&#125;,&#123;</div><div class="line">    <span class="attr">x</span>: &#123; <span class="attr">value</span>:<span class="number">1</span>, <span class="attr">writable</span>:<span class="literal">true</span>,<span class="attr">enumerable</span>:<span class="literal">true</span>,<span class="attr">configurable</span>:<span class="literal">true</span>&#125;,</div><div class="line">    <span class="attr">y</span>: &#123; <span class="attr">value</span>:<span class="number">2</span>, <span class="attr">writable</span>:<span class="literal">true</span>,<span class="attr">enumerable</span>:<span class="literal">true</span>,<span class="attr">configurable</span>:<span class="literal">true</span>&#125;,</div><div class="line">    <span class="attr">z</span>: &#123;</div><div class="line">        <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="keyword">this</span>.x * <span class="keyword">this</span>.x + <span class="keyword">this</span>.y * <span class="keyword">this</span>.y )&#125;,</div><div class="line">        <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">val</span>)</span>&#123;<span class="keyword">this</span>.x=val&#125;,</div><div class="line">        <span class="attr">enumerable</span>:<span class="literal">true</span>,</div><div class="line">        <span class="attr">configurable</span>:<span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="原始值与对象的区别"><a href="#原始值与对象的区别" class="headerlink" title="原始值与对象的区别"></a>原始值与对象的区别</h3><ul>
<li>原始值是不可变的，对象是可修改的。</li>
<li>相同值的原始值和对象相等但不严格相等</li>
<li>对于字符串来说，原始值的数据类型是string,对象的数据类型是object </li>
</ul>
<p>代码如下:</p>
<pre><code>var str1 = &quot;chang&quot;;
var str2 = new String(&quot;chang&quot;);
console.log(&quot;str1 == str2&quot;,str1 == str2);
console.log(&quot;str1 === str2&quot;,str1 === str2);
console.log(&quot;typeof str1 :&quot;, typeof str1);
console.log(&quot;typeof str2 :&quot;, typeof str2);

str1 == str2 true
str1 === str2 false
typeof str1 : string
typeof str2 : object
</code></pre><p><strong>注: typeof的返回值一般是这些： number,string, boolean,object,function,undefined</strong></p>
<h2 id="基本包装类型"><a href="#基本包装类型" class="headerlink" title="基本包装类型"></a>基本包装类型</h2><p>ECMAScript提供3个特殊的引用类型： Boolean、Number、String</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s1 = <span class="string">"some text"</span>;</div><div class="line"><span class="keyword">var</span> s2 = s1.substring(<span class="number">2</span>);</div></pre></td></tr></table></figure>
<p>变量s1是包含一个字符串”some text”，字符串是基本数据类型，为什么在第二行可以调用substring方法？</p>
<p>执行第二行代码时会做下面几个操作：</p>
<ul>
<li>创建一个String类型的实例</li>
<li>在实例上调用指定方法</li>
<li>销毁这个实例</li>
</ul>
<p>相当于：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s1 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"some text"</span>);</div><div class="line"><span class="keyword">var</span> s2 = s1.substring(<span class="number">2</span>);</div><div class="line">s1 = <span class="literal">null</span>;</div></pre></td></tr></table></figure>
<p><strong>引用类型与基本包装类型的主要区别就是对象的生存期。</strong></p>
<ul>
<li>new操作符创建的引用类型实例在离开执行环境前一直保存在内存中</li>
<li><p>自动创建的基本包装类型的对象只存在与一行代码的执行瞬间</p>
<p>  例如下面第三行代码是访问不到color属性的，因为在第二行执行结束就已经销毁了实例</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var s1 = &quot;some text&quot;;</div><div class="line">s1.color = &quot;red&quot;;</div><div class="line">alert(s1.color);   //undefined</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="单体内置对象"><a href="#单体内置对象" class="headerlink" title="单体内置对象"></a>单体内置对象</h2><p>内置对象不必显示实例化</p>
<h3 id="Global对象"><a href="#Global对象" class="headerlink" title="Global对象"></a>Global对象</h3><p>所有在全局作用域中定义的属性和函数，都是Global对象的属性。浏览器实现了承担该角色的window对象。</p>
<ul>
<li><code>isNaN()</code></li>
<li><code>isFinite()</code></li>
<li><code>parseInt()</code></li>
<li><code>parseFloat()</code></li>
<li><p><code>encodeURI()/encodeURI()</code></p>
<p>  用于对整个URI编码/解码，不会对本身属于URI的特殊字符进行编码/解码，<br>  例如冒号(:)、正斜杠（/ ）、问号(?)、井号(#) </p>
</li>
<li><p><code>encodeURIComponent()/decodeURIComponent()</code></p>
<p>  用于对URI中的某一段编码/解码。一般情况下使用encodeURIComponent()方法要比 encodeURI()多，因为实践中最常见的是对查询字符串参数而不是对基础URL编码 。</p>
</li>
<li><p><code>eval()</code></p>
<p>像一个JS解析器。接收一个参数，即要执行的JS字符串</p>
</li>
</ul>
<h3 id="Math对象"><a href="#Math对象" class="headerlink" title="Math对象"></a>Math对象</h3><p>常用方法：</p>
<ul>
<li><code>Math.min()、Math.max()</code></li>
<li><code>Math.ceil()</code></li>
<li><code>Math.floor()</code></li>
<li><code>Math.round()</code></li>
<li><code>Math.random()</code></li>
<li><code>Math.abs()</code></li>
<li><code>Math.exp()</code></li>
<li><code>Math.power()</code></li>
<li><code>Math.sqrt()</code></li>
</ul>
<p><strong>Math.random()在随机显示的场景很有用，从某个整数范围内随机取一个值：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">值 = Math.random() * 可能值总数 + 第一个可能的值</div></pre></td></tr></table></figure>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="函数声明与函数表达式"><a href="#函数声明与函数表达式" class="headerlink" title="函数声明与函数表达式"></a>函数声明与函数表达式</h3><p>解析器在向执行环境加载数据时，会先读取函数声明（函数声明提升），使其在执行任何代码之前可用。</p>
<p>函数表达式必须等解析器执行到它所在的代码行才会被解释执行。 </p>
<h3 id="函数内部属性"><a href="#函数内部属性" class="headerlink" title="函数内部属性"></a>函数内部属性</h3><p>函数内部有两个特殊对象：arguments 和 this</p>
<h4 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h4><p>一个类数组对象</p>
<ul>
<li><p><strong>arguments.callee</strong></p>
<p>  是一个指针，指向拥有这个arguments对象的函数。<br>  严格模式下不能访问arguments.callee，会报错。<br>  注意:函数名仅是一个包含指针的变量，在函数内部使用函数名调用自身时，引用函数名不能改变。</p>
</li>
<li><p><strong>arguments.caller</strong></p>
<p>  ES5定义这个属性，只是为了区分函数的caller属性。<br>  严格模式下访问会报错，非严格模式下这个属性始终是undefined。</p>
</li>
<li><p>arguments.length<br>  参数长度</p>
</li>
</ul>
<h4 id="this"><a href="#this" class="headerlink" title="this"></a>this</h4><p>this引用的是函数执行的环境对象（作用域）</p>
<h3 id="函数属性"><a href="#函数属性" class="headerlink" title="函数属性"></a>函数属性</h3><ul>
<li><p>name</p>
<p>  函数名称</p>
</li>
<li><p>caller</p>
<p>  保存调用当前函数的函数的引用。<br>  在函数内部访问方式有两种：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee.caller)</div><div class="line">&#125;</div><div class="line">	</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(func.caller)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>length</p>
<p>  length属性表示函数接收的命名参数的个数</p>
</li>
<li><p>prototype</p>
<p>对于JS中的引用类型，prototype通常是用于保存实例方法。在创建自定义引用类型及实现继承时，prototype属性很重要。prototype属性有一个唯一属性：constructor，指向拥有此prototype的函数。</p>
</li>
</ul>
<h3 id="函数的方法"><a href="#函数的方法" class="headerlink" title="函数的方法"></a>函数的方法</h3><p>每个函数都包含3个非继承而来的方法，可用于设置函数体内this对象的值。</p>
<ul>
<li>apply(this,[array])</li>
<li>call(this,arg1,arg2,…)</li>
<li><p>bind(this，arg1，arg2) </p>
<p>  创建一个函数的实例this，this值会绑定到传入的this值。</p>
</li>
</ul>
<h2 id="什么是闭包？"><a href="#什么是闭包？" class="headerlink" title="什么是闭包？"></a>什么是闭包？</h2><p>每一段Js代码都有一个与之关联的作用域链，对于一个函数，函数定义时的作用域链在函数执行时依然有效，当函数执行时可以访问作用域链上的变量，而且无论这个函数将来在哪里执行都能够访问到函数定义时的作用域链中的变量。</p>
<p>函数的作用域链上除了函数本身的作用域对象之外，有最外层的全局作用域，还可能有外层函数的作用域，这种可以访问另一个函数作用域或全局作用域中的变量的函数就是一个闭包。</p>
<p>从这个角度讲，所有的Javascript函数都是闭包。</p>
<p>闭包的形成可归因于： JS的词法作用域和作用域链。（作用域链上有其他外层函数的作用域，函数可逐层搜索变量）</p>
<hr>
<p>下面是之前整理的对于闭包的理解，先放着。</p>
<p>理解闭包先得理解词法作用域和作用域链<br><strong>词法作用域</strong><br>函数执行依赖于变量作用域，这个作用域是在函数定义是决定的，不是在函数调用时决定的。<br>为了实现这种词法作用域，javascript函数对象内部不仅包含函数的代码逻辑，还必须引用当前的作用域链<br><strong>作用域链</strong></p>
<ul>
<li>javascript是基于词法作用域的语言，每一段代码（全局代码或函数）都有一个与之关联的作用域链，这个作用域链是一个对象链表。</li>
<li>在javascript最顶层的代码中，作用域链由一个全局对象组成 </li>
<li>在不包含嵌套的函数体内，作用域上有两个对象，第一个是定义函数参数和局部变量的对象,第二个是全局对象</li>
<li>在一个嵌套的函数体内，作用域链上至少有三个对象。</li>
<li>当定义一个函数时，它实际上会保存一个作用域链。</li>
<li>当调用这个函数时，它创建一个新的对象来存储它的局部变量，并将这个对象添加至它保存的作用域链上，同时创建一个新的更长的表示函数调用作用域的链</li>
<li><strong>对于嵌套函数，每次调用外部函数时，内部函数又会重新定义一遍，因为每次调用外部函数时作用域链都是不同的。</strong></li>
</ul>
<p>闭包 由函数和函数定义是的作用域链组成<br>所有的javascript函数都是闭包，<strong>闭包就是函数定义时的作用域链在函数执行时依然有效。</strong></p>
<p>根据以上规则，看看下面输出什么</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> count = <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">cal</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> num= <span class="number">0</span></div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'num'</span>,num++)</div><div class="line">         <span class="built_in">console</span>.log(<span class="string">'count'</span>,count++ ) ;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> cal;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> func1 = func();    <span class="comment">//每次调用func都会创建一个新的作用域链和新的私有变量</span></div><div class="line"><span class="keyword">var</span> func2 = func();   <span class="comment">//func1与func2互不影响</span></div><div class="line">func()();  <span class="comment">//num 0  count 0</span></div><div class="line">func()();  <span class="comment">//num 0  count 0</span></div><div class="line">func1();   <span class="comment">//num 0  count 0</span></div><div class="line">func1();   <span class="comment">//num 0  count 1</span></div><div class="line">func2();   <span class="comment">//num 0  count 0</span></div><div class="line">func2();   <span class="comment">//num 0  count 1</span></div></pre></td></tr></table></figure>
<p>javascript是基于词法作用域的，函数的作用域在函数定义时就决定了，如果一个函数内部有一个嵌套函数，并将这个函数返回了，那这个返回的函数韩式可以访问定义时就决定的作用域链，所以这个返回的函数在父函数外部能访问到父函数内部的变量，这样这个函数就形成了一个闭包。</p>
<h2 id="垃圾回收机制"><a href="#垃圾回收机制" class="headerlink" title="垃圾回收机制"></a>垃圾回收机制</h2><ul>
<li><p><strong>标记清除</strong></p>
<p>  JavaScript中最常用的垃圾回收方式，回收被标记的（需要回收的）变量。</p>
<p>  垃圾回收器在运行时，给存储在内存中的所有变量都添加标记，然后去掉环境中的变量以及被环境中的变量引用的变量的标记。在此之后再被加上标记的变量将被视为准备删除的变量，最后垃圾回收器消除那些带标记的值并回收内存空间。</p>
<p>  目前各大浏览器都是采用标记清除式策略，不过垃圾回收的时间间隔不同。</p>
</li>
<li><p><strong>引用计数</strong></p>
<p>跟踪记录每个值被引用的次数。</p>
<p>如果一个值的被引用次数变成0，说明不能再访问到这个值了，就可以将占用的内存回收。垃圾回收器运行时会释放那些引用次数为0的值所占用的内存。</p>
<p>IE中有一部分对象并不是原生Javascript对象，例如BOM、DOM中的对象是使用C++以COM（组件对象模型）对象的形式实现的。而COM对象的垃圾回收机制采用的是引用计数策略。尽管IE的JS引擎是使用标记清除策略，但JS访问的COM对象依然基于引用计数策略。</p>
<p>当出现循环引用时，引用计数永远不会是0，当被多次调用时，会有大量内存得不到回收，容易造成内存泄漏。在IE中只要涉及COM对象就容易出现循环引用的问题。</p>
<p>  例如：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">"some_element"</span>);</div><div class="line"><span class="keyword">var</span> myObject = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">myObject.element = element;</div><div class="line">element.someObject = myObject;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>  导致循环引用的情况不止如此。</p>
<p>  为解决此问题，IE9把BOM和DOM对象都转成了真正的Javasript对象，避免了常见的内存泄漏现象。 </p>
<h2 id="对象-1"><a href="#对象-1" class="headerlink" title="对象"></a>对象</h2><h3 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h3><h4 id="对象直接量"><a href="#对象直接量" class="headerlink" title="对象直接量"></a>对象直接量</h4><p>对象原型：Object.prototype</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> person = &#123;</div><div class="line">    <span class="attr">name</span> : <span class="string">'chang'</span>,</div><div class="line">    <span class="attr">age</span> : <span class="number">25</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h4><p>用函数来封装创建特定对象的细节，虽然能解决创建多个相似对象的问题，但不能解决对象识别的问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span>(<span class="params">name, age, job</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">        o.name = name;</div><div class="line">        o.age = age;</div><div class="line">        o.job = job;</div><div class="line">        o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            alert(<span class="keyword">this</span>.name);</div><div class="line">    &#125;;</div><div class="line">	<span class="keyword">return</span> o; </div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> person1 = createPerson(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</div><div class="line"><span class="keyword">var</span> person2 = createPerson(<span class="string">"Greg"</span>, <span class="number">27</span>, <span class="string">"Doctor"</span>);</div></pre></td></tr></table></figure>
<h4 id="构造函数模式"><a href="#构造函数模式" class="headerlink" title="构造函数模式"></a>构造函数模式</h4><p>构造函数模式可以创建特定类型(自定义的构造函数)的对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.age = age;</div><div class="line">    <span class="keyword">this</span>.job = job;</div><div class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(<span class="keyword">this</span>.name);</div><div class="line">    &#125;; </div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</div><div class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">"Greg"</span>, <span class="number">27</span>, <span class="string">"Doctor"</span>);</div></pre></td></tr></table></figure>
<p>注意：构造函数应该以大写字母开头，非构造函数应该以小写字母开头，主要是为了区分。</p>
<p>要创建Person的实例，必须使用new操作符。用这种方式调用构造函数会经历4个步骤：</p>
<ul>
<li>创建一个新对象</li>
<li>将构造函数的作用域赋给新对象，即this指向这个新对象</li>
<li>执行构造函数中代码，为新对象添加属性</li>
<li>返回新对象</li>
</ul>
<h5 id="将构造函数当做函数"><a href="#将构造函数当做函数" class="headerlink" title="将构造函数当做函数"></a>将构造函数当做函数</h5><p>构造函数也是函数，任何函数用new操作符来调用，它就是一个构造函数。不用new操作符调用就是一个普通函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//当做构造函数使用 </span></div><div class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>); </div><div class="line">person.sayName(); <span class="comment">//"Nicholas"</span></div><div class="line"></div><div class="line"><span class="comment">//当普通函数调用，在全局环境中调用一个函数时，this对象重视指向Global对象</span></div><div class="line">Person(<span class="string">"Greg"</span>, <span class="number">27</span>, <span class="string">"Doctor"</span>); <span class="comment">//this指向window window.sayName()</span></div><div class="line"></div><div class="line"><span class="comment">// 在另一个对象的作用域中调用</span></div><div class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">Person.call(o, <span class="string">"Kristen"</span>, <span class="number">25</span>, <span class="string">"Nurse"</span>); o.sayName(); <span class="comment">//"Kristen"</span></div></pre></td></tr></table></figure>
<h5 id="使用构造函数创建的问题"><a href="#使用构造函数创建的问题" class="headerlink" title="使用构造函数创建的问题"></a>使用构造函数创建的问题</h5><p>使用构造函数的一个主要问题是：</p>
<blockquote>
<p>每个方法在每个实例上都要重新创建一次。我们知道，函数也是对象，在前面的例子中，person1和person2都有一个Function的实例sayName，但person1.sayName != person2.sayName，他们的作用域链不同，标识符解析也不同。</p>
</blockquote>
<p>创建两个完成相同功能的Function实例是没有必要的。因而我们可以像这样把方法提出来：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.age = age;</div><div class="line">    <span class="keyword">this</span>.job = job;</div><div class="line">    <span class="keyword">this</span>.sayName = sayName;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayName</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    alert(<span class="keyword">this</span>.name);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</div><div class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">"Greg"</span>, <span class="number">27</span>, <span class="string">"Doctor"</span>);</div></pre></td></tr></table></figure>
<p>在全局作用域定义方法，这样person1和person2就可以共享一个方法。但是这样所有的方法都得在全局作用域中定义，而且只能给特定对象使用，显然也不合理。</p>
<p>我们可以使用原型模式来解决这个问题</p>
<h4 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h4><p>将属性和方法都添加到构造函数的prototype属性中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"></div><div class="line">Person.prototype.name = <span class="string">"Nicholas"</span>;</div><div class="line">Person.prototype.age = <span class="number">29</span>;</div><div class="line">Person.prototype.job = <span class="string">"Software Engineer"</span>;</div><div class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    alert(<span class="keyword">this</span>.name);</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</div><div class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person();</div><div class="line">person1.name = <span class="string">"Greg"</span>;</div><div class="line">alert(person1.name);  <span class="comment">//"Greg"</span></div><div class="line">alert(person2.name);  <span class="comment">//"Nicholas"    </span></div><div class="line"><span class="keyword">delete</span> person1.name;</div><div class="line">alert(person1.name);  <span class="comment">//"Nicholas"</span></div></pre></td></tr></table></figure>
<h5 id="原型对象"><a href="#原型对象" class="headerlink" title="原型对象"></a>原型对象</h5><p>要清楚构造函数、实例和原型对象三者之间的关系。</p>
<ul>
<li>每个函数都有一个prototype属性，prototype属性是一个指针，指向函数的原型对象</li>
<li>所有原型对象默认都有一个constructor属性，这个属性指向prototype所属的构造函数。</li>
<li>当调用构造函数创建一个新实例后，这个实例内部有一个指针[[Prototype]]指向构造函数的原型对象。</li>
</ul>
<p>注意：</p>
<ul>
<li>我们可以通过对象实例访问原型中的值，但不能重写原型中的值。</li>
<li>当为对象实例添加一个属性时，会屏蔽原型中的同名属性。</li>
<li>即使给该属性赋值null也不行，使用delete操作符可以完全删除实例属性</li>
</ul>
<h5 id="判断是否是原型中的属性"><a href="#判断是否是原型中的属性" class="headerlink" title="判断是否是原型中的属性"></a>判断是否是原型中的属性</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasPrototypeProperty</span>(<span class="params">object, name</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> !object.hasOwnProperty(name) &amp;&amp; (name <span class="keyword">in</span> object);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="实例属性与原型属性相关操作符和方法"><a href="#实例属性与原型属性相关操作符和方法" class="headerlink" title="实例属性与原型属性相关操作符和方法"></a>实例属性与原型属性相关操作符和方法</h5><ul>
<li><code>in 和 for...in</code>  所有能够访问到的属性（实例属性、原型属性）</li>
<li><code>hasOwnProperty()</code> 属性是否存在于实例中</li>
<li><code>isPrototypeOf()</code> 对象是否是实例的原型对象(实例内部是否有指向该对象的指针)</li>
<li><code>Object.keys()</code>   对象上所有可枚举的实例属性</li>
<li><code>Object.getOwnPropertyNames()</code>  所有实例属性，无论是否可枚举</li>
<li><code>Object.getPrototypeOf()</code>获取实例内部[[Prototype]]指针指向的原型对象</li>
</ul>
<h5 id="重写整个原型对象的问题"><a href="#重写整个原型对象的问题" class="headerlink" title="重写整个原型对象的问题"></a>重写整个原型对象的问题</h5><p>前面的例子是逐个添加原型对象上的属性和方法，我们也可以直接给prototype对象整个赋值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"></div><div class="line">Person.prototype = &#123;</div><div class="line">    <span class="attr">name</span> : <span class="string">"Nicholas"</span>,</div><div class="line">    <span class="attr">age</span> : <span class="number">29</span>,</div><div class="line">    <span class="attr">job</span>: <span class="string">"Software Engineer"</span>,</div><div class="line">    <span class="attr">sayName</span> : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        alert(<span class="keyword">this</span>.name);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>但是这样原本Person.prototype中默认的constructor属性就没有了，当访问constructor属性时就是向上访问到Object的constructor属性，指向Object构造函数。</strong></p>
<p>也就是说，这个整体赋值，constructor属性不再是Person构造函数，而是指向Object构造函数。</p>
<p>person1 instanceof Person 还是返回true，但person1.constructor == Object  无法确定对象的类型了。</p>
<p><strong>注意： object instanceof constructor， 用来检测 constructor.prototype 是否存在于参数 object 的原型链上。</strong></p>
<h5 id="设置原型对象constructor属性的问题"><a href="#设置原型对象constructor属性的问题" class="headerlink" title="设置原型对象constructor属性的问题"></a>设置原型对象constructor属性的问题</h5><p>如果constructor很重要，可以特意设置回原本默认的值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"></div><div class="line">Person.prototype = &#123;</div><div class="line">    <span class="attr">constructor</span> : Person,</div><div class="line">    <span class="attr">name</span> : <span class="string">"Nicholas"</span>,</div><div class="line">    <span class="attr">age</span> : <span class="number">29</span>,</div><div class="line">    <span class="attr">job</span>: <span class="string">"Software Engineer"</span>,</div><div class="line">    <span class="attr">sayName</span> : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        alert(<span class="keyword">this</span>.name);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>但是，还是有问题！！这样重设的constructor属性是可枚举的，而默认情况下的原生constructor属性是不可枚举的。</strong></p>
<p>那我们还可以使用 Object.defineProperty()解决这个问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//只适用于支持ES5的浏览器  </span></div><div class="line"><span class="built_in">Object</span>.defineProperty(Person.prototype, <span class="string">"constructor"</span>, &#123;</div><div class="line">     <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">     <span class="attr">value</span>: Person</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h5 id="使用原型模式创建的问题"><a href="#使用原型模式创建的问题" class="headerlink" title="使用原型模式创建的问题"></a>使用原型模式创建的问题</h5><ul>
<li>省略了为构造函数传递初始化参数这一环节，每个实例默认情况下都有相同的属性值</li>
<li>原型对象是所有实例共享的，这个对于函数非常合适。</li>
<li>对于基本数据类型放在原型中也还没什么问题，因为包含基本值的属性会覆盖原型中的同名属性</li>
<li><p>但对于引用类型就会有问题，例如：</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">  </div><div class="line">Person.prototype = &#123;</div><div class="line">    <span class="attr">constructor</span>: Person,</div><div class="line">    <span class="attr">name</span> : <span class="string">"Nicholas"</span>,</div><div class="line">    <span class="attr">age</span> : <span class="number">29</span>,</div><div class="line">    <span class="attr">job</span> : <span class="string">"Software Engineer"</span>,</div><div class="line">    <span class="attr">friends</span> : [<span class="string">"Shelby"</span>, <span class="string">"Court"</span>],</div><div class="line">    <span class="attr">sayName</span> : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        alert(<span class="keyword">this</span>.name);</div><div class="line">&#125; &#125;;</div><div class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</div><div class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person();</div><div class="line">person1.friends.push(<span class="string">"Van"</span>);</div><div class="line">alert(person1.friends);    <span class="comment">//"Shelby,Court,Van"</span></div><div class="line">alert(person2.friends);    <span class="comment">//"Shelby,Court,Van"</span></div><div class="line">alert(person1.friends === person2.friends);  <span class="comment">//true</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="组合使用构造函数模式和原型模式"><a href="#组合使用构造函数模式和原型模式" class="headerlink" title="组合使用构造函数模式和原型模式"></a>组合使用构造函数模式和原型模式</h4><p>创建自定义类型的对象，最常用的方式是组合使用构造函数和原型，也是定义引用类型的一种默认模式。</p>
<ul>
<li><strong>构造函数模式用于定义实例属性</strong></li>
<li><strong>原型模式用于定义方法和共享的属性</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.name = name; <span class="number">3</span> <span class="keyword">this</span>.age = age;</div><div class="line">	<span class="keyword">this</span>.job = job;</div><div class="line">	<span class="keyword">this</span>.friends = [<span class="string">"Shelby"</span>, <span class="string">"Court"</span>];</div><div class="line">&#125;</div><div class="line">Person.prototype = &#123;</div><div class="line">    <span class="attr">constructor</span> : Person,</div><div class="line">    <span class="attr">sayName</span> : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(<span class="keyword">this</span>.name);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</div><div class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">"Greg"</span>, <span class="number">27</span>, <span class="string">"Doctor"</span>);</div></pre></td></tr></table></figure>
<p>在上面的例子中，实例属性都在狗在函数中定义，所有实例共享的属性constructor和方法sayName则在原型中定义。</p>
<h4 id="动态原型模式"><a href="#动态原型模式" class="headerlink" title="动态原型模式"></a>动态原型模式</h4><p>在构造函数中动态初始化原型,在第一次执行构造函数时就完成初始化了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.name = name; </div><div class="line">	<span class="keyword">this</span>.age = age; </div><div class="line">	<span class="keyword">this</span>.job = job;</div><div class="line">	</div><div class="line">	<span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.sayName != <span class="string">"function"</span>)&#123;</div><div class="line">	    Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	        alert(<span class="keyword">this</span>.name);</div><div class="line">		&#125;; </div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="寄生构造函数模式"><a href="#寄生构造函数模式" class="headerlink" title="寄生构造函数模式"></a>寄生构造函数模式</h4><p>在上面几种模式都不适用的情况下，可以使用寄生构造函数模式。</p>
<p>基本思想是创建一个函数，这个函数的作用仅仅是封装创建对象的代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">    o.name = name;</div><div class="line">    o.age = age;</div><div class="line">    o.job = job;</div><div class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(<span class="keyword">this</span>.name);</div><div class="line">    &#125;;</div><div class="line">	<span class="keyword">return</span> o; </div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> friend = <span class="keyword">new</span> Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</div><div class="line">friend.sayName();  <span class="comment">//"Nicholas"</span></div></pre></td></tr></table></figure>
<p><strong>注意： 构造函数在不返回值的情况下，默认会返回新的实例。通过在构造函数的末尾添加return语句，可以重写调用构造函数时返回的值。</strong></p>
<p>但是这种方式返回的对象与构造函数以及构造函数的原型之间没有联系。</p>
<h4 id="稳妥构造函数模式"><a href="#稳妥构造函数模式" class="headerlink" title="稳妥构造函数模式"></a>稳妥构造函数模式</h4><p>没有公共属性，方法也不引用this对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</div><div class="line">    o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        alert(name);</div><div class="line">    &#125;;</div><div class="line">	<span class="keyword">return</span> o; </div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> friend = Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</div><div class="line">friend.sayName();  <span class="comment">//"Nicholas"</span></div></pre></td></tr></table></figure>
<p>与寄生构造函数模式的不同：</p>
<ul>
<li>新创建的实例方法不引用this</li>
<li>不适用new操作符调用函数</li>
</ul>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>ECMAScript是基于原型链继承的</p>
<h3 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h3><h4 id="默认的原型"><a href="#默认的原型" class="headerlink" title="默认的原型"></a>默认的原型</h4><h4 id="原型和实例的关系"><a href="#原型和实例的关系" class="headerlink" title="原型和实例的关系"></a>原型和实例的关系</h4><h4 id="原型链的问题"><a href="#原型链的问题" class="headerlink" title="原型链的问题"></a>原型链的问题</h4><p>理解原型链，首先要清楚 构造函数、原型和实例的关系。<br>每个构造函数都有一个原型对象，原型对象都包含一个指向构造函数的指针，而实例都包含一个指向原型对象的内部指针。</p>
<p>如果这个原型对象是另一个类型的实例，那这个原型对象内部也有一个指针指向另一个原型对象，这样层层递进，就形成了最初那个实例的一个原型链。</p>
<p>注意：所有函数的默认原型都是 Object 的实例，因此默认原 型都会包含一个内部指针，指向 Object.prototype。</p>
<p>实现原型链有一种基本模式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">function SuperType()&#123;</div><div class="line">        this.property = true;</div><div class="line">&#125;</div><div class="line">SuperType.prototype.getSuperValue = function()&#123;</div><div class="line">    return this.property;</div><div class="line">&#125;;</div><div class="line">function SubType()&#123;</div><div class="line">    this.subproperty = false;</div><div class="line">&#125;</div><div class="line">//继承了 SuperType</div><div class="line">SubType.prototype = new SuperType();</div><div class="line">SubType.prototype.getSubValue = function ()&#123;</div><div class="line">    return this.subproperty;</div><div class="line">&#125;;</div><div class="line">var instance = new SubType();</div><div class="line">alert(instance.getSuperValue());</div><div class="line">//true</div></pre></td></tr></table></figure>
<p>注意<br>instance.constructor现在指向的是SuperType，因为<br>instance.constructor读取的是instance的原型对象上的constructor<br>instance的原型对象是SuperType的实例<br>SuperType的实例的constructor指向SuperType<br>所以 instance.constructor指向SuperType</p>
<p>啊 晕不晕 反正我是晕了</p>
<p>最后，原型链有哪些问题？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function SuperType()&#123;</div><div class="line">   this.colors = [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;];</div><div class="line">&#125;</div><div class="line">function SubType()&#123;&#125;</div><div class="line">//继承了 SuperType</div><div class="line">SubType.prototype = new SuperType();</div><div class="line">var instance1 = new SubType(); </div><div class="line">instance1.colors.push(&quot;black&quot;); alert(instance1.colors); //&quot;red,blue,green,black&quot;</div><div class="line">var instance2 = new SubType(); alert(instance2.colors); //&quot;red,blue,green,black&quot;</div></pre></td></tr></table></figure>
<p>可以看到SubType的原型是SuperType的实例，具有实例属性colors = [“red”, “blue”, “green”]，这是个引用类型值，instance1改变colors的值时也会影响instance2</p>
<p>两个问题：<br>1、原型链中如果包含引用类型值的，当被一个实例修改时，会反应在其他实例上，因为原型的属性是共享的<br>2、在创建子类型的实例时，没有办法在不影响所有对象实例的情况下，给超类型的构造函数传递参数</p>
<p>因此，实践中很少会单独使用原型链实现继承</p>
<h3 id="借用构造函数（经典继承）"><a href="#借用构造函数（经典继承）" class="headerlink" title="借用构造函数（经典继承）"></a>借用构造函数（经典继承）</h3><p>在子类型构造函数的内部调用超类型构造函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">function SuperType(name)&#123;</div><div class="line">    this.name = name;</div><div class="line">    this.colors = [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;];</div><div class="line">&#125;</div><div class="line">function SubType(name)&#123;</div><div class="line">    //继承了 SuperType</div><div class="line">    SuperType.call(this,name);</div><div class="line">&#125;</div><div class="line">var instance1 = new SubType(&apos;chang&apos;);</div><div class="line">instance1.colors.push(&quot;black&quot;); </div><div class="line">console.log(instance1.name)  //chang</div><div class="line">console.log(instance1.colors);    //&quot;red,blue,green,black&quot;</div><div class="line">var instance2 = new SubType(&apos;chen&apos;); //chang</div><div class="line">console.log(instance2.name)</div><div class="line">console.log(instance2.colors);    //&quot;red,blue,green&quot;</div></pre></td></tr></table></figure>
<p>通过使用call()方法或apply()方法，<br>在(未来将要)新创建 SubType 实例的环境下调用了 SuperType 构造函数,<br>让SubType的每个实例就都具有自己的 colors 属性的副本，<br>也解决了原型链中子类型无法给超类型的构造函数传递参数的问题</p>
<p>但是如果只是借用构造函数，所有的超类型都在构造函数中定义，就无法链式继承或复用了。所以一般页不会单独只借用构造函数</p>
<h3 id="原型链和构造函数组合继承"><a href="#原型链和构造函数组合继承" class="headerlink" title="原型链和构造函数组合继承"></a>原型链和构造函数组合继承</h3><p>将原型链和借用构造函数的技术组合到一块，使用原型链实现对原型属性和方 法的继承，而通过借用构造函数来实现对实例属性的继承</p>
<h3 id="原型式继承"><a href="#原型式继承" class="headerlink" title="原型式继承"></a>原型式继承</h3><h3 id="寄生式继承"><a href="#寄生式继承" class="headerlink" title="寄生式继承"></a>寄生式继承</h3><h3 id="寄生式组合式继承"><a href="#寄生式组合式继承" class="headerlink" title="寄生式组合式继承"></a>寄生式组合式继承</h3><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li>JavaScript权威指南</li>
<li>JavaScript高级程序设计</li>
</ul>
]]></content>
      
        <categories>
            
            <category> JavaScript </category>
            
        </categories>
        
        
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[隐藏元素的几种方法及应用]]></title>
      <url>/%E9%9A%90%E8%97%8F%E5%85%83%E7%B4%A0%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>隐藏元素的方法有很多，能想到的就有一大摞，像display、opacity、visibility、height、position这些属性都可以达到隐藏元素的效果，但并不是光光把元素隐藏看不见就完事儿了，还得考虑应用场景。整理了几个隐藏元素的方法，以及它们有什么区别，可用于什么样的场景。<br><a id="more"></a></p>
<p>这里主要介绍的方法有：</p>
<ul>
<li>display:none;</li>
<li>height:0;</li>
<li>opacity:0;</li>
<li>visibility:hidden;</li>
<li>HTML全局属性hidden</li>
</ul>
<p>像position:absolute;left:-9999px;这样的用法也可以隐藏元素，但我想不到它可以应用的场景，就不讲了。</p>
<h2 id="隐藏元素"><a href="#隐藏元素" class="headerlink" title="隐藏元素"></a>隐藏元素</h2><p><strong>在隐藏元素之前长这样,后面会将div2隐藏，div2隐藏的后代设置测试株连性（div2隐藏后，div2的后代是否还有可见的机会）</strong></p>
<div style="border: 2px solid #8973de;color:#fff;"><div style="width: 100%;
            height: 50px;
            background-color: #579326;">div1</div><div style="width: 100%;
            height: 100px;
            background-color: #df7832;">div2<div style="width: 100%;
            height: 50px;
            background-color: #43298d;">div2的后代</div> </div></div> 

<h3 id="display-none"><a href="#display-none" class="headerlink" title="display:none;"></a>display:none;</h3><p>为什么display:none;可以隐藏元素，看官方文档的解释：</p>
<p>display属性：指定建立布局时元素生成的显示框类型</p>
<blockquote>
<p>The display property specifies the type of box used for an element.</p>
</blockquote>
<p>display:none;</p>
<blockquote>
<p>This value causes an element to not appear in the formatting structure (i.e., in visual media the element generates no boxes and has no effect on layout). Descendant elements do not generate any boxes either; the element and its content are removed from the formatting structure entirely. This behavior cannot be overridden by setting the ‘display’ property on the descendants.<br>Please note that a display of ‘none’ does not create an invisible box; it creates no box at all. CSS includes mechanisms that enable an element to generate boxes in the formatting structure that affect formatting but are not visible themselves. Please consult the section on visibility for details.</p>
</blockquote>
<p>这段关于有display:none;的元素的解释有以下几点：<br>1、该元素不会生成box，不占据空间，直接从格式化结构中移除了<br>2、该元素的后代元素也不会生成box，即使给后代元素设置display属性为非none值也没有用<br>3、注意display:none;不是生成一个不可见的box,它根本就没有生成box<br>4、css提供了可以让元素生成一个不可见box的机制，visibility属性就可以实现这个机制</p>
<p>所以display:none;让元素不可见的原因是因为根本就没有生成box,这个元素从格式化结构中移除了</p>
<p>下面设置了div2  display:none;  div2的后代 display:block; 但都是不可见的，不占据空间，当然也不会响应交互,div2的后代无法改变不可见状态</p>
<div style="border: 2px solid #8973de;color:#fff;"><div style="width: 100%;
height: 50px;
background-color: #579326;">div1</div><div style="width: 100%;
height: 100px;
background-color: #df7832;
display:none;">div2  display:none;<div style="width: 100%;
height: 50px;
background-color: #43298d;
display:block;">div2的后代 display:block;</div> </div></div> 

<p>jquery中的hide()、show()、toggle()都是通过控制display:none实现的，使用display:none来隐藏元素会是页面重绘和回流</p>
<h3 id="visibility-hidden"><a href="#visibility-hidden" class="headerlink" title="visibility:hidden;"></a>visibility:hidden;</h3><p>visibility属性：控制由该元素生成的box是否被渲染</p>
<blockquote>
<p>The ‘visibility’ property specifies whether the boxes generated by an element are rendered. Invisible boxes still affect layout (set the ‘display’ property to ‘none’ to suppress box generation altogether)</p>
</blockquote>
<p>visibility:hidden; </p>
<blockquote>
<p>The generated box is invisible (fully transparent, nothing is drawn), but still affects layout. Furthermore, descendants of the element will be visible if they have ‘visibility: visible’.</p>
</blockquote>
<p>这段的解释是：<br>1、生成的box是完全不可见的，完全透明，没有绘制，但不影响布局，仍然占据空间。<br>2、然而这个元素的后代是可以通过设置visibility:visible变成可见的</p>
<p>下面这个就是设置了div2 visibility:hidden;  div2的后代设置了 visibility:visible; 并且给div2设置了:hover{visibility:visible; }<br>可见visibility:hidden;使元素隐藏了，但还是占据空间的,把光标放到div2占据的空白处试试看，没有反应说明隐藏后不会响应交互(将光标放在div2的后代上是可以响应交互的)，div2的后代可以设置visibility:visible;改变不可见状态</p>
<div style="border: 2px solid #8973de;color:#fff;"><div style="width: 100%;
height: 50px;
background-color: #579326;">div1</div><div class="visibility" style="width: 100%;
height: 100px;
background-color: #df7832;">div2  visibility:hidden;<div style="width: 100%;
height: 50px;
background-color: #43298d;
display:block;
visibility:visible;">div2的后代 visibility:visible;</div> </div></div> 

<h3 id="height-0"><a href="#height-0" class="headerlink" title="height:0;"></a>height:0;</h3><p>其实width:0;max-height:0;max-width:0;都可以使元素不可见，一般都用height:0;<br>使用height:0;隐藏元素，不占据空间，也不会响应交互<br>下面设置了div2 height:0;div2的后代 height: 50px;div2的后代可以设置height为非0值改变不可见状态</p>
<div style="border: 2px solid #8973de;color:#fff;"><div style="width: 100%;height: 50px;background-color: #579326;" onclick="javascript:$('#div2').css('height','100px')">我是div1，点我看div2</div><div style="width: 100%;
            background-color: #df7832;
            height:0;
            transition: height .5s; color:#666" id="div2">div2 height:0<div style="width: 100%;
            height: 50px;
            background-color: #43298d;">div2的后代 height: 50px;</div></div></div> 

<p><br><br><br></p>
<h3 id="opacity-0"><a href="#opacity-0" class="headerlink" title="opacity:0;"></a>opacity:0;</h3><p>opacity设置元素的透明度，当透明度为0时就看不见了，但仍然占据空间。<br><strong>把光标放在div1原本的位置（div2上方的空白处）试试看</strong>，opacity:0;是可以响应交互的。div2的后代无法改变不可见状态</p>
<div style="border: 2px solid #8973de;color:#fff;"><div style="width: 100%;
            height: 50px;
            background-color: #579326;">div1</div><div style="width: 100%;
            height: 100px;
            background-color: #df7832;
            transition: opacity .5s;" class="opacity">div2 opacity:0;<div style="width: 100%;
            height: 50px;
            background-color: #43298d;opacity:1;">div2的后代 opacity:1;</div> </div></div> 

<h3 id="HTML全局属性hidden"><a href="#HTML全局属性hidden" class="headerlink" title="HTML全局属性hidden"></a>HTML全局属性hidden</h3><p>这里隐藏了div1，用HTML全局属性hidden隐藏元素不占据空间,div2的后代无法改变不可见状态</p>
<div style="border: 2px solid #8973de;color:#fff;"><div style="width: 100%;
            height: 50px;
            background-color: #579326;">div1</div><div style="width: 100%;
            height: 100px;
            background-color: #df7832;" hidden>div2<div style="width: 100%;
            height: 50px;
            background-color: #43298d;" hidden="false">div2的后代</div> </div></div> 

<h2 id="各种方法比较"><a href="#各种方法比较" class="headerlink" title="各种方法比较"></a>各种方法比较</h2><p>看过每种方法隐藏元素之后的现象，可以从这几个方面来比较，在选择使用哪种方法时也可以参考这几个方面</p>
<ul>
<li>是否占据空间</li>
<li>是否响应交互</li>
<li>是否触发回流与渲染</li>
<li>是否有株连性</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">隐藏方法</th>
<th style="text-align:left">是否占据空间</th>
<th style="text-align:left">是否响应交互</th>
<th style="text-align:left">是否触发回流</th>
<th style="text-align:left">是否触发重绘</th>
<th>是否有株连性</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">display:none;</td>
<td style="text-align:left">否</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
<td>是</td>
</tr>
<tr>
<td style="text-align:left">visibility:hidden;</td>
<td style="text-align:left">是</td>
<td style="text-align:left">否</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td>否</td>
</tr>
<tr>
<td style="text-align:left">height:0;</td>
<td style="text-align:left">否</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
<td>否</td>
</tr>
<tr>
<td style="text-align:left">opacity:0;</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td>是</td>
</tr>
<tr>
<td style="text-align:left">HTML属性hidden</td>
<td style="text-align:left">否</td>
<td style="text-align:left">否</td>
<td style="text-align:left">是</td>
<td style="text-align:left">是</td>
<td>是</td>
</tr>
</tbody>
</table>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://www.w3.org/TR/css3-color/#transparency" target="_blank" rel="external">opacity</a></li>
<li><a href="https://www.w3.org/wiki/CSS/Properties/visibility" target="_blank" rel="external">visibility</a></li>
<li><a href="https://www.w3.org/wiki/CSS/Properties/display" target="_blank" rel="external">display</a></li>
<li><a href="https://developers.google.com/web/fundamentals/performance/rendering/" target="_blank" rel="external">渲染性能</a></li>
<li><a href="https://csstriggers.com/" target="_blank" rel="external">CSS Triggers</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> CSS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Git基础]]></title>
      <url>/Git%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<p>Git是一个版本控制与管理工具。在Mac OS X上可以使用Homebrew安装Git。关于Homebrew的安装参见<a href="http://brew.sh/" target="_blank" rel="external">Homebrew 官网</a>。安装完成后，终端执行brew install git。然后就可以开始使用git啦~~<br><a id="more"></a></p>
<h2 id="文件的三种状态"><a href="#文件的三种状态" class="headerlink" title="文件的三种状态"></a>文件的三种状态</h2><p>git保存的不是文件差异，而是一系列的文件快照.    在git版本控制系统中，任何一个文件都有三种状态：</p>
<ul>
<li>已修改(modified) 表明文件被修改，但没有提交保存（工作目录）</li>
<li>已暂存(staged)   表明已修改的文件放在下次提交需要保存的清单中（暂存区域，本质是一个简单的文件）</li>
<li>已提交(committed)  表明该文件已被安全的保存在本地仓库（本地仓库）<br><strong>一个已加入版本控制的文件的工作流：被修改－被暂存－被提交</strong></li>
</ul>
<h2 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h2><p>git clone [url]<br>从已有的git仓库克隆一个镜像仓库出来，git支持多种数据传输协议</p>
<ul>
<li><p>git://   </p>
</li>
<li><p>http(s)://    </p>
</li>
<li><p>ssh://user@server:/path.git表示的SSH传输协议</p>
</li>
</ul>
<p>git clone 本质上就是自动创建了本地的master分支用于跟踪远程的master分支</p>
<p>例：  在当前目录下创建demo目录，也可重新定义新建项目名称，在命令末尾指定新名称mygrit</p>
<pre><code>git clone git://github.com/chang20159/demo git-demo
</code></pre><h2 id="git-status"><a href="#git-status" class="headerlink" title="git status"></a>git status</h2><p>确定哪些文件当前处于什么状态</p>
<p>例1:当前工作目录很干净，没有任何文件在赏析提交后更改过，也没有处于未跟踪的新文件，当前在alpha分支</p>
<pre><code>On branch alpha
Your branch is up-to-date with &apos;origin/alpha&apos;.
nothing to commit, working directory clean
</code></pre><p>例2:新建test.ftl文件，没有修改，会提示有新建文件</p>
<pre><code>On branch alpha
Your branch is up-to-date with &apos;origin/alpha&apos;.
Changes to be committed:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)

        new file:   apollo-message-center-web/src/main/webapp/WEB-INF/pages/notice/test.ftl
</code></pre><p>例3:新建test.ftl，并修改，修改后处于未暂存状态，提示使用git add 对未被跟踪的文件跟踪，并将文件快照放入暂存区域。</p>
<p>在Changes to be committed下的都是已暂存状态，在Changes not staged for commit下的都是未暂存状态。若此时提交，则提交的是已暂存的文件，而不是修改后的文件，所以想提交修改后的文件，需要再次使用git add .将修改后的文件提交到暂存区域。</p>
<pre><code>On branch alpha
Your branch is up-to-date with &apos;origin/alpha&apos;.
Changes to be committed:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)

        new file:   apollo-message-center-web/src/main/webapp/WEB-INF/pages/notice/test.ftl

Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

        modified:   apollo-message-center-web/src/main/webapp/WEB-INF/pages/notice/test.ftl
</code></pre><p>例4. 对已修改的文件，未提交至暂存区域，红色显示，提示使用git add提交至暂存区域，或者直接使用 git commit -a将已修改但不在暂存区域的文</p>
<p>件一起提交。</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git status
On branch alpha
Your branch is up-to-date with &apos;origin/alpha&apos;.
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

        modified:   apollo-message-center-web/src/main/webapp/WEB-INF/pages/notice/edit-notice.ftl

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)

---------------------我是分割线--------------------------

changdeMacBook-Pro:apollo-message-center chang$ git add .
changdeMacBook-Pro:apollo-message-center chang$ git status
On branch alpha
Your branch is up-to-date with &apos;origin/alpha&apos;.
Changes to be committed:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)

        modified:   apollo-message-center-web/src/main/webapp/WEB-INF/pages/notice/edit-notice.ftl
</code></pre><h2 id="git-add"><a href="#git-add" class="headerlink" title="git add"></a>git add</h2><p>多功能命令，根据目标文件状态的不同，作用也不同。</p>
<ul>
<li><p>跟踪新文件，即将新文件纳入版本控制</p>
</li>
<li><p>将已跟踪的文件放入暂存区</p>
</li>
<li><p>在merge时可将有冲突的文件标记为已解决状态</p>
</li>
</ul>
<h2 id="git-diff"><a href="#git-diff" class="headerlink" title="git diff"></a>git diff</h2><p>查看尚未暂存的文件更新了哪些具体内容，比较的是工作目录当前文件与暂存区域快照之间的差异，即修改后还未暂存起来的变化内容。</p>
<p>git diff –cached   git 1.6.1及以上版本可使用git diff –staged，作用相同。</p>
<p>查看已暂存文件和上次提交时快照之间的差异</p>
<h2 id="git-commit"><a href="#git-commit" class="headerlink" title="git commit"></a>git commit</h2><p>提交到本地仓库，每次提交前需要确定文件是否都已暂存，commit不会纪录还未暂存的数据。</p>
<p>使用git status查看， 将修改过或新建的文件git add。</p>
<p>在git中提交时，会保存一个提交(commit)对象，该对象保存一个指向暂存内容快照的指针。</p>
<p>例1：直接使用git commit 不带参数，提示提交时要加上提交说明，＃号后是附加信息</p>
<pre><code># Please enter the commit message for your changes. Lines starting
# with &apos;#&apos; will be ignored, and an empty message aborts the commit.
</code></pre><p>例2: 在文件未放入暂存区时，使用git commit -m”test”，提交后git status发现仍然是Changes not staged for commit</p>
<p>因为git commit只提交处于暂存区域的文件，提交前需要git add</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git commit -m&quot;test &quot;
[alpha d51853e] test
 Committer: chang &lt;chang@changdeMacBook-Pro.local&gt;
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly:

    git config --global user.name &quot;Your Name&quot;
    git config --global user.email you@example.com

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
changdeMacBook-Pro:apollo-message-center chang$ git st
On branch alpha
Your branch is ahead of &apos;origin/alpha&apos; by 1 commit.
  (use &quot;git push&quot; to publish your local commits)
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

        modified:   apollo-message-center-web/src/main/webapp/WEB-INF/pages/notice/edit-notice.ftl

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</code></pre><p>例3.跳过使用暂存区域  git commit 加上-a参数，git会自动将所有已跟踪的文件暂存起来一并提交，从而跳过git add步骤  </p>
<p>   使用git commit -am”test”后，提示当前工作目录很干净，可以使用git push</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git commit -am&quot;test&quot;
[alpha 545fc8f] test
 Committer: chang &lt;chang@changdeMacBook-Pro.local&gt;
Your name and email address were configured automatically based
on your username and hostname. Please check that they are accurate.
You can suppress this message by setting them explicitly:

    git config --global user.name &quot;Your Name&quot;
    git config --global user.email you@example.com

After doing this, you may fix the identity used for this commit with:

    git commit --amend --reset-author

 1 file changed, 1 insertion(+), 1 deletion(-)
changdeMacBook-Pro:apollo-message-center chang$ git st
On branch alpha
Your branch is ahead of &apos;origin/alpha&apos; by 2 commits.
  (use &quot;git push&quot; to publish your local commits)
nothing to commit, working directory clean
</code></pre><h2 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h2><p>查看当前的远程库，会列出每个远程库的简短名称，克隆一个项目后，至少有一个名为origin的远程库，git默认用origin来标识所克隆的原始仓库。</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git remote
origin
</code></pre><h3 id="git-remote-v"><a href="#git-remote-v" class="headerlink" title="git remote -v"></a>git remote -v</h3><p>-v  –verbose的缩写，显示对应的克隆地址，若有多个远程仓库，会全部列出</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git remote -v
origin  git@code.dpoa.com:tg/apollo-message-center.git (fetch)
origin  git@code.dpoa.com:tg/apollo-message-center.git (push)
</code></pre><h2 id="git-fetch"><a href="#git-fetch" class="headerlink" title="git fetch"></a>git fetch</h2><p>从远程仓库中抓取所有本地仓库还没有的数据到本地，执行命令后，可在本地访问该远程仓库中的所有分支。</p>
<p>若是克隆了一个仓库，会自动将远程仓库归于origin名下</p>
<p>git fetch origin会抓取从上次clone后或者上次fetch后别人push的更新。</p>
<p><strong>注意</strong>：fetch命令只是将远端的其他人更新的分支数据拉到本地仓库，并不自动合并到当前工作分支，因而无法在本地编辑该远程仓库中的分支，需要手动合并到当前分支。</p>
<h2 id="git-pull"><a href="#git-pull" class="headerlink" title="git pull"></a>git pull</h2><p>若设置了某个分支用于跟踪某个远程仓库的分支，可使用pull抓取数据下来，并将远程分支自动合并到本地仓库的当前分支</p>
<p>git pull相当于 git fetch + git merge</p>
<h2 id="git-push"><a href="#git-push" class="headerlink" title="git push"></a>git push</h2><p>将本地仓库的数据推送到远程仓库</p>
<p><strong>注意</strong>：在推数据之前，远程仓库已有其他人推送了若干更新，推送操作就会被驳回(rejected)，必须先pull到本地，若有conflict，要先解决冲突，再重新commit，重新push。</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git push
To git@code.dpoa.com:tg/apollo-message-center.git
 ! [rejected]        alpha -&gt; alpha (fetch first)
error: failed to push some refs to &apos;git@code.dpoa.com:tg/apollo-message-center.git&apos;
hint: Updates were rejected because the remote contains work that you do
hint: not have locally. This is usually caused by another repository pushing
hint: to the same ref. You may want to first integrate the remote changes
hint: (e.g., &apos;git pull ...&apos;) before pushing again.
hint: See the &apos;Note about fast-forwards&apos; in &apos;git push --help&apos; for details.
</code></pre><h2 id="git-branch"><a href="#git-branch" class="headerlink" title="git branch"></a>git branch</h2><p>查看本地分支</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git branch
  20150604_chang_apolloMsgCenter
  20150612_chang_edit_notice
* alpha
  master
</code></pre><h3 id="git-branch-a"><a href="#git-branch-a" class="headerlink" title="git branch -a"></a>git branch -a</h3><p>查看本地和远程分支 ，可以使用参数 -a 查看</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git branch -a
  20150604_chang_apolloMsgCenter
  20150612_chang_edit_notice
* alpha
  master
  remotes/origin/20150604_merge_branch
  remotes/origin/20150604_jun_dev
  remotes/origin/20150604_xu_add_message_DAO
  remotes/origin/20150604_chang_apolloMsgCenter
  remotes/origin/20150608_zhao_issue_notice_page
  remotes/origin/20150609_xu_make_Administrator_UI
  remotes/origin/20150612_chang_edit_notice
  remotes/origin/HEAD -&gt; origin/master
  remotes/origin/alpha
  remotes/origin/alpha_lightmerge
  remotes/origin/beta_lightmerge
  remotes/origin/master
  remotes/origin/merge_alpha
</code></pre><h2 id="根据远程分支创建本地分支"><a href="#根据远程分支创建本地分支" class="headerlink" title="根据远程分支创建本地分支"></a>根据远程分支创建本地分支</h2><p>例如需要对远程分支remotes/origin/merge_alpha工作，需要创建本地分支对其跟踪</p>
<pre><code>git checkout -b  merge_alpha  origin/merge_alpha
</code></pre><p><strong>注</strong>：从远程分支checkout出来的本地分支，称为跟踪分支(tracking branch)。 </p>
<h2 id="根据本地分支创建远程分支"><a href="#根据本地分支创建远程分支" class="headerlink" title="根据本地分支创建远程分支"></a>根据本地分支创建远程分支</h2><p>在当前分支使用git push ，会自动创建被跟踪的远程分支</p>
<h2 id="git-branch-1"><a href="#git-branch-1" class="headerlink" title="git branch"></a>git branch</h2><h3 id="新建分支"><a href="#新建分支" class="headerlink" title="新建分支"></a>新建分支</h3><pre><code>git branch ［branch-name］
</code></pre><p>新建分支，新建分支后不会自动切换到这个分支。 </p>
<h3 id="查看所有远程分支"><a href="#查看所有远程分支" class="headerlink" title="查看所有远程分支"></a>查看所有远程分支</h3><pre><code>git branch -r  
</code></pre><p>git保存一个HEAD指针，始终指向当前工作的本地分支。</p>
<pre><code>changdeMacBook-Pro:apollo-message-center chang$ git branch -r
  origin/20150604_merge_branch
  origin/20150604_jun_dev
  origin/20150604_xu_add_message_DAO
  origin/20150604_chang_apolloMsgCenter
  origin/20150608_zhao_issue_notice_page
  origin/20150609_xu_make_Administrator_UI
  origin/20150612_chang_edit_notice
  origin/HEAD -&gt; origin/master
  origin/alpha
  origin/alpha_lightmerge
  origin/beta_lightmerge
  origin/master
  origin/merge_alpha
</code></pre><h3 id="删除本地分支"><a href="#删除本地分支" class="headerlink" title="删除本地分支"></a>删除本地分支</h3><pre><code>git branch -d
</code></pre><h2 id="删除远程分支alpha"><a href="#删除远程分支alpha" class="headerlink" title="删除远程分支alpha"></a>删除远程分支alpha</h2><pre><code>git push origin/alpha
</code></pre><h2 id="切换分支"><a href="#切换分支" class="headerlink" title="切换分支"></a>切换分支</h2><h3 id="git-checkout-branch-name"><a href="#git-checkout-branch-name" class="headerlink" title="git checkout [branch-name]"></a>git checkout [branch-name]</h3><p>切换分支，切换分支后，HEAD就指向切换后的分支</p>
<h3 id="git-checkout-b-branch-name"><a href="#git-checkout-b-branch-name" class="headerlink" title="git checkout -b [branch-name]"></a>git checkout -b [branch-name]</h3><p>新建分支并切换到该分支，相当于git branch+git checkout</p>
<h2 id="git-merge"><a href="#git-merge" class="headerlink" title="git merge"></a>git merge</h2><p>git merge [branch-name] 将branch-name分支合并到当前分支，branch-name分支可以是本地分支，也可以是远程分支。</p>
<p>合并时可能会遇到冲突，git  会在有冲突的文件中加入标准的冲突解决标记。</p>
<p>例如：当前分支alpha   使用git pull</p>
<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:index.jsp
&lt;h1&gt;Tp Message Center Web is running!!!&lt;/h1&gt;
======= 
&lt;h1&gt;Hello World!&lt;/h1&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/alpha:index.jsp
</code></pre><p>======= 隔开的上半部分是HEAD中的内容，下半部分是远程alpha分支中的内容。<br> 解决冲突的办法：二者选其一或者整合，根据具体情况选择是删除还是保留。&lt;&lt;&lt;&lt;&lt;&lt;&lt; ======= &gt;&gt;&gt;&gt;&gt;&gt;&gt; 这三行都要删掉</p>
<p>冲突解决后使用git add将冲突文件标记为已解决状态，本质上是将快照放到暂存区。确认冲突都解决后，git commit完成此次合并的提交。</p>
<h2 id="gitignore文件"><a href="#gitignore文件" class="headerlink" title=".gitignore文件"></a>.gitignore文件</h2><p>有些文件不需要进行版本控制，不需要纳入git管理，也不希望总出现在未跟踪文件列表，比如日志文件、编译过程中创建的临时文件等等。</p>
<p>可以创建一个名为.gitignore的文件，列出要忽略的文件模式</p>
<h2 id="git文件"><a href="#git文件" class="headerlink" title=".git文件"></a>.git文件</h2><p>如果需要删除对文件的版本控制，可以直接删除.git文件</p>
<p>参考：    </p>
<ul>
<li><a href="http://www.open-open.com/lib/view/open1328069609436.html" target="_blank" rel="external">http://www.open-open.com/lib/view/open1328069609436.html</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> 工具 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
